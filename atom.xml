<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ICARUS</title>
  
  
  <link href="http://lucylcarus.github.io/atom.xml" rel="self"/>
  
  <link href="http://lucylcarus.github.io/"/>
  <updated>2024-12-19T16:24:04.302Z</updated>
  <id>http://lucylcarus.github.io/</id>
  
  <author>
    <name>ICARUS</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Linux命令行(四)</title>
    <link href="http://lucylcarus.github.io/posts/2fe53600.html"/>
    <id>http://lucylcarus.github.io/posts/2fe53600.html</id>
    <published>2024-12-15T09:09:23.000Z</published>
    <updated>2024-12-19T16:24:04.302Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vim编辑器与Shell命令脚本"><a href="#Vim编辑器与Shell命令脚本" class="headerlink" title="Vim编辑器与Shell命令脚本"></a>Vim编辑器与Shell命令脚本</h1><h2 id="Vim文本编辑器"><a href="#Vim文本编辑器" class="headerlink" title="Vim文本编辑器"></a>Vim文本编辑器</h2><p>Vim编辑器中设置了3中模式——命令模式、末行模式、和编辑模式，每种模式分别又支持多种不同的命令快捷键，大大提高了工作效率</p><ol><li>命令模式<br> 控制光标移动，可对文本进行复制、粘贴、删除和查找等工作</li><li>输入模式<br> 正常的文本录入</li><li>末行模式<br> 保存或退出文档，以及设置标记环境</li></ol><p>模式间的切换详见下图</p><p><img src="https://www.helloimg.com/i/2024/12/19/67643d22c090e.png" alt=""></p><div class="note info modern"><p>每次运行Vim编辑器时，默认进入命令模式，此时需要先切换到输入模式后在进行文档编辑工作，而在每次编写玩文档后需要先返回命令模式，再进入末行模式，执行保存或退出操作</p></div><p>命令模式最常用的一些命令</p><div class="table-container"><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>dd</td><td>删除(剪切)光标所在行</td></tr><tr><td>5dd</td><td>删除(剪切)从光标处开始的5行</td></tr><tr><td>yy</td><td>复制光标所在整行</td></tr><tr><td>5yy</td><td>复制从光标处开始的5行</td></tr><tr><td>n</td><td>显示搜索命令定位到的下一个字符串</td></tr><tr><td>N</td><td>显示搜索命令定位到的上一个字符串</td></tr><tr><td>u</td><td>撤销上一步操作</td></tr><tr><td>p</td><td>将之前删除(dd)或复制(yy)过的数据粘贴到光标后面</td></tr></tbody></table></div><p>末行模式常用的一些命令</p><div class="table-container"><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>:w</td><td>保存</td></tr><tr><td>:q</td><td>退出</td></tr><tr><td>:q!</td><td>强制退出(放弃对文档的修改内容)</td></tr><tr><td>:wq!</td><td>强制保存退出</td></tr><tr><td>:set nu</td><td>显示行号</td></tr><tr><td>:set nomu</td><td>不显示行号</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>:命令</td><td>执行该命令</td></tr><tr><td>:整数</td><td>跳转到该行</td></tr><tr><td>:s/one/two</td><td>将当前光标所在行的第一个one替换成two</td></tr><tr><td>:s/one/two/g</td><td>将当前光标所在行的所有one替换成two</td></tr><tr><td>:%s/one/two</td><td>将全文中所有one替换成two</td></tr><tr><td>?字符串</td><td>在文本中从下至上搜索该字符串</td></tr><tr><td>/字符串</td><td>在文本中从上至下搜索该字符串</td></tr></tbody></table></div><h1 id="配置主机名称"><a href="#配置主机名称" class="headerlink" title="配置主机名称"></a>配置主机名称</h1><p>在Linux系统中，主机名大多保存在<code>/etc/hostname</code>文件中，比如，将<code>/etc/hostname</code>文件中内容修改为<code>mylinux</code></p><ol><li>使用Vim编辑器修改<code>/etc/hostname</code>主机名称文件<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hostname</span><br></pre></td></tr></table></figure></li><li>把原始主机名称删除后追加<code>mylinux</code><div class="note info modern"><p>需要在末行模式下执行<code>:wq!</code>命令</p></div></li><li>保存并退出文档，使用<code>hostname</code>命令检查是否修改成功<div class="note info modern"><p><code>hostname</code>命令用于查看当前主机名称，但有时主机名称不会立即同步更新到系统中，可重启查看</p></div></li></ol><h1 id="配置网卡信息"><a href="#配置网卡信息" class="headerlink" title="配置网卡信息"></a>配置网卡信息</h1><p>网卡 IP 地址配置的是否正确是两台服务器是否可以相互通信的前提。</p><p>在 Linux 系统中，一切都是文件，因此配置网络服务的工作其实就是在编辑网卡配置文件。</p><p>在 RHEL 7 中，网卡配置文件的前缀则以<code>ifcfg</code>开始，加上网卡名称共同组成了网卡配置文件的名字，例如<code>ifcfg-eno16777736</code></p><p>现在有一个名称为<code>ifcfg-eno16777736</code>的网卡设备，我们将其配置为开机自启动，并且 IP 地址、子网、网关等信息由人工指定，其步骤应该如下所示。</p><ol><li>首先切换到<code>/etc/sysconfig/network-scripts</code>目录中（存放着网卡的配置文件）。</li><li><p>使用 Vim 编辑器修改网卡文件<code>ifcfg-eno16777736</code>，逐项写入下面的配置参数并保存退出。由于每台设备的硬件及架构是不一样的，因此使用<code>ifconfig</code>命令确认各自网卡的默认名称。</p><blockquote><p>设备类型 TYPPE=Ethernet<br>地址分配模式 BOOTPROTO=static (static表示静态IP，dhcp表示动态获取IP)<br>网卡名称 NAME=ens160<br>是否启动 ONBOOT=yes (yes表示启动，no表示不启动)<br>IP地址 IPADDR=192.168.10.10<br>子网掩码 NETMASK=255.255.255.0<br>网关地址 GATEWAY=192.168.10.1<br>DNS地址 DNS1=192.168.10.1</p></blockquote></li><li><p>重启网络服务并测试网络是否连通</p><div class="note info modern"><p><code>nmcli connection reload ens160</code>重启网络服务，<code>ping</code>命令测试网络是否连通(<code>ping</code>命令不会自动终止，可使用<code>CTRL+C</code>强制结束进程)</p></div></li></ol><h1 id="配置软件仓库"><a href="#配置软件仓库" class="headerlink" title="配置软件仓库"></a>配置软件仓库</h1><p>软件仓库是一种能够进一步简化RPM管理软件的难度以及自动化分析所需软件包及其依赖关系的技术，既让想要使用软件仓库，就要先把它搭建起来，然后将其配置规则确定好<br>搭建并配置软件仓库的步骤如下</p><ol><li>进入<code>/etc/yum.repos.d/</code>目录中</li><li>使用Vim编辑器创建一个新的配置文件(文件名称可以随意，但后缀必须为<code>.repo</code>)，逐项写入以下配置参数并保存退出<blockquote><p>仓库名称：具有唯一标识，不应与其他软件仓库发生冲突<br>描述信息：可以是一些介绍性的词，易于识别软件仓库的作用<br>仓库位置：软件包的获取方式，可以使用<code>FTP</code>或<code>HTTP</code>下载，也可以是本地的文件(需要在后面添加<code>file</code>参数)<br>是否启用：设置此源是否可用，1为可用，0为禁用<br>是否校验：设置此源是否校验，1为校验，0为不校验<br>公钥位置：若上面的参数开启了校验功能，则此处为公钥文件位置，若没有开启，则省略不用写</p></blockquote></li><li>按照配置参数中所填写的仓库位置挂载光盘，并把光盘挂载信息写入<code>/etc/fstab</code>文件中</li><li>使用<code>dnf install httpd-y</code>命令检查软件仓库是否开启已经可用</li></ol><h1 id="编写Shell脚本"><a href="#编写Shell脚本" class="headerlink" title="编写Shell脚本"></a>编写Shell脚本</h1><p>可以将Shell终端解释器当作人与计算机硬件之间的“翻译官”，它作为用户与Linux系统内部的通信媒介，除了支持各种变量与参数外，还提供了诸如循环、分支等高级编程语言才有的控制结构特性<br>Shell脚本命令的工作方式有下面两种</p><ol><li>交互式<br> 用户每输入一条命令就立即执行</li><li>批处理<br> 由用户实现编写好一个完整的Shell脚本，Shell会一次性执行脚本中诸多命令 </li></ol><blockquote><p>通过查看<code>SHELL</code>变量可以发现，当前系统已经默认使用<code>Bash</code>作为命令终端解释器了<br>echo $SHELL</p></blockquote><h2 id="编写简单的脚本"><a href="#编写简单的脚本" class="headerlink" title="编写简单的脚本"></a>编写简单的脚本</h2><p>如果想查看当前工作路径并列出当前目录下所有的文件及属性信息，实现这个功能的脚本应该类似于下面这样<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim example.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">For Example</span></span><br><span class="line">pwd</span><br><span class="line">ls -al</span><br></pre></td></tr></table></figure></p><div class="note info modern"><p>shell脚本文件的名称可以随意，但为了避免被误以为是普通文件，建议加上<code>.sh</code>后缀</p></div><p>上面的脚本文件实际上出现了三种不同的元素</p><p>第一行的脚本声明<code>#!</code>用来告诉系统使用哪种Shell解释器来执行该脚本</p><p>第二行的注释信息<code>#</code>是对该脚本功能和某些命令的介绍信息，使得自己或他人在日后看到这个脚本内容时，可以快速知道该脚本的作用或一些警告信息</p><p>第三、四行的可执行语句也就是我们平时执行的Linux命令</p><blockquote><p>运行该脚本<br>bash example</p></blockquote><h2 id="接受用户的参数"><a href="#接受用户的参数" class="headerlink" title="接受用户的参数"></a>接受用户的参数</h2><p>为了让Shell脚本程序更好地满足用户的一些实时需求，以便灵活完成工作，必须要让脚本程序能够像之前执行命令时那样，接受用户输入的参数<br>其实，Linux系统中的Shell脚本语言已经考虑到这些，也内设了用于接收参数的变量，变量之间使用空格间隔，参数变量详见下表</p><div class="table-container"><table><thead><tr><th>参数变量</th><th>作用</th></tr></thead><tbody><tr><td>$0</td><td>当前Shell脚本程序的名称</td></tr><tr><td>$#</td><td>总共有几个参数</td></tr><tr><td>$*</td><td>所有位置的参数值</td></tr><tr><td>$?</td><td>显示上一次命令的执行返回值</td></tr><tr><td>$1、$2、$3……</td><td>第N个位置的参数值</td></tr></tbody></table></div><h2 id="判断用户的参数"><a href="#判断用户的参数" class="headerlink" title="判断用户的参数"></a>判断用户的参数</h2><p>Shell脚本中条件车是语法可以判断表达式是否成立，若条件成立则返回数字0，否则便返回非零值，条件测试语法的执行格式为<code>[ 条件表达式 ]</code><br><strong>注意条件表达式两边应均有一个空格</strong><br>按照测试对象来划分，条件测试语句可以分为4中</p><ol><li>文件测试语句</li><li>逻辑测试语句</li><li>整数值比较语句</li><li>字符串比较语句<br>文件测试即使用指定条件来判断文件是否存在或权限是否满足等情况的运算符，具体参数如下表所示</li></ol><div class="table-container"><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>-d</td><td>测试文件是否为目录类型</td></tr><tr><td>-e</td><td>测试文件是否存在</td></tr><tr><td>-f</td><td>判断是否为一般文件</td></tr><tr><td>-r</td><td>测试当前用户是否有权限读取</td></tr><tr><td>-w</td><td>测试当前用户是否有权限写入</td></tr><tr><td>-x</td><td>测试当前用户是否有权限执行</td></tr></tbody></table></div><blockquote><p>例：<br>使用文件测试语句判断<code>/etc/fstab</code>是否为一个目录类型的文件，然后通过Shell解释器的内设<code>$?</code>变量显示上一条命令执行后的返回值。如果返回值为0，则目录存在，如果返回为非零值，则意味着他不是目录<br>[ -d /etc/fstab ]<br>echo $?</p></blockquote><h3 id="整数比较运算符"><a href="#整数比较运算符" class="headerlink" title="整数比较运算符"></a>整数比较运算符</h3><p>整数比较运算符仅是对数字的操作，不能将数字与字符串、文件等内容一起操作，可用整数比较运算符如下表所示</p><div class="table-container"><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>-eq</td><td>是否等于</td></tr><tr><td>-ne</td><td>是否不等于</td></tr><tr><td>-gt</td><td>是否大于</td></tr><tr><td>-lt</td><td>是否小于</td></tr><tr><td>-le</td><td>是否等于或小于</td></tr><tr><td>-ge</td><td>是否大于或等于</td></tr></tbody></table></div><h3 id="字符串比较运算符"><a href="#字符串比较运算符" class="headerlink" title="字符串比较运算符"></a>字符串比较运算符</h3><p>字符串比较语句用于判断测试字符串是否为空值，或两个字符串是否相同，字符串比较中常见的运算符如下表所示</p><div class="table-container"><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>=</td><td>比较字符串内容是否相同</td></tr><tr><td>!=</td><td>比较字符串内容是否不同</td></tr><tr><td>-z</td><td>判断字符串内容是否为空</td></tr></tbody></table></div><h1 id="流程控制语句"><a href="#流程控制语句" class="headerlink" title="流程控制语句"></a>流程控制语句</h1><h2 id="if条件测试语句"><a href="#if条件测试语句" class="headerlink" title="if条件测试语句"></a>if条件测试语句</h2><p><code>if</code>条件测试语句可以让脚本根据实际情况自动执行相应的命令，<code>if</code>条件测试语句分为单分支结构，双分支结构，多分支结构，其复杂度随着灵活度一起逐级上升</p><h3 id="单分支结构"><a href="#单分支结构" class="headerlink" title="单分支结构"></a>单分支结构</h3><p>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if 条件测试操作</span><br><span class="line">  then 命令序列</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></p><h3 id="双分支结构"><a href="#双分支结构" class="headerlink" title="双分支结构"></a>双分支结构</h3><p>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if 条件测试操作</span><br><span class="line">  then 命令序列1</span><br><span class="line">  else 命令序列2</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></p><h3 id="多分支结构"><a href="#多分支结构" class="headerlink" title="多分支结构"></a>多分支结构</h3><p>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if 条件测试操作1</span><br><span class="line">  then 命令序列1</span><br><span class="line">elif 条件测试操作2</span><br><span class="line">  then 命令序列2</span><br><span class="line">else</span><br><span class="line">  命令序列3</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></p><h2 id="for条件循环语句"><a href="#for条件循环语句" class="headerlink" title="for条件循环语句"></a>for条件循环语句</h2><p><code>for</code>循环语句允许脚本一次性读取多个信息，然后逐一对信息进行操作处理<br>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for 变量名 in 取值列表</span><br><span class="line">do</span><br><span class="line">  命令序列</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p><h2 id="while条件循环语句"><a href="#while条件循环语句" class="headerlink" title="while条件循环语句"></a>while条件循环语句</h2><p><code>while</code>条件循环语句是一种脚本根据某些条件来重复执行命令的语句，不同于<code>for</code>循环语句，<code>while</code>语句通过判断条件测试的真假决定是否继续执行命令，若命令为真就继续执行，若条件为假就结束循环<br>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while 条件测试操作</span><br><span class="line">do</span><br><span class="line">  命令序列</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p><h2 id="case条件测试语句"><a href="#case条件测试语句" class="headerlink" title="case条件测试语句"></a>case条件测试语句</h2><p><code>case</code>语句是在多个范围内匹配数据，若匹配成功则执行相关命令并结束整个条件测试，如果数据不在所以列出的范围内，则会去执行星号<code>*</code>中所定义的默认命令<br>语法格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">case 变量名 in</span><br><span class="line">模式1)</span><br><span class="line">  命令序列1</span><br><span class="line">  ;;</span><br><span class="line">模式2)</span><br><span class="line">  命令序列2</span><br><span class="line">  ;;</span><br><span class="line">  ……</span><br><span class="line">*)</span><br><span class="line">  默认命令序列</span><br><span class="line">esac</span><br></pre></td></tr></table></figure></p><h1 id="计划任务服务程序"><a href="#计划任务服务程序" class="headerlink" title="计划任务服务程序"></a>计划任务服务程序</h1><p>计划任务分为一次性计划任务与长期性计划任务</p><ol><li>一次性计划任务<br>只执行一次，一般用于临时性的工作请求</li><li>长期性计划任务<br>能够周期性地、有规律的执行某些某些具体的任务</li></ol><h2 id="一次性计划任务"><a href="#一次性计划任务" class="headerlink" title="一次性计划任务"></a>一次性计划任务</h2><p>使用<code>at 时间</code>的格式，如果想要查看已设置好但还未执行的一次性计划任务，可以使用<code>at -l</code>命令，先要将其删除，可以使用<code>atrm 任务序号</code>，查询当前设置的<code>at</code>任务列表，可以使用<code>atq</code>命令<br><code>at</code>命令中常见参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>-f</td><td>指定包含命令的任务文件</td></tr><tr><td>-q</td><td>指定新任务名称</td></tr><tr><td>-l</td><td>显示待执行任务的列表</td></tr><tr><td>-d</td><td>删除指定的待执行任务</td></tr><tr><td>-m</td><td>任务执行后向用户发邮件</td></tr></tbody></table></div><blockquote><p>例：<br>5分钟后执行/bin/date<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">at now +5 minutes</span><br><span class="line">/bin/date</span><br><span class="line">&lt;EOT&gt;(CTRL+D提交任务)</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="长期性计划任务"><a href="#长期性计划任务" class="headerlink" title="长期性计划任务"></a>长期性计划任务</h2><p>使用Linux系统中默认的<code>crond服务</code></p><p>创建、编辑计划任务的命令为<code>crontab -e</code><br>查看当前计划任务的命令为<code>crontab -l</code><br>删除某条计划任务的命令为<code>crontab -r</code><br>编辑他人计划任务的命令为<code>crontab -u</code>(管理员权限)</p><p>命令时间格式<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*     * 　  *　  *　  *　　command</span><br><span class="line">分　  时　  日　  月　 周　  命令</span><br><span class="line">第1列表示分钟1～59 每分钟用*或者 */1表示</span><br><span class="line">第2列表示小时1～23（0表示0点）</span><br><span class="line">第3列表示日期1～31</span><br><span class="line">第4列表示月份1～12</span><br><span class="line">第5列标识号星期0～6（0表示星期天）</span><br><span class="line">第6列要运行的命令</span><br></pre></td></tr></table></figure></p><div class="note info modern"><p><code>*</code>表示为任意时间<br><code>,</code>表示间隔的多个不连续时间点<br><code>-</code>表示一个连续的时间范围<br><code>/数字</code>表示间隔的时间频率</p></div><blockquote><p>例：<br>每月1、10、22日的4 : 45重启apache<br>45 4 1,10,22 <em> </em> /usr/local/etc/rc.d/lighttpd restart  </p></blockquote>]]></content>
    
    
    <summary type="html">Linux具有开放源码、没有版权、技术社区用户多等特点，开放源码使得用户可以自由裁剪，灵活性高，功能强大，成本低。尤其系统中内嵌网络协议栈，经过适当的配置就可实现路由器的功能。这些特点使得Linux成为开发路由交换设备的理想开发平台。</summary>
    
    
    
    <category term="操作系统" scheme="http://lucylcarus.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="http://lucylcarus.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 系统设置界面修改(四)</title>
    <link href="http://lucylcarus.github.io/posts/7b0505a9.html"/>
    <id>http://lucylcarus.github.io/posts/7b0505a9.html</id>
    <published>2024-12-12T12:14:39.000Z</published>
    <updated>2024-12-15T09:22:22.911Z</updated>
    
    <content type="html"><![CDATA[<p><strong>若无特殊说明，默认修改位于<code>screens.rpy</code>文件中</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li><a href="https://doc.renpy.cn/zh-CN/keymap.html">自定义快捷键</a></li><li><a href="https://doc.renpy.cn/zh-CN/other.html#renpy.is_skipping">是否处于快进状态</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1UnqaYuE81&cid=27307413028&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="自定义快捷键"><a href="#自定义快捷键" class="headerlink" title="自定义快捷键"></a>自定义快捷键</h1><p>打开<code>renpy/common/00keymap.rpy</code>你将看到如下代码</p><div class="note danger modern"><p>该部分代码<strong><em>不推荐修改</em></strong>，如想修改，请先拷贝一份留作备用</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Copyright 2004-2024 Tom Rothamel &lt;pytom@bishoujo.us&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Permission is hereby granted, free of charge, to any person</span></span><br><span class="line"><span class="comment"># obtaining a copy of this software and associated documentation files</span></span><br><span class="line"><span class="comment"># (the &quot;Software&quot;), to deal in the Software without restriction,</span></span><br><span class="line"><span class="comment"># including without limitation the rights to use, copy, modify, merge,</span></span><br><span class="line"><span class="comment"># publish, distribute, sublicense, and/or sell copies of the Software,</span></span><br><span class="line"><span class="comment"># and to permit persons to whom the Software is furnished to do so,</span></span><br><span class="line"><span class="comment"># subject to the following conditions:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The above copyright notice and this permission notice shall be</span></span><br><span class="line"><span class="comment"># included in all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span></span><br><span class="line"><span class="comment"># EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span></span><br><span class="line"><span class="comment"># MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span></span><br><span class="line"><span class="comment"># NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</span></span><br><span class="line"><span class="comment"># LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</span></span><br><span class="line"><span class="comment"># OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</span></span><br><span class="line"><span class="comment"># WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1600</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">_keymap_list</span>(<span class="title class_ inherited__">_list</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">self, a</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                _<span class="built_in">list</span>.remove(<span class="variable language_">self</span>, a)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">if</span> config.developer:</span><br><span class="line">                    <span class="keyword">raise</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    config.keymap = <span class="built_in">dict</span>(</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Bindings present almost everywhere, unless explicitly</span></span><br><span class="line">        <span class="comment"># disabled.</span></span><br><span class="line">        <span class="comment"># 除非明确禁用，各处都能使用的绑定快捷键</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 回滚</span></span><br><span class="line">        rollback = [ <span class="string">&#x27;anyrepeat_K_PAGEUP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEUP&#x27;</span>, <span class="string">&#x27;K_AC_BACK&#x27;</span>, <span class="string">&#x27;mousedown_4&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 截图</span></span><br><span class="line">        screenshot = [ <span class="string">&#x27;alt_K_s&#x27;</span>, <span class="string">&#x27;alt_shift_K_s&#x27;</span>, <span class="string">&#x27;noshift_K_s&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 切换自动模式</span></span><br><span class="line">        toggle_afm = [ ],</span><br><span class="line">        <span class="comment"># 切换全屏/窗口</span></span><br><span class="line">        toggle_fullscreen = [ <span class="string">&#x27;alt_K_RETURN&#x27;</span>, <span class="string">&#x27;alt_K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_F11&#x27;</span>, <span class="string">&#x27;noshift_K_f&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 显示游戏菜单界面，一般为存档界面</span></span><br><span class="line">        game_menu = [ <span class="string">&#x27;K_ESCAPE&#x27;</span>, <span class="string">&#x27;K_MENU&#x27;</span>, <span class="string">&#x27;K_PAUSE&#x27;</span>, <span class="string">&#x27;mouseup_3&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 隐藏对话框、底部菜单等</span></span><br><span class="line">        hide_windows = [ <span class="string">&#x27;mouseup_2&#x27;</span>, <span class="string">&#x27;noshift_K_h&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 打开编辑器</span></span><br><span class="line">        launch_editor = [ <span class="string">&#x27;shift_K_e&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 转储样式</span></span><br><span class="line">        dump_styles = [ ],</span><br><span class="line">        <span class="comment"># 重新加载游戏</span></span><br><span class="line">        reload_game = [ <span class="string">&#x27;alt_K_r&#x27;</span>, <span class="string">&#x27;shift_K_r&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 可视组件查验器</span></span><br><span class="line">        inspector = [ <span class="string">&#x27;alt_noshift_K_i&#x27;</span>, <span class="string">&#x27;shift_K_i&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 可视组件查验器(详细)</span></span><br><span class="line">        full_inspector = [ <span class="string">&#x27;alt_shift_K_i&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 开发者菜单</span></span><br><span class="line">        developer = [ <span class="string">&#x27;alt_K_d&#x27;</span>, <span class="string">&#x27;shift_K_d&#x27;</span>, ],</span><br><span class="line">        <span class="comment"># 退出游戏</span></span><br><span class="line">        quit = [ ],</span><br><span class="line">        <span class="comment"># 图标化</span></span><br><span class="line">        iconify = [ ],</span><br><span class="line">        <span class="comment"># 帮助界面</span></span><br><span class="line">        <span class="built_in">help</span> = [ <span class="string">&#x27;K_F1&#x27;</span>, <span class="string">&#x27;meta_shift_/&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 选择渲染</span></span><br><span class="line">        choose_renderer = [<span class="string">&#x27;alt_K_g&#x27;</span>, <span class="string">&#x27;shift_K_g&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 进度屏幕</span></span><br><span class="line">        progress_screen = [ <span class="string">&#x27;alt_shift_K_p&#x27;</span>, <span class="string">&#x27;meta_shift_K_p&#x27;</span>, <span class="string">&#x27;K_F2&#x27;</span> ],</span><br><span class="line">        <span class="comment"># 气泡编辑器</span></span><br><span class="line">        bubble_editor = [ <span class="string">&#x27;alt_K_b&#x27;</span>, <span class="string">&#x27;shift_K_b&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Accessibility.</span></span><br><span class="line">        <span class="comment"># 数据读取</span></span><br><span class="line"></span><br><span class="line">        accessibility = [ <span class="string">&#x27;shift_K_a&#x27;</span> ],</span><br><span class="line">        self_voicing = [ <span class="string">&#x27;alt_K_v&#x27;</span>, <span class="string">&#x27;K_v&#x27;</span> ],</span><br><span class="line">        clipboard_voicing = [ <span class="string">&#x27;alt_shift_K_c&#x27;</span>, <span class="string">&#x27;shift_K_c&#x27;</span> ],</span><br><span class="line">        debug_voicing = [ <span class="string">&#x27;alt_shift_K_v&#x27;</span>, <span class="string">&#x27;meta_shift_K_v&#x27;</span> ],</span><br><span class="line">        extra_voicing = [ <span class="string">&#x27;?&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Say.</span></span><br><span class="line">        <span class="comment"># say相关</span></span><br><span class="line"></span><br><span class="line">        rollforward = [ <span class="string">&#x27;anyrepeat_K_PAGEDOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEDOWN&#x27;</span>, <span class="string">&#x27;mousedown_5&#x27;</span>, ],</span><br><span class="line">        dismiss = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_SPACE&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span>, <span class="string">&#x27;mouseup_1&#x27;</span> ],</span><br><span class="line">        dismiss_unfocused = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Pause.</span></span><br><span class="line">        <span class="comment"># 暂停</span></span><br><span class="line"></span><br><span class="line">        dismiss_hard_pause = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Focus.</span></span><br><span class="line">        <span class="comment"># 焦点相关</span></span><br><span class="line"></span><br><span class="line">        focus_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        focus_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        focus_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        focus_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Button.</span></span><br><span class="line">        <span class="comment"># 按钮</span></span><br><span class="line"></span><br><span class="line">        button_ignore = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        button_select = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span>, <span class="string">&#x27;mouseup_1&#x27;</span>,  ],</span><br><span class="line">        button_alternate = [ <span class="string">&#x27;mouseup_3&#x27;</span> ],</span><br><span class="line">        button_alternate_ignore = [ <span class="string">&#x27;mousedown_3&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Input.</span></span><br><span class="line">        <span class="comment"># 输入</span></span><br><span class="line"></span><br><span class="line">        input_backspace = [ <span class="string">&#x27;anyrepeat_K_BACKSPACE&#x27;</span> ],</span><br><span class="line">        input_enter = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span> ],</span><br><span class="line">        input_next_line = [ <span class="string">&#x27;shift_K_RETURN&#x27;</span>, <span class="string">&#x27;shift_K_KP_ENTER&#x27;</span> ],</span><br><span class="line">        input_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        input_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        input_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        input_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line">        input_delete = [ <span class="string">&#x27;anyrepeat_K_DELETE&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DELETE&#x27;</span> ],</span><br><span class="line">        input_home = [ <span class="string">&#x27;K_HOME&#x27;</span>, <span class="string">&#x27;KP_HOME&#x27;</span>, <span class="string">&#x27;meta_K_LEFT&#x27;</span> ],</span><br><span class="line">        input_end = [ <span class="string">&#x27;K_END&#x27;</span>, <span class="string">&#x27;KP_END&#x27;</span>, <span class="string">&#x27;meta_K_RIGHT&#x27;</span> ],</span><br><span class="line">        input_copy = [ <span class="string">&#x27;ctrl_noshift_K_INSERT&#x27;</span>, <span class="string">&#x27;ctrl_noshift_K_c&#x27;</span>, <span class="string">&#x27;meta_noshift_K_c&#x27;</span> ],</span><br><span class="line">        input_paste = [ <span class="string">&#x27;shift_K_INSERT&#x27;</span>, <span class="string">&#x27;ctrl_noshift_K_v&#x27;</span>, <span class="string">&#x27;meta_noshift_K_v&#x27;</span> ],</span><br><span class="line">        input_jump_word_left = [ <span class="string">&#x27;osctrl_K_LEFT&#x27;</span>, <span class="string">&#x27;osctrl_KP_LEFT&#x27;</span> ],</span><br><span class="line">        input_jump_word_right = [ <span class="string">&#x27;osctrl_K_RIGHT&#x27;</span>, <span class="string">&#x27;osctrl_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        input_delete_word = [ <span class="string">&#x27;osctrl_K_BACKSPACE&#x27;</span> ],</span><br><span class="line">        input_delete_full = [ <span class="string">&#x27;meta_K_BACKSPACE&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Viewport.</span></span><br><span class="line">        <span class="comment"># 视口</span></span><br><span class="line"></span><br><span class="line">        viewport_leftarrow = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        viewport_rightarrow = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        viewport_uparrow = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        viewport_downarrow = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line">        viewport_wheelup = [ <span class="string">&#x27;mousedown_4&#x27;</span> ],</span><br><span class="line">        viewport_wheeldown = [ <span class="string">&#x27;mousedown_5&#x27;</span> ],</span><br><span class="line">        viewport_drag_start = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        viewport_drag_end = [ <span class="string">&#x27;mouseup_1&#x27;</span> ],</span><br><span class="line">        viewport_pageup = [ <span class="string">&#x27;anyrepeat_K_PAGEUP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEUP&#x27;</span>],</span><br><span class="line">        viewport_pagedown = [ <span class="string">&#x27;anyrepeat_K_PAGEDOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEDOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># These keys control skipping.</span></span><br><span class="line">        <span class="comment"># 这些按键控制跳过</span></span><br><span class="line"></span><br><span class="line">        skip = [ <span class="string">&#x27;anymod_K_LCTRL&#x27;</span>, <span class="string">&#x27;anymod_K_RCTRL&#x27;</span> ],</span><br><span class="line">        stop_skipping = [ ],</span><br><span class="line">        toggle_skip = [ <span class="string">&#x27;K_TAB&#x27;</span> ],</span><br><span class="line">        fast_skip = [ <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;shift_K_PERIOD&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Bar.</span></span><br><span class="line">        bar_activate = [ <span class="string">&#x27;mousedown_1&#x27;</span>, <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span> ],</span><br><span class="line">        bar_deactivate = [ <span class="string">&#x27;mouseup_1&#x27;</span>, <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span> ],</span><br><span class="line">        bar_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        bar_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        bar_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        bar_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Delete a save.</span></span><br><span class="line">        <span class="comment"># 删除存档</span></span><br><span class="line"></span><br><span class="line">        save_delete = [ <span class="string">&#x27;K_DELETE&#x27;</span>, <span class="string">&#x27;KP_DELETE&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Save/load screen pagination.</span></span><br><span class="line">        <span class="comment"># 存档/读档页数切换</span></span><br><span class="line"></span><br><span class="line">        save_page_prev = [<span class="string">&#x27;mousedown_4&#x27;</span>],</span><br><span class="line">        save_page_next = [<span class="string">&#x27;mousedown_5&#x27;</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Draggable.</span></span><br><span class="line">        <span class="comment"># 可拖拽组件</span></span><br><span class="line"></span><br><span class="line">        drag_activate = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        drag_deactivate = [ <span class="string">&#x27;mouseup_1&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Debug console.</span></span><br><span class="line">        <span class="comment"># 调试控制台</span></span><br><span class="line"></span><br><span class="line">        console = [ <span class="string">&#x27;shift_K_o&#x27;</span>, <span class="string">&#x27;alt_shift_K_o&#x27;</span> ],</span><br><span class="line">        console_exit = [ <span class="string">&#x27;K_ESCAPE&#x27;</span>, <span class="string">&#x27;K_MENU&#x27;</span>, <span class="string">&#x27;K_PAUSE&#x27;</span>, <span class="string">&#x27;mouseup_3&#x27;</span> ],</span><br><span class="line">        console_older = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        console_newer = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Director</span></span><br><span class="line">        <span class="comment"># 编导器</span></span><br><span class="line">        director = [ <span class="string">&#x27;noshift_K_d&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Ignored (kept for backwards compatibility).</span></span><br><span class="line">        <span class="comment"># 忽略(保持后向兼容)</span></span><br><span class="line"></span><br><span class="line">        toggle_music = [ ],</span><br><span class="line">        viewport_up = [ ],</span><br><span class="line">        viewport_down = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Profile commands.</span></span><br><span class="line">        <span class="comment"># Profile命令</span></span><br><span class="line"></span><br><span class="line">        performance = [ <span class="string">&#x27;K_F3&#x27;</span> ],</span><br><span class="line">        image_load_log = [ <span class="string">&#x27;K_F4&#x27;</span> ],</span><br><span class="line">        profile_once = [ <span class="string">&#x27;K_F8&#x27;</span> ],</span><br><span class="line">        memory_profile = [ <span class="string">&#x27;K_F7&#x27;</span> ],</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    config.default_keymap = &#123; k : _<span class="built_in">list</span>(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> config.keymap.items() &#125;</span><br><span class="line">    config.keymap = &#123; k : _keymap_list(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> config.keymap.items() &#125;</span><br><span class="line"></span><br><span class="line">    config.pad_bindings = &#123;</span><br><span class="line">        <span class="string">&quot;pad_leftshoulder_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_lefttrigger_pos&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_back_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_leftshoulder_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefttrigger_pos&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_back_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_guide_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_start_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_y_press&quot;</span> : [ <span class="string">&quot;hide_windows&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_x_press&quot;</span> : [ <span class="string">&quot;button_alternate&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_rightshoulder_press&quot;</span> : [ <span class="string">&quot;rollforward&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightshoulder_press&quot;</span> : [ <span class="string">&quot;rollforward&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_righttrigger_pos&quot;</span> : [ <span class="string">&quot;dismiss&quot;</span>, <span class="string">&quot;button_select&quot;</span>, <span class="string">&quot;bar_activate&quot;</span>, <span class="string">&quot;bar_deactivate&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_a_press&quot;</span> : [ <span class="string">&quot;dismiss&quot;</span>, <span class="string">&quot;button_select&quot;</span>, <span class="string">&quot;bar_activate&quot;</span>, <span class="string">&quot;bar_deactivate&quot;</span>],</span><br><span class="line">        <span class="string">&quot;pad_b_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpleft_press&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_leftx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_rightx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpright_press&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_leftx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_rightx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpup_press&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_lefty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_righty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpdown_press&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_lefty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_righty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpleft_press&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_leftx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpright_press&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_leftx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpup_press&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_righty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpdown_press&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_righty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Should we use the autoreload system?</span></span><br><span class="line">    config.autoreload = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1600</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Are the windows currently hidden?</span></span><br><span class="line">    _windows_hidden = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_keymap_toggle_afm</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.run(Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_toggle_skipping</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.config.allow_skipping:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.store._skipping:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.skipping:</span><br><span class="line">            config.skipping = <span class="string">&quot;slow&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            config.skipping = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            renpy.jump(<span class="string">&quot;_noisy_return&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">    toggle_skipping = _toggle_skipping</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_keymap_toggle_skipping</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        _toggle_skipping()</span><br><span class="line"></span><br><span class="line">    config.<span class="built_in">help</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    config.help_screen = <span class="string">&quot;help&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_help</span>(<span class="params"><span class="built_in">help</span>=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">help</span> <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">help</span> = config.<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">help</span> <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> config.help_screen <span class="keyword">and</span> renpy.has_screen(config.help_screen):</span><br><span class="line">                renpy.run(ShowMenu(config.help_screen))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.has_label(<span class="built_in">help</span>):</span><br><span class="line">            renpy.call_in_new_context(<span class="built_in">help</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">help</span>.startswith(<span class="string">&#x27;http://&#x27;</span>) <span class="keyword">or</span> <span class="built_in">help</span>.startswith(<span class="string">&#x27;https://&#x27;</span>):</span><br><span class="line">                renpy.open_url(<span class="built_in">help</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            file_path = os.path.join(config.basedir, <span class="built_in">help</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(file_path):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            renpy.open_url(<span class="string">&quot;file:///&quot;</span> + file_path)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    config.screenshot_pattern = os.environ.get(<span class="string">&quot;RENPY_SCREENSHOT_PATTERN&quot;</span>, <span class="string">&quot;screenshot%04d.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Called to make a screenshot happen.</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot_core</span>():</span><br><span class="line">        <span class="keyword">import</span> os.path</span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">        dest = config.renpy_base</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.macapp:</span><br><span class="line">            dest = os.path.expanduser(<span class="string">&quot;~/Desktop&quot;</span>)</span><br><span class="line"></span><br><span class="line">        pattern = renpy.store._screenshot_pattern <span class="keyword">or</span> config.screenshot_pattern</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Try to pick a filename.</span></span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            fn = os.path.join(dest, pattern % i)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fn):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dn = os.path.dirname(fn)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dn):</span><br><span class="line">                os.makedirs(dn)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> renpy.screenshot(fn):</span><br><span class="line">                renpy.notify(__(<span class="string">&quot;Failed to save screenshot as %s.&quot;</span>) % fn)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">import</span> traceback</span><br><span class="line">            traceback.print_exc()</span><br><span class="line">            renpy.notify(__(<span class="string">&quot;Failed to save screenshot as %s.&quot;</span>) % fn)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config.screenshot_callback <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            config.screenshot_callback(fn)</span><br><span class="line"></span><br><span class="line">    config.pre_screenshot_actions = [ ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot</span>():</span><br><span class="line">        renpy.run(config.pre_screenshot_actions)</span><br><span class="line">        renpy.invoke_in_main_thread(_screenshot_core)</span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot_callback</span>(<span class="params">fn</span>):</span><br><span class="line">        renpy.notify(__(<span class="string">&quot;Saved screenshot as %s.&quot;</span>) % fn)</span><br><span class="line"></span><br><span class="line">    config.screenshot_callback = _screenshot_callback</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fast_skip</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.fast_skipping <span class="keyword">and</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        Skip(fast=<span class="literal">True</span>, confirm=<span class="keyword">not</span> config.developer)()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_reload_game</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.autoreload:</span><br><span class="line">            renpy.exports.reload_script()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.get_autoreload():</span><br><span class="line">            renpy.set_autoreload(<span class="literal">False</span>)</span><br><span class="line">            renpy.restart_interaction()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.set_autoreload(<span class="literal">True</span>)</span><br><span class="line">            renpy.exports.reload_script()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_launch_editor</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        filename, line = renpy.get_filename_line()</span><br><span class="line">        renpy.launch_editor([ filename ], line)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_developer</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.show_screen(<span class="string">&quot;_developer&quot;</span>)</span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_profile_once</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.profile:</span><br><span class="line">            config.profile_time = <span class="number">10.0</span></span><br><span class="line">            config.profile = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        renpy.display.interface.profile_once = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_memory_profile</span>():</span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.experimental:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.memory.diff_memory()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_progress_screen</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context_nesting_level():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.get_screen(<span class="string">&quot;_progress&quot;</span>):</span><br><span class="line">            renpy.hide_screen(<span class="string">&quot;_progress&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.show_screen(<span class="string">&quot;_progress&quot;</span>)</span><br><span class="line"></span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">screen _progress:</span><br><span class="line">    layer config.interface_layer</span><br><span class="line"></span><br><span class="line">    $ new = renpy.count_newly_seen_dialogue_blocks()</span><br><span class="line">    $ seen = renpy.count_seen_dialogue_blocks()</span><br><span class="line">    $ total = renpy.count_dialogue_blocks()</span><br><span class="line"></span><br><span class="line">    drag:</span><br><span class="line">        draggable <span class="literal">True</span></span><br><span class="line">        focus_mask <span class="literal">None</span></span><br><span class="line">        xpos <span class="number">0</span></span><br><span class="line">        ypos <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        text <span class="string">&quot;[new] [seen]/[total]&quot;</span>:</span><br><span class="line">            size gui._scale(<span class="number">18</span>)</span><br><span class="line">            color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">            outlines [ (<span class="number">1</span>, <span class="string">&quot;#000&quot;</span>, <span class="number">0</span>, <span class="number">0</span>) ]</span><br><span class="line">            alt <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1100</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># The default keymap.</span></span><br><span class="line">    _default_keymap = renpy.Keymap(</span><br><span class="line">        rollback = renpy.rollback,</span><br><span class="line">        screenshot = _screenshot,</span><br><span class="line">        toggle_fullscreen = renpy.toggle_fullscreen,</span><br><span class="line">        toggle_afm = _keymap_toggle_afm,</span><br><span class="line">        toggle_skip = _keymap_toggle_skipping,</span><br><span class="line">        fast_skip = _fast_skip,</span><br><span class="line">        game_menu = _invoke_game_menu,</span><br><span class="line">        hide_windows = renpy.curried_call_in_new_context(<span class="string">&quot;_hide_windows&quot;</span>),</span><br><span class="line">        launch_editor = _launch_editor,</span><br><span class="line">        reload_game = _reload_game,</span><br><span class="line">        developer = _developer,</span><br><span class="line">        quit = renpy.quit_event,</span><br><span class="line">        iconify = renpy.iconify,</span><br><span class="line">        <span class="built_in">help</span> = _<span class="built_in">help</span>,</span><br><span class="line">        choose_renderer = renpy.curried_call_in_new_context(<span class="string">&quot;_choose_renderer&quot;</span>),</span><br><span class="line">        console = _console.enter,</span><br><span class="line">        profile_once = _profile_once,</span><br><span class="line">        memory_profile = _memory_profile,</span><br><span class="line">        self_voicing = Preference(<span class="string">&quot;self voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        clipboard_voicing = Preference(<span class="string">&quot;clipboard voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        debug_voicing = Preference(<span class="string">&quot;debug voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        extra_voicing = renpy.exports.speak_extra_alt,</span><br><span class="line">        progress_screen = _progress_screen,</span><br><span class="line">        director = director.Start(),</span><br><span class="line">        performance = ToggleScreen(<span class="string">&quot;_performance&quot;</span>),</span><br><span class="line">        accessibility = ToggleScreen(<span class="string">&quot;_accessibility&quot;</span>),</span><br><span class="line">        bubble_editor = bubble.ToggleShown(),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    config.underlay = [ _default_keymap ]</span><br><span class="line"></span><br><span class="line">    config.pre_screenshot_actions = [ Hide(<span class="string">&quot;notify&quot;</span>, immediately=<span class="literal">True</span>) ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">init <span class="number">1100</span> python hide:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;RENPY_DEFAULT_KEYMAP&quot;</span> <span class="keyword">in</span> os.environ:</span><br><span class="line">        renpy.config.keymap = renpy.config.default_keymap</span><br><span class="line">        config.underlay.insert(<span class="number">0</span>, _default_keymap)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">label _hide_windows:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> _windows_hidden:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> renpy.has_label(<span class="string">&quot;hide_windows&quot;</span>):</span><br><span class="line">        call hide_windows</span><br><span class="line">        <span class="keyword">if</span> _<span class="keyword">return</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    python:</span><br><span class="line">        _windows_hidden = <span class="literal">True</span></span><br><span class="line">        voice_sustain()</span><br><span class="line">        ui.saybehavior(dismiss=[<span class="string">&#x27;dismiss&#x27;</span>, <span class="string">&#x27;hide_windows&#x27;</span>])</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_window=<span class="literal">True</span>)</span><br><span class="line">        _windows_hidden = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">label _save_reload_game:</span><br><span class="line">    python hide:</span><br><span class="line"></span><br><span class="line">        renpy.music.stop()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.session.get(<span class="string">&quot;_reload_slot&quot;</span>, <span class="literal">None</span>) <span class="keyword">and</span> renpy.can_load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]):</span><br><span class="line">            renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (renpy.game.log <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (renpy.game.log.current <span class="keyword">is</span> <span class="literal">None</span>):</span><br><span class="line">            renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">        renpy.session[<span class="string">&quot;_reload_slot&quot;</span>] = <span class="string">&quot;_reload-1&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> time</span><br><span class="line">        renpy.session[<span class="string">&quot;_reload_time&quot;</span>] = time.time()</span><br><span class="line"></span><br><span class="line">        renpy.take_screenshot((config.thumbnail_width, config.thumbnail_height))</span><br><span class="line"></span><br><span class="line">        ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">        ui.text(<span class="string">&quot;Saving game...&quot;</span>,</span><br><span class="line">                size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_underlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        renpy.save(<span class="string">&quot;_reload-1&quot;</span>, <span class="string">&quot;reload save game&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">        ui.text(<span class="string">&quot;Reloading script...&quot;</span>,</span><br><span class="line">                size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_underlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">label _load_reload_game:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> renpy.session.get(<span class="string">&quot;_reload_slot&quot;</span>, <span class="literal">None</span>):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> renpy.can_load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]):</span><br><span class="line">        $ <span class="keyword">del</span> renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    python hide:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">            ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">            ui.text(<span class="string">&quot;Reloading game...&quot;</span>,</span><br><span class="line">                    size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">            ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">            ui.interact(suppress_underlay=<span class="literal">True</span>, suppress_overlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">            renpy.load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> (renpy.game.RestartTopContext, renpy.game.RestartContext):</span><br><span class="line"></span><br><span class="line">            renpy.rename_save(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>], <span class="string">&quot;_reload-2&quot;</span>)</span><br><span class="line">            <span class="keyword">del</span> renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]</span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以改为我设置的方案<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Copyright 2004-2024 Tom Rothamel &lt;pytom@bishoujo.us&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Permission is hereby granted, free of charge, to any person</span></span><br><span class="line"><span class="comment"># obtaining a copy of this software and associated documentation files</span></span><br><span class="line"><span class="comment"># (the &quot;Software&quot;), to deal in the Software without restriction,</span></span><br><span class="line"><span class="comment"># including without limitation the rights to use, copy, modify, merge,</span></span><br><span class="line"><span class="comment"># publish, distribute, sublicense, and/or sell copies of the Software,</span></span><br><span class="line"><span class="comment"># and to permit persons to whom the Software is furnished to do so,</span></span><br><span class="line"><span class="comment"># subject to the following conditions:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The above copyright notice and this permission notice shall be</span></span><br><span class="line"><span class="comment"># included in all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span></span><br><span class="line"><span class="comment"># EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span></span><br><span class="line"><span class="comment"># MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span></span><br><span class="line"><span class="comment"># NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</span></span><br><span class="line"><span class="comment"># LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</span></span><br><span class="line"><span class="comment"># OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</span></span><br><span class="line"><span class="comment"># WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1600</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">_keymap_list</span>(<span class="title class_ inherited__">_list</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">self, a</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                _<span class="built_in">list</span>.remove(<span class="variable language_">self</span>, a)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">if</span> config.developer:</span><br><span class="line">                    <span class="keyword">raise</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    config.keymap = <span class="built_in">dict</span>(</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Bindings present almost everywhere, unless explicitly</span></span><br><span class="line">        <span class="comment"># disabled.</span></span><br><span class="line">        rollback = [ ],</span><br><span class="line">        screenshot = [ ], </span><br><span class="line">        game_menu = [ ],</span><br><span class="line">        launch_editor = [ ],</span><br><span class="line">        dump_styles = [ ],</span><br><span class="line">        inspector = [ ],</span><br><span class="line">        full_inspector = [ ],</span><br><span class="line">        developer = [ ],</span><br><span class="line">        iconify = [ ],</span><br><span class="line">        choose_renderer = [ ],</span><br><span class="line">        progress_screen = [ ],</span><br><span class="line">        bubble_editor = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 以下为自定义快捷键</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ESC 退出游戏</span></span><br><span class="line">        quit = [ <span class="string">&#x27;K_ESCAPE&#x27;</span>],</span><br><span class="line">        <span class="comment"># F1 打开帮助界面</span></span><br><span class="line">        <span class="built_in">help</span> = [ <span class="string">&#x27;K_F1&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F2 打开存档界面</span></span><br><span class="line">        save = [ <span class="string">&#x27;K_F2&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F3 打开读档界面</span></span><br><span class="line">        load = [ <span class="string">&#x27;K_F3&#x27;</span>],</span><br><span class="line">        <span class="comment"># F4 切换全屏/窗口</span></span><br><span class="line">        toggle_fullscreen = [ <span class="string">&#x27;K_F4&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F5 打开历史记录界面</span></span><br><span class="line">        history = [ <span class="string">&#x27;K_F5&#x27;</span>],</span><br><span class="line">        <span class="comment"># F6 切换自动模式</span></span><br><span class="line">        toggle_afm = [ <span class="string">&#x27;K_F6&#x27;</span>],</span><br><span class="line">        <span class="comment"># F7 切换快进模式</span></span><br><span class="line">        toggle_skip = [ <span class="string">&#x27;K_F7&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F8 打开系统设置界面</span></span><br><span class="line">        preferences = [ <span class="string">&#x27;K_F8&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F9 语言重播</span></span><br><span class="line">        voice = [ <span class="string">&#x27;K_F9&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F10 返回标题菜单</span></span><br><span class="line">        title = [ <span class="string">&#x27;K_F10&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F11 快速存档</span></span><br><span class="line">        quick_save = [ <span class="string">&#x27;K_F11&#x27;</span> ],</span><br><span class="line">        <span class="comment"># F12 快速读档</span></span><br><span class="line">        quick_load = [ <span class="string">&#x27;K_F12&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># r 键重新加载游戏</span></span><br><span class="line">        reload_game = [ <span class="string">&#x27;K_r&#x27;</span> ],</span><br><span class="line">        <span class="comment"># h 键隐藏对话框</span></span><br><span class="line">        hide_windows = [ <span class="string">&#x27;K_h&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 更多快捷键请自行添加</span></span><br><span class="line">        <span class="comment"># 请注意底部添加的代码</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Accessibility.</span></span><br><span class="line">        accessibility = [ ],</span><br><span class="line">        self_voicing = [ ],</span><br><span class="line">        clipboard_voicing = [ ],</span><br><span class="line">        debug_voicing = [ ],</span><br><span class="line">        extra_voicing = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Say.</span></span><br><span class="line">        rollforward = [ <span class="string">&#x27;anyrepeat_K_PAGEDOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEDOWN&#x27;</span>, <span class="string">&#x27;mousedown_5&#x27;</span>, ],</span><br><span class="line">        <span class="comment"># 添加鼠标滚轮下滑推进游戏进度</span></span><br><span class="line">        dismiss = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_SPACE&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span>, <span class="string">&#x27;mouseup_1&#x27;</span>, <span class="string">&#x27;mousedown_5&#x27;</span> ],</span><br><span class="line">        dismiss_unfocused = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Pause.</span></span><br><span class="line">        dismiss_hard_pause = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Focus.</span></span><br><span class="line">        focus_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        focus_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        focus_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        focus_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Button.</span></span><br><span class="line">        button_ignore = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        button_select = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span>, <span class="string">&#x27;mouseup_1&#x27;</span>,  ],</span><br><span class="line">        button_alternate = [ <span class="string">&#x27;mouseup_3&#x27;</span> ],</span><br><span class="line">        button_alternate_ignore = [ <span class="string">&#x27;mousedown_3&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Input.</span></span><br><span class="line">        input_backspace = [ <span class="string">&#x27;anyrepeat_K_BACKSPACE&#x27;</span> ],</span><br><span class="line">        input_enter = [ <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span> ],</span><br><span class="line">        input_next_line = [ <span class="string">&#x27;shift_K_RETURN&#x27;</span>, <span class="string">&#x27;shift_K_KP_ENTER&#x27;</span> ],</span><br><span class="line">        input_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        input_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        input_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        input_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line">        input_delete = [ <span class="string">&#x27;anyrepeat_K_DELETE&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DELETE&#x27;</span> ],</span><br><span class="line">        input_home = [ <span class="string">&#x27;K_HOME&#x27;</span>, <span class="string">&#x27;KP_HOME&#x27;</span>, <span class="string">&#x27;meta_K_LEFT&#x27;</span> ],</span><br><span class="line">        input_end = [ <span class="string">&#x27;K_END&#x27;</span>, <span class="string">&#x27;KP_END&#x27;</span>, <span class="string">&#x27;meta_K_RIGHT&#x27;</span> ],</span><br><span class="line">        input_copy = [ <span class="string">&#x27;ctrl_noshift_K_INSERT&#x27;</span>, <span class="string">&#x27;ctrl_noshift_K_c&#x27;</span>, <span class="string">&#x27;meta_noshift_K_c&#x27;</span> ],</span><br><span class="line">        input_paste = [ <span class="string">&#x27;shift_K_INSERT&#x27;</span>, <span class="string">&#x27;ctrl_noshift_K_v&#x27;</span>, <span class="string">&#x27;meta_noshift_K_v&#x27;</span> ],</span><br><span class="line">        input_jump_word_left = [ <span class="string">&#x27;osctrl_K_LEFT&#x27;</span>, <span class="string">&#x27;osctrl_KP_LEFT&#x27;</span> ],</span><br><span class="line">        input_jump_word_right = [ <span class="string">&#x27;osctrl_K_RIGHT&#x27;</span>, <span class="string">&#x27;osctrl_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        input_delete_word = [ <span class="string">&#x27;osctrl_K_BACKSPACE&#x27;</span> ],</span><br><span class="line">        input_delete_full = [ <span class="string">&#x27;meta_K_BACKSPACE&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Viewport.</span></span><br><span class="line">        viewport_leftarrow = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        viewport_rightarrow = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        viewport_uparrow = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        viewport_downarrow = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line">        viewport_wheelup = [ <span class="string">&#x27;mousedown_4&#x27;</span> ],</span><br><span class="line">        viewport_wheeldown = [ <span class="string">&#x27;mousedown_5&#x27;</span> ],</span><br><span class="line">        viewport_drag_start = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        viewport_drag_end = [ <span class="string">&#x27;mouseup_1&#x27;</span> ],</span><br><span class="line">        viewport_pageup = [ <span class="string">&#x27;anyrepeat_K_PAGEUP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEUP&#x27;</span>],</span><br><span class="line">        viewport_pagedown = [ <span class="string">&#x27;anyrepeat_K_PAGEDOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_PAGEDOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># These keys control skipping.</span></span><br><span class="line">        skip = [ <span class="string">&#x27;anymod_K_LCTRL&#x27;</span>, <span class="string">&#x27;anymod_K_RCTRL&#x27;</span> ],</span><br><span class="line">        stop_skipping = [ ],</span><br><span class="line">        </span><br><span class="line">        fast_skip = [ <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;shift_K_PERIOD&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Bar.</span></span><br><span class="line">        bar_activate = [ <span class="string">&#x27;mousedown_1&#x27;</span>, <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span> ],</span><br><span class="line">        bar_deactivate = [ <span class="string">&#x27;mouseup_1&#x27;</span>, <span class="string">&#x27;K_RETURN&#x27;</span>, <span class="string">&#x27;K_KP_ENTER&#x27;</span>, <span class="string">&#x27;K_SELECT&#x27;</span> ],</span><br><span class="line">        bar_left = [ <span class="string">&#x27;anyrepeat_K_LEFT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_LEFT&#x27;</span> ],</span><br><span class="line">        bar_right = [ <span class="string">&#x27;anyrepeat_K_RIGHT&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_RIGHT&#x27;</span> ],</span><br><span class="line">        bar_up = [ <span class="string">&#x27;anyrepeat_K_UP&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_UP&#x27;</span> ],</span><br><span class="line">        bar_down = [ <span class="string">&#x27;anyrepeat_K_DOWN&#x27;</span>, <span class="string">&#x27;anyrepeat_KP_DOWN&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Delete a save.</span></span><br><span class="line">        save_delete = [ <span class="string">&#x27;K_DELETE&#x27;</span>, <span class="string">&#x27;KP_DELETE&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Save/load screen pagination.</span></span><br><span class="line">        save_page_prev = [<span class="string">&#x27;mousedown_4&#x27;</span>],</span><br><span class="line">        save_page_next = [<span class="string">&#x27;mousedown_5&#x27;</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Draggable.</span></span><br><span class="line">        drag_activate = [ <span class="string">&#x27;mousedown_1&#x27;</span> ],</span><br><span class="line">        drag_deactivate = [ <span class="string">&#x27;mouseup_1&#x27;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Debug console.</span></span><br><span class="line">        console = [ ],</span><br><span class="line">        console_exit = [  ],</span><br><span class="line">        console_older = [ ],</span><br><span class="line">        console_newer = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Director</span></span><br><span class="line">        director = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Ignored (kept for backwards compatibility).</span></span><br><span class="line">        toggle_music = [ ],</span><br><span class="line">        viewport_up = [ ],</span><br><span class="line">        viewport_down = [ ],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Profile commands.</span></span><br><span class="line">        performance = [ ],</span><br><span class="line">        image_load_log = [ ],</span><br><span class="line">        profile_once = [ ],</span><br><span class="line">        memory_profile = [ ],</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    config.default_keymap = &#123; k : _<span class="built_in">list</span>(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> config.keymap.items() &#125;</span><br><span class="line">    config.keymap = &#123; k : _keymap_list(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> config.keymap.items() &#125;</span><br><span class="line"></span><br><span class="line">    config.pad_bindings = &#123;</span><br><span class="line">        <span class="string">&quot;pad_leftshoulder_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_lefttrigger_pos&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_back_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_leftshoulder_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefttrigger_pos&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_back_press&quot;</span> : [ <span class="string">&quot;rollback&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_guide_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_start_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_y_press&quot;</span> : [ <span class="string">&quot;hide_windows&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;pad_x_press&quot;</span> : [ <span class="string">&quot;button_alternate&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_rightshoulder_press&quot;</span> : [ <span class="string">&quot;rollforward&quot;</span>, ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightshoulder_press&quot;</span> : [ <span class="string">&quot;rollforward&quot;</span>, ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_righttrigger_pos&quot;</span> : [ <span class="string">&quot;dismiss&quot;</span>, <span class="string">&quot;button_select&quot;</span>, <span class="string">&quot;bar_activate&quot;</span>, <span class="string">&quot;bar_deactivate&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_a_press&quot;</span> : [ <span class="string">&quot;dismiss&quot;</span>, <span class="string">&quot;button_select&quot;</span>, <span class="string">&quot;bar_activate&quot;</span>, <span class="string">&quot;bar_deactivate&quot;</span>],</span><br><span class="line">        <span class="string">&quot;pad_b_press&quot;</span> : [ <span class="string">&quot;game_menu&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpleft_press&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_leftx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_rightx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpright_press&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_leftx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_rightx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpup_press&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_lefty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_righty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;pad_dpdown_press&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_lefty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;pad_righty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpleft_press&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_leftx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightx_neg&quot;</span> : [ <span class="string">&quot;focus_left&quot;</span>, <span class="string">&quot;bar_left&quot;</span>, <span class="string">&quot;viewport_leftarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpright_press&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_leftx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_rightx_pos&quot;</span> : [ <span class="string">&quot;focus_right&quot;</span>, <span class="string">&quot;bar_right&quot;</span>, <span class="string">&quot;viewport_rightarrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpup_press&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_righty_neg&quot;</span> : [ <span class="string">&quot;focus_up&quot;</span>, <span class="string">&quot;bar_up&quot;</span>, <span class="string">&quot;viewport_uparrow&quot;</span> ],</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;repeat_pad_dpdown_press&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_lefty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;repeat_pad_righty_pos&quot;</span> : [ <span class="string">&quot;focus_down&quot;</span>, <span class="string">&quot;bar_down&quot;</span>, <span class="string">&quot;viewport_downarrow&quot;</span> ],</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Should we use the autoreload system?</span></span><br><span class="line">    config.autoreload = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1600</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Are the windows currently hidden?</span></span><br><span class="line">    _windows_hidden = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_keymap_toggle_afm</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.run(Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_toggle_skipping</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.config.allow_skipping:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.store._skipping:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.skipping:</span><br><span class="line">            config.skipping = <span class="string">&quot;slow&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            config.skipping = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            renpy.jump(<span class="string">&quot;_noisy_return&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">    toggle_skipping = _toggle_skipping</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_keymap_toggle_skipping</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        _toggle_skipping()</span><br><span class="line"></span><br><span class="line">    config.<span class="built_in">help</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    config.help_screen = <span class="string">&quot;help&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_help</span>(<span class="params"><span class="built_in">help</span>=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">help</span> <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">help</span> = config.<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">help</span> <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> config.help_screen <span class="keyword">and</span> renpy.has_screen(config.help_screen):</span><br><span class="line">                renpy.run(ShowMenu(config.help_screen))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.has_label(<span class="built_in">help</span>):</span><br><span class="line">            renpy.call_in_new_context(<span class="built_in">help</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">help</span>.startswith(<span class="string">&#x27;http://&#x27;</span>) <span class="keyword">or</span> <span class="built_in">help</span>.startswith(<span class="string">&#x27;https://&#x27;</span>):</span><br><span class="line">                renpy.open_url(<span class="built_in">help</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            file_path = os.path.join(config.basedir, <span class="built_in">help</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(file_path):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            renpy.open_url(<span class="string">&quot;file:///&quot;</span> + file_path)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    config.screenshot_pattern = os.environ.get(<span class="string">&quot;RENPY_SCREENSHOT_PATTERN&quot;</span>, <span class="string">&quot;screenshot%04d.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Called to make a screenshot happen.</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot_core</span>():</span><br><span class="line">        <span class="keyword">import</span> os.path</span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">        dest = config.renpy_base</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.macapp:</span><br><span class="line">            dest = os.path.expanduser(<span class="string">&quot;~/Desktop&quot;</span>)</span><br><span class="line"></span><br><span class="line">        pattern = renpy.store._screenshot_pattern <span class="keyword">or</span> config.screenshot_pattern</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Try to pick a filename.</span></span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            fn = os.path.join(dest, pattern % i)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fn):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dn = os.path.dirname(fn)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dn):</span><br><span class="line">                os.makedirs(dn)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> renpy.screenshot(fn):</span><br><span class="line">                renpy.notify(__(<span class="string">&quot;Failed to save screenshot as %s.&quot;</span>) % fn)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">import</span> traceback</span><br><span class="line">            traceback.print_exc()</span><br><span class="line">            renpy.notify(__(<span class="string">&quot;Failed to save screenshot as %s.&quot;</span>) % fn)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config.screenshot_callback <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            config.screenshot_callback(fn)</span><br><span class="line"></span><br><span class="line">    config.pre_screenshot_actions = [ ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot</span>():</span><br><span class="line">        renpy.run(config.pre_screenshot_actions)</span><br><span class="line">        renpy.invoke_in_main_thread(_screenshot_core)</span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_screenshot_callback</span>(<span class="params">fn</span>):</span><br><span class="line">        renpy.notify(__(<span class="string">&quot;Saved screenshot as %s.&quot;</span>) % fn)</span><br><span class="line"></span><br><span class="line">    config.screenshot_callback = _screenshot_callback</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fast_skip</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.fast_skipping <span class="keyword">and</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        Skip(fast=<span class="literal">True</span>, confirm=<span class="keyword">not</span> config.developer)()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_reload_game</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.autoreload:</span><br><span class="line">            renpy.exports.reload_script()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.get_autoreload():</span><br><span class="line">            renpy.set_autoreload(<span class="literal">False</span>)</span><br><span class="line">            renpy.restart_interaction()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.set_autoreload(<span class="literal">True</span>)</span><br><span class="line">            renpy.exports.reload_script()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_launch_editor</span>():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        filename, line = renpy.get_filename_line()</span><br><span class="line">        renpy.launch_editor([ filename ], line)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_developer</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.developer:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.show_screen(<span class="string">&quot;_developer&quot;</span>)</span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_profile_once</span>():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> config.profile:</span><br><span class="line">            config.profile_time = <span class="number">10.0</span></span><br><span class="line">            config.profile = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        renpy.display.interface.profile_once = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_memory_profile</span>():</span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> renpy.experimental:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        renpy.memory.diff_memory()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_progress_screen</span>():</span><br><span class="line">        <span class="keyword">if</span> renpy.context_nesting_level():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.get_screen(<span class="string">&quot;_progress&quot;</span>):</span><br><span class="line">            renpy.hide_screen(<span class="string">&quot;_progress&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            renpy.show_screen(<span class="string">&quot;_progress&quot;</span>)</span><br><span class="line"></span><br><span class="line">        renpy.restart_interaction()</span><br><span class="line"></span><br><span class="line">screen _progress:</span><br><span class="line">    layer config.interface_layer</span><br><span class="line"></span><br><span class="line">    $ new = renpy.count_newly_seen_dialogue_blocks()</span><br><span class="line">    $ seen = renpy.count_seen_dialogue_blocks()</span><br><span class="line">    $ total = renpy.count_dialogue_blocks()</span><br><span class="line"></span><br><span class="line">    drag:</span><br><span class="line">        draggable <span class="literal">True</span></span><br><span class="line">        focus_mask <span class="literal">None</span></span><br><span class="line">        xpos <span class="number">0</span></span><br><span class="line">        ypos <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        text <span class="string">&quot;[new] [seen]/[total]&quot;</span>:</span><br><span class="line">            size gui._scale(<span class="number">18</span>)</span><br><span class="line">            color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">            outlines [ (<span class="number">1</span>, <span class="string">&quot;#000&quot;</span>, <span class="number">0</span>, <span class="number">0</span>) ]</span><br><span class="line">            alt <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">init -<span class="number">1100</span> python:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># The default keymap.</span></span><br><span class="line">    _default_keymap = renpy.Keymap(</span><br><span class="line">        rollback = renpy.rollback,</span><br><span class="line">        screenshot = _screenshot,</span><br><span class="line">        toggle_fullscreen = renpy.toggle_fullscreen,</span><br><span class="line">        toggle_afm = _keymap_toggle_afm,</span><br><span class="line">        toggle_skip = _keymap_toggle_skipping,</span><br><span class="line">        fast_skip = _fast_skip,</span><br><span class="line">        game_menu = _invoke_game_menu,</span><br><span class="line">        hide_windows = renpy.curried_call_in_new_context(<span class="string">&quot;_hide_windows&quot;</span>),</span><br><span class="line">        launch_editor = _launch_editor,</span><br><span class="line">        reload_game = _reload_game,</span><br><span class="line">        developer = _developer,</span><br><span class="line">        quit = renpy.quit_event,</span><br><span class="line">        iconify = renpy.iconify,</span><br><span class="line">        <span class="built_in">help</span> = _<span class="built_in">help</span>,</span><br><span class="line">        choose_renderer = renpy.curried_call_in_new_context(<span class="string">&quot;_choose_renderer&quot;</span>),</span><br><span class="line">        console = _console.enter,</span><br><span class="line">        profile_once = _profile_once,</span><br><span class="line">        memory_profile = _memory_profile,</span><br><span class="line">        self_voicing = Preference(<span class="string">&quot;self voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        clipboard_voicing = Preference(<span class="string">&quot;clipboard voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        debug_voicing = Preference(<span class="string">&quot;debug voicing&quot;</span>, <span class="string">&quot;toggle&quot;</span>),</span><br><span class="line">        extra_voicing = renpy.exports.speak_extra_alt,</span><br><span class="line">        progress_screen = _progress_screen,</span><br><span class="line">        director = director.Start(),</span><br><span class="line">        performance = ToggleScreen(<span class="string">&quot;_performance&quot;</span>),</span><br><span class="line">        accessibility = ToggleScreen(<span class="string">&quot;_accessibility&quot;</span>),</span><br><span class="line">        bubble_editor = bubble.ToggleShown(),</span><br><span class="line">        <span class="comment"># 以下为新添加内容</span></span><br><span class="line">        save = ShowMenu(<span class="string">&quot;save&quot;</span>),</span><br><span class="line">        load = ShowMenu(<span class="string">&quot;load&quot;</span>),</span><br><span class="line">        history = ShowMenu(<span class="string">&quot;history&quot;</span>),</span><br><span class="line">        preferences = ShowMenu(<span class="string">&quot;preferences&quot;</span>),</span><br><span class="line">        voice = VoiceReplay(),</span><br><span class="line">        title = MainMenu(),</span><br><span class="line">        quick_save = QuickSave(message=<span class="string">&#x27;Quick save complete.&#x27;</span>, newest=<span class="literal">False</span>),</span><br><span class="line">        quick_load = QuickLoad(confirm=<span class="literal">False</span>),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    config.underlay = [ _default_keymap ]</span><br><span class="line"></span><br><span class="line">    config.pre_screenshot_actions = [ Hide(<span class="string">&quot;notify&quot;</span>, immediately=<span class="literal">True</span>) ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">init <span class="number">1100</span> python hide:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;RENPY_DEFAULT_KEYMAP&quot;</span> <span class="keyword">in</span> os.environ:</span><br><span class="line">        renpy.config.keymap = renpy.config.default_keymap</span><br><span class="line">        config.underlay.insert(<span class="number">0</span>, _default_keymap)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">label _hide_windows:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> renpy.context()._menu:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> _windows_hidden:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> renpy.has_label(<span class="string">&quot;hide_windows&quot;</span>):</span><br><span class="line">        call hide_windows</span><br><span class="line">        <span class="keyword">if</span> _<span class="keyword">return</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    python:</span><br><span class="line">        _windows_hidden = <span class="literal">True</span></span><br><span class="line">        voice_sustain()</span><br><span class="line">        ui.saybehavior(dismiss=[<span class="string">&#x27;dismiss&#x27;</span>, <span class="string">&#x27;hide_windows&#x27;</span>])</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_window=<span class="literal">True</span>)</span><br><span class="line">        _windows_hidden = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">label _save_reload_game:</span><br><span class="line">    python hide:</span><br><span class="line"></span><br><span class="line">        renpy.music.stop()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.session.get(<span class="string">&quot;_reload_slot&quot;</span>, <span class="literal">None</span>) <span class="keyword">and</span> renpy.can_load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]):</span><br><span class="line">            renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (renpy.game.log <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (renpy.game.log.current <span class="keyword">is</span> <span class="literal">None</span>):</span><br><span class="line">            renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">        renpy.session[<span class="string">&quot;_reload_slot&quot;</span>] = <span class="string">&quot;_reload-1&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> time</span><br><span class="line">        renpy.session[<span class="string">&quot;_reload_time&quot;</span>] = time.time()</span><br><span class="line"></span><br><span class="line">        renpy.take_screenshot((config.thumbnail_width, config.thumbnail_height))</span><br><span class="line"></span><br><span class="line">        ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">        ui.text(<span class="string">&quot;Saving game...&quot;</span>,</span><br><span class="line">                size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_underlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        renpy.save(<span class="string">&quot;_reload-1&quot;</span>, <span class="string">&quot;reload save game&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">        ui.text(<span class="string">&quot;Reloading script...&quot;</span>,</span><br><span class="line">                size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">        ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">        ui.interact(suppress_overlay=<span class="literal">True</span>, suppress_underlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        renpy.utter_restart()</span><br><span class="line"></span><br><span class="line">label _load_reload_game:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> renpy.session.get(<span class="string">&quot;_reload_slot&quot;</span>, <span class="literal">None</span>):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> renpy.can_load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]):</span><br><span class="line">        $ <span class="keyword">del</span> renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    python hide:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">            ui.add(Solid((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)))</span><br><span class="line">            ui.text(<span class="string">&quot;Reloading game...&quot;</span>,</span><br><span class="line">                    size=<span class="number">32</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">0.5</span>, color=<span class="string">&quot;#fff&quot;</span>, style=<span class="string">&quot;_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">            ui.pausebehavior(<span class="number">0</span>)</span><br><span class="line">            ui.interact(suppress_underlay=<span class="literal">True</span>, suppress_overlay=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">            renpy.load(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> (renpy.game.RestartTopContext, renpy.game.RestartContext):</span><br><span class="line"></span><br><span class="line">            renpy.rename_save(renpy.session[<span class="string">&quot;_reload_slot&quot;</span>], <span class="string">&quot;_reload-2&quot;</span>)</span><br><span class="line">            <span class="keyword">del</span> renpy.session[<span class="string">&quot;_reload_slot&quot;</span>]</span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h1 id="选择界面"><a href="#选择界面" class="headerlink" title="选择界面"></a>选择界面</h1><p>向样式中添加背景图即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">style choice_button <span class="keyword">is</span> default:</span><br><span class="line">    background Frame(<span class="string">&quot;gui/choice/choice.png&quot;</span>,xsize=<span class="number">800</span>,ysize=<span class="number">66</span>)</span><br><span class="line">    hover_background<span class="string">&quot;gui/choice/choice_hover.png&quot;</span></span><br><span class="line">    xysize(<span class="number">800</span>,<span class="number">66</span>)</span><br></pre></td></tr></table></figure></p><h1 id="确认界面"><a href="#确认界面" class="headerlink" title="确认界面"></a>确认界面</h1><p>添加背景图即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">screen confirm(message, yes_action, no_action):</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 显示此屏幕时，确保其他屏幕无法输入。</span></span><br><span class="line">    modal <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    zorder <span class="number">200</span></span><br><span class="line">    add <span class="string">&quot;gui/confirm/firme.png&quot;</span></span><br><span class="line"></span><br><span class="line">    text _(message):</span><br><span class="line">        layout <span class="string">&quot;subtitle&quot;</span></span><br><span class="line">        color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">        size <span class="number">30</span></span><br><span class="line">        align (<span class="number">0.5</span>,<span class="number">0.45</span>)</span><br><span class="line">        xoffset <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    hbox:</span><br><span class="line">        align (<span class="number">0.5</span>,<span class="number">0.55</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        xoffset <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;gui/confirm/yes.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;gui/confirm/yes_hover.png&quot;</span></span><br><span class="line">            action yes_action</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;gui/confirm/no.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;gui/confirm/no_hover.png&quot;</span></span><br><span class="line">            action no_action</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 右键点击退出并答复 no（取消）。</span></span><br><span class="line">    key <span class="string">&quot;game_menu&quot;</span> action no_action</span><br><span class="line">    on <span class="string">&quot;show&quot;</span> action MouseMove(<span class="number">850</span>,<span class="number">570</span>)</span><br><span class="line"></span><br><span class="line">style confirm_frame <span class="keyword">is</span> gui_frame</span><br><span class="line">style confirm_prompt <span class="keyword">is</span> gui_prompt</span><br><span class="line">style confirm_prompt_text <span class="keyword">is</span> gui_prompt_text</span><br><span class="line">style confirm_button <span class="keyword">is</span> gui_medium_button</span><br><span class="line">style confirm_button_text <span class="keyword">is</span> gui_medium_button_text</span><br><span class="line"></span><br><span class="line">style confirm_frame:</span><br><span class="line">    background Frame([ <span class="string">&quot;gui/confirm_frame.png&quot;</span>, <span class="string">&quot;gui/frame.png&quot;</span>], gui.confirm_frame_borders, tile=gui.frame_tile)</span><br><span class="line">    padding gui.confirm_frame_borders.padding</span><br><span class="line">    xalign <span class="number">.5</span></span><br><span class="line">    yalign <span class="number">.5</span></span><br><span class="line"></span><br><span class="line">style confirm_prompt_text:</span><br><span class="line">    textalign <span class="number">0.5</span></span><br><span class="line">    layout <span class="string">&quot;subtitle&quot;</span></span><br><span class="line"></span><br><span class="line">style confirm_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;confirm_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style confirm_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;confirm_button&quot;</span>)</span><br></pre></td></tr></table></figure><br>想要修改显示文字可以修改<code>game/tl/None/common.rpym</code></p><h1 id="快进指示界面"><a href="#快进指示界面" class="headerlink" title="快进指示界面"></a>快进指示界面</h1><p>没什么用，建议删除<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 快进指示屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## skip_indicator 屏幕用于指示快进正在进行中。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://www.renpy.cn/doc/screen_special.html#skip-indicator</span></span><br><span class="line"></span><br><span class="line">screen skip_indicator():</span><br><span class="line"></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line">    style_prefix <span class="string">&quot;skip&quot;</span></span><br><span class="line"></span><br><span class="line">    frame:</span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">9</span></span><br><span class="line"></span><br><span class="line">            text _(<span class="string">&quot;正在快进&quot;</span>)</span><br><span class="line"></span><br><span class="line">            text <span class="string">&quot;▸&quot;</span> at delayed_blink(<span class="number">0.0</span>, <span class="number">1.0</span>) style <span class="string">&quot;skip_triangle&quot;</span></span><br><span class="line">            text <span class="string">&quot;▸&quot;</span> at delayed_blink(<span class="number">0.2</span>, <span class="number">1.0</span>) style <span class="string">&quot;skip_triangle&quot;</span></span><br><span class="line">            text <span class="string">&quot;▸&quot;</span> at delayed_blink(<span class="number">0.4</span>, <span class="number">1.0</span>) style <span class="string">&quot;skip_triangle&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 此变换用于一个接一个地闪烁箭头。</span></span><br><span class="line">transform delayed_blink(delay, cycle):</span><br><span class="line">    alpha <span class="number">.5</span></span><br><span class="line"></span><br><span class="line">    pause delay</span><br><span class="line"></span><br><span class="line">    block:</span><br><span class="line">        linear <span class="number">.2</span> alpha <span class="number">1.0</span></span><br><span class="line">        pause <span class="number">.2</span></span><br><span class="line">        linear <span class="number">.2</span> alpha <span class="number">0.5</span></span><br><span class="line">        pause (cycle - <span class="number">.4</span>)</span><br><span class="line">        repeat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style skip_frame <span class="keyword">is</span> empty</span><br><span class="line">style skip_text <span class="keyword">is</span> gui_text</span><br><span class="line">style skip_triangle <span class="keyword">is</span> skip_text</span><br><span class="line"></span><br><span class="line">style skip_frame:</span><br><span class="line">    ypos gui.skip_ypos</span><br><span class="line">    background Frame(<span class="string">&quot;gui/skip.png&quot;</span>, gui.skip_frame_borders, tile=gui.frame_tile)</span><br><span class="line">    padding gui.skip_frame_borders.padding</span><br><span class="line"></span><br><span class="line">style skip_text:</span><br><span class="line">    size gui.notify_text_size</span><br><span class="line"></span><br><span class="line">style skip_triangle:</span><br><span class="line">    <span class="comment">## 我们必须使用包含“▸”（黑色右旋小三角）字形的字体。</span></span><br><span class="line">    font <span class="string">&quot;DejaVuSans.ttf&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p><code>game/tl/None/common.rpym</code>中修改<code>536~538</code>行为<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># renpy/common/00library.rpy:248</span></span><br><span class="line">old <span class="string">&quot;Skip Mode&quot;</span></span><br><span class="line">new <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure></p><p>底部菜单新增<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正在快进</span></span><br><span class="line"><span class="keyword">if</span> renpy.is_skipping():</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;skipping&quot;</span></span><br><span class="line">        action Skip() alternate Skip(fast=<span class="literal">False</span>, confirm=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 没有快进</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/skip.png&quot;</span></span><br><span class="line">        insensitive <span class="string">&quot;gui/skip_off.png&quot;</span></span><br><span class="line">        action Skip() alternate Skip(fast=<span class="literal">False</span>, confirm=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></p><p>帧动画定义<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#快进指示</span></span><br><span class="line">image skipping:</span><br><span class="line">    anim.Filmstrip(<span class="string">&quot;skipping.png&quot;</span>,(<span class="number">10</span>,<span class="number">10</span>),(<span class="number">1</span>,<span class="number">58</span>),<span class="number">.023</span>,loop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></p><h1 id="通知界面"><a href="#通知界面" class="headerlink" title="通知界面"></a>通知界面</h1><p>可以不用修改，直接替换同名图像即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">screen notify(message):</span><br><span class="line"></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line">    style_prefix <span class="string">&quot;notify&quot;</span></span><br><span class="line"></span><br><span class="line">    frame at notify_appear:</span><br><span class="line">        text <span class="string">&quot;[message!tq]&quot;</span></span><br><span class="line"></span><br><span class="line">    timer <span class="number">3.25</span> action Hide(<span class="string">&#x27;notify&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">transform notify_appear:</span><br><span class="line">    on show:</span><br><span class="line">        alpha <span class="number">0</span></span><br><span class="line">        linear <span class="number">.25</span> alpha <span class="number">1.0</span></span><br><span class="line">    on hide:</span><br><span class="line">        linear <span class="number">.5</span> alpha <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style notify_frame <span class="keyword">is</span> empty</span><br><span class="line">style notify_text <span class="keyword">is</span> gui_text</span><br><span class="line"></span><br><span class="line">style notify_frame:</span><br><span class="line">    ypos gui.notify_ypos</span><br><span class="line"></span><br><span class="line">    background Frame(<span class="string">&quot;gui/notify.png&quot;</span>, gui.notify_frame_borders, tile=gui.frame_tile)</span><br><span class="line">    padding gui.notify_frame_borders.padding</span><br><span class="line"></span><br><span class="line">style notify_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;notify&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中快捷键展示界面，选择界面，确认界面以及快进指示界面的一些修改。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 系统设置界面修改(三)</title>
    <link href="http://lucylcarus.github.io/posts/d87f7e0c.html"/>
    <id>http://lucylcarus.github.io/posts/d87f7e0c.html</id>
    <published>2024-12-06T12:20:06.000Z</published>
    <updated>2024-12-08T08:04:19.473Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文修改全部位于<code>screens.rpy</code>文件中</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li><a href="https://doc.renpy.cn/zh-CN/voice.html#voice-actions">角色音量</a></li><li><a href="https://doc.renpy.cn/zh-CN/config.html#var-config.emphasize_audio_channels">播放语音时BGM音量</a></li><li><a href="https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=1616&amp;highlight=%E9%9F%B3%E9%87%8F">非线性问题解决</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1zMqLYVE94&cid=27229423555&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="常规音量设置"><a href="#常规音量设置" class="headerlink" title="常规音量设置"></a>常规音量设置</h1><h2 id="新建界面"><a href="#新建界面" class="headerlink" title="新建界面"></a>新建界面</h2><p>先新建一个界面，添加必要部分，参考代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">screen sound():</span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;preference_bg.png&quot;</span></span><br><span class="line">    <span class="comment">## 子菜单</span></span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;system.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;hover_system.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;message.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;hover_message.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;sound_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;sound&#x27;</span>)</span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">1260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;dialog.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;dialog_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;dialog&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;voi.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;voi_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;voice&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;shortcut.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;shortcut_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;shortcut&#x27;</span>)</span><br><span class="line">   <span class="comment">## 返回按钮</span></span><br><span class="line">    hbox:</span><br><span class="line">        align (<span class="number">1.0</span>,<span class="number">1.0</span>)</span><br><span class="line">        xoffset -<span class="number">50</span></span><br><span class="line">        yoffset -<span class="number">50</span></span><br><span class="line">        spacing <span class="number">20</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> main_menu:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;return_title.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;return_title_hover.png&quot;</span></span><br><span class="line">                action MainMenu()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;end_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;end_game_hover.png&quot;</span></span><br><span class="line">            action Quit()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;return_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;return_game_hover.png&quot;</span></span><br><span class="line">            action Return()</span><br></pre></td></tr></table></figure><h2 id="功能选项"><a href="#功能选项" class="headerlink" title="功能选项"></a>功能选项</h2><h3 id="全部音量"><a href="#全部音量" class="headerlink" title="全部音量"></a>全部音量</h3><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;主音量&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value Preference(<span class="string">&quot;main volume&quot;</span>,<span class="built_in">range</span>=<span class="number">100</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ main_volume = <span class="built_in">int</span>(preferences.get_mixer(<span class="string">&quot;main&quot;</span>)*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[main_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure><h3 id="音乐音量"><a href="#音乐音量" class="headerlink" title="音乐音量"></a>音乐音量</h3><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;BGM音量&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value Preference(<span class="string">&quot;music volume&quot;</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ music_volume = <span class="built_in">int</span>(preferences.get_mixer(<span class="string">&quot;music&quot;</span>)*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[music_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></p><h3 id="音效音量"><a href="#音效音量" class="headerlink" title="音效音量"></a>音效音量</h3><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;音效音量&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value Preference(<span class="string">&quot;sound volume&quot;</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ sound_volume = <span class="built_in">int</span>(preferences.get_mixer(<span class="string">&quot;sfx&quot;</span>)*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[sound_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure><h3 id="播放语音时BGM音量"><a href="#播放语音时BGM音量" class="headerlink" title="播放语音时BGM音量"></a>播放语音时BGM音量</h3><ol><li><p>定义</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 播放语音时降低bgm音量</span></span><br><span class="line">default preferences.emphasize_audio = <span class="literal">True</span></span><br><span class="line"><span class="comment">## 只能使用define</span></span><br><span class="line">define config.emphasize_audio_channels = [ <span class="string">&#x27;voice&#x27;</span> ]</span><br><span class="line">define config.emphasize_audio_time = <span class="number">0.5</span></span><br><span class="line">define config.emphasize_audio_volume = <span class="number">0.5</span></span><br><span class="line"><span class="comment">## 自定义变量解决上面问题</span></span><br><span class="line">default voicing_bgm_volume = <span class="number">0.5</span></span><br></pre></td></tr></table></figure></li><li><p>设置</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;播放语音时BGM音量&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value VariableValue(<span class="string">&quot;voicing_bgm_volume&quot;</span>,<span class="built_in">range</span>=<span class="number">1.0</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ config.emphasize_audio_volume = voicing_bgm_volume</span><br><span class="line">                $ text_voicing_bgm_volume = <span class="built_in">int</span>(voicing_bgm_volume*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[text_voicing_bgm_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="显示BGM名称"><a href="#显示BGM名称" class="headerlink" title="显示BGM名称"></a>显示BGM名称</h3><ol><li><p>定义</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 显示歌曲名称</span></span><br><span class="line">default music_name_always = <span class="literal">True</span></span><br><span class="line">default music_name_five_seconds = <span class="literal">False</span></span><br><span class="line">default music_name_never = <span class="literal">False</span></span><br></pre></td></tr></table></figure></li><li><p>新建界面</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 音乐弹窗</span></span><br><span class="line">default bgm_name=<span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line">screen music_name():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 获取当前正在播放的BGM</span></span><br><span class="line">    $ music_file_name=renpy.music.get_playing(channel = <span class="string">&#x27;music&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 确保显示为正确的文件名</span></span><br><span class="line">    timer <span class="number">0.01</span>:</span><br><span class="line">        action SetVariable(<span class="string">&quot;music_file_name&quot;</span>,renpy.music.get_playing(channel = <span class="string">&#x27;music&#x27;</span>))</span><br><span class="line">        repeat <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 将文件名替换为歌曲名</span></span><br><span class="line">    <span class="keyword">if</span> music_file_name == <span class="string">&quot;bgm22.ogg&quot;</span>:</span><br><span class="line">        $ bgm_name = <span class="string">&quot;红茶与布丁&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> music_file_name == <span class="string">&quot;bgm12.ogg&quot;</span>:</span><br><span class="line">        $ bgm_name = <span class="string">&quot;星空下的芭芭露&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">## 总是显示</span></span><br><span class="line">    <span class="keyword">if</span> music_name_always:</span><br><span class="line">        <span class="keyword">if</span> renpy.music.is_playing(channel = <span class="string">&#x27;music&#x27;</span>):</span><br><span class="line">            frame:</span><br><span class="line">                at music_name_always_appear</span><br><span class="line">                background <span class="string">&quot;music_name_bg.png&quot;</span></span><br><span class="line">                text <span class="string">&quot;[bgm_name]&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">80</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">    <span class="comment">## 显示五秒</span></span><br><span class="line">    <span class="keyword">elif</span> music_name_five_seconds:</span><br><span class="line">        <span class="keyword">if</span> renpy.music.is_playing(channel = <span class="string">&#x27;music&#x27;</span>):</span><br><span class="line">            frame:</span><br><span class="line">                at music_name_five_seconds_appear</span><br><span class="line">                background <span class="string">&quot;music_name_bg.png&quot;</span></span><br><span class="line">                text <span class="string">&quot;[bgm_name]&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">80</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">    <span class="comment">## 不显示</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 总是显示</span></span><br><span class="line">transform music_name_always_appear:</span><br><span class="line">    xoffset -<span class="number">600</span></span><br><span class="line">    easein <span class="number">1.0</span> xoffset <span class="number">0</span></span><br><span class="line"><span class="comment">## 显示五秒</span></span><br><span class="line">transform music_name_five_seconds_appear:</span><br><span class="line">    xoffset -<span class="number">600</span></span><br><span class="line">    easein <span class="number">1.0</span> xoffset <span class="number">0</span></span><br><span class="line">    pause <span class="number">5.0</span></span><br><span class="line">    easeout <span class="number">1.0</span> xoffset -<span class="number">600</span></span><br></pre></td></tr></table></figure></li><li><p>设置</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;显示歌曲名称&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            <span class="comment">## 总是显示</span></span><br><span class="line">            <span class="keyword">if</span> music_name_always:</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_always_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_five_seconds.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_five_seconds_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_never.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_never_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>,<span class="literal">True</span> )]</span><br><span class="line">            <span class="comment">## 显示五秒</span></span><br><span class="line">            <span class="keyword">elif</span> music_name_five_seconds:</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_always.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_always_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_five_seconds_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_never.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_never_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>,<span class="literal">True</span> )]</span><br><span class="line">            <span class="comment">## 不显示</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_always.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_always_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_five_seconds.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;music_name_five_seconds_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;music_name_never_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;music_name_always&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_five_seconds&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;music_name_never&quot;</span>,<span class="literal">True</span> )]</span><br></pre></td></tr></table></figure></li><li><p>使用方法<br> 每次播放音乐时展示该界面，停止播放音乐时隐藏该界面，添加<code>pause</code>语句增强视觉体验效果</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">stop music</span><br><span class="line">hide screen music_name</span><br><span class="line">pause <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">play music <span class="string">&quot;bgm22.ogg&quot;</span></span><br><span class="line">show screen music_name</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>开发日志</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 日志</span></span><br><span class="line"><span class="comment">## 2024.11.23</span></span><br><span class="line"><span class="comment">## 尝试使用 config.overlay_screens.append(&quot;music_name&quot;) 显示该界面</span></span><br><span class="line"><span class="comment">## 结果 1. 总是显示切换bgm时歌曲信息会直接覆盖，需要隐藏或回退</span></span><br><span class="line"><span class="comment">##      2. 显示五秒只会显示第一次播放的bgm，后续切换bgm无法显示</span></span><br><span class="line"><span class="comment">##      3. 历史记录跳转等情况下，歌曲信息更新不及时</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 尝试直接在 say 界面运行</span></span><br><span class="line"><span class="comment">## 结果 每次点击都会重新运行</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 尝试使用自定义变量对比当前正在播放的音乐文件名</span></span><br><span class="line"><span class="comment">## 结果 获取值为固定值</span></span><br><span class="line"><span class="comment">## </span></span><br><span class="line"><span class="comment">## 尝试定义不同的界面实现不同的设置</span></span><br><span class="line"><span class="comment">## 结果 无法获取 music_file_name</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 本质问题 切换 bgm 时需要重新运行该界面，但 renpy 并没有提供切换音乐相关说明</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 2024.11.27</span></span><br><span class="line"><span class="comment">## 放弃使用函数、变量等，直接在 play/stop music 后添加 show/hide screen music_name</span></span><br><span class="line"><span class="comment">## 结果 除切换 bgm 展示该界面时会与前一个叠加外，效果意外不错，添加 pause 语句设置为 0.5 达到理想效果</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 继续尝试添加 on &quot;hide&quot; 语句，发生报错，无法与 pause 语句一同使用</span></span><br><span class="line"><span class="comment">## 尝试将 pause 语句加入 transform 语句中，表现效果不佳，放弃使用 on &quot;hide&quot; 语句</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 最终解决方法 1. 尝试添加 timer 语句，控制为 0.01 解决歌曲信息更新不及时问题</span></span><br><span class="line"><span class="comment">##             2. 每次播放 bgm 时显示该界面，停止播放时隐藏该界面，同时暂停0.5s</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 测试 除需要每次使用 play/stop music 时要添加额外语句外，暂未发现问题</span></span><br><span class="line"><span class="comment">## 新游戏，读档，历史记录跳转，更改该界面相关设置等行为会重新显示该界面，</span></span><br><span class="line"><span class="comment">## 其他情况下保持不变，同一 bgm 下保留音乐播放进度</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="角色音量设置"><a href="#角色音量设置" class="headerlink" title="角色音量设置"></a>角色音量设置</h1><h2 id="新建界面-1"><a href="#新建界面-1" class="headerlink" title="新建界面"></a>新建界面</h2><p>先新建一个界面，添加必要部分，参考代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">screen voice:</span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;preference_bg.png&quot;</span></span><br><span class="line">    <span class="comment">## 子菜单</span></span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;system.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;hover_system.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;message.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;hover_message.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;sound.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;sound_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;sound&#x27;</span>)</span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">1260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;dialog.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;dialog_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;dialog&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;voi_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;voice&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;shortcut.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;shortcut_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;shortcut&#x27;</span>)</span><br><span class="line">    <span class="comment">## 返回按钮</span></span><br><span class="line">    hbox:</span><br><span class="line">        align (<span class="number">1.0</span>,<span class="number">1.0</span>)</span><br><span class="line">        xoffset -<span class="number">50</span></span><br><span class="line">        yoffset -<span class="number">50</span></span><br><span class="line">        spacing <span class="number">20</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> main_menu:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;return_title.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;return_title_hover.png&quot;</span></span><br><span class="line">                action MainMenu()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;end_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;end_game_hover.png&quot;</span></span><br><span class="line">            action Quit()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;return_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;return_game_hover.png&quot;</span></span><br><span class="line">            action Return()</span><br></pre></td></tr></table></figure></p><h2 id="功能选项-1"><a href="#功能选项-1" class="headerlink" title="功能选项"></a>功能选项</h2><h3 id="语音音量"><a href="#语音音量" class="headerlink" title="语音音量"></a>语音音量</h3><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;主音量&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value Preference(<span class="string">&quot;voice volume&quot;</span>,<span class="built_in">range</span>=<span class="number">100</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ voice_volume=<span class="built_in">int</span>(preferences.get_mixer(<span class="string">&quot;voice&quot;</span>)*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[voice_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></p><h3 id="单独角色音量"><a href="#单独角色音量" class="headerlink" title="单独角色音量"></a>单独角色音量</h3><p>添加如下代码</p><ol><li>定义 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">init python:</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 判断字典存不存在，不存在则创建</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">hasattr</span>(persistent, <span class="string">&#x27;_character_volume&#x27;</span>):</span><br><span class="line">        persistent._character_volume = &#123;&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 判断字典的 key 存不存在，不存在创建 key 并赐值</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;bingzhi&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> persistent._character_volume:</span><br><span class="line">        persistent._character_volume[<span class="string">&#x27;bingzhi&#x27;</span>] = <span class="number">1.0</span>  </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;yaliu&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> persistent._character_volume:</span><br><span class="line">        persistent._character_volume[<span class="string">&#x27;yaliu&#x27;</span>] = <span class="number">1.0</span>  </span><br></pre></td></tr></table></figure></li><li>设置 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;圣代桥冰织&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    vbox:</span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            bar:</span><br><span class="line">                value DictValue(<span class="built_in">dict</span>=persistent._character_volume ,key=<span class="string">&quot;bingzhi&quot;</span>, <span class="built_in">range</span>=<span class="number">1.0</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                $ bz_voice_volume = <span class="built_in">int</span>(GetCharacterVolume(<span class="string">&quot;bingzhi&quot;</span>)*<span class="number">100</span>)</span><br><span class="line">                text <span class="string">&quot;[bz_voice_volume]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="单独角色静音"><a href="#单独角色静音" class="headerlink" title="单独角色静音"></a>单独角色静音</h3><ol><li>定义<br> Ren’py中没有返回<code>voice_tag</code>相关混音器状态的函数，但默认都是启用的，使用自定义变量达到相同效果 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">default bz_mute = <span class="literal">False</span></span><br><span class="line">default yl_mute = <span class="literal">False</span></span><br><span class="line">default others_mute = <span class="literal">False</span></span><br></pre></td></tr></table></figure></li><li>设置 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">hbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    <span class="comment">## 静音</span></span><br><span class="line">    <span class="keyword">if</span> bz_mute:</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">            action [SetVoiceMute(voice_tag=<span class="string">&quot;bingzhi&quot;</span>, mute=<span class="literal">False</span>),SetVariable(<span class="string">&quot;bz_mute&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">            action [SetVoiceMute(voice_tag=<span class="string">&quot;bingzhi&quot;</span>, mute=<span class="literal">True</span>),SetVariable(<span class="string">&quot;bz_mute&quot;</span>, <span class="literal">True</span>)]</span><br><span class="line">    <span class="comment">## 正常情况下</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">            action [SetVoiceMute(voice_tag=<span class="string">&quot;bingzhi&quot;</span>, mute=<span class="literal">False</span>),SetVariable(<span class="string">&quot;bz_mute&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">            action [SetVoiceMute(voice_tag=<span class="string">&quot;bingzhi&quot;</span>, mute=<span class="literal">True</span>),SetVariable(<span class="string">&quot;bz_mute&quot;</span>, <span class="literal">True</span>)]</span><br></pre></td></tr></table></figure></li></ol><h1 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h1><p>按钮可以使用如下属性</p><ol><li>使用<code>hover_sound</code>可以在悬停时播放音效</li><li>使用<code>activate_sound</code>可以在点击时播放音效(系统语音的本质，不过是随机或是指定的)</li><li>使用<code>mouse</code>可以更改悬停在其上时鼠标光标样式</li></ol>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中系统设置界面的一些修改，包括音乐、音效音量设置以及单独角色音量设置等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 系统设置界面修改(二)</title>
    <link href="http://lucylcarus.github.io/posts/ffb5ca8d.html"/>
    <id>http://lucylcarus.github.io/posts/ffb5ca8d.html</id>
    <published>2024-11-25T12:14:39.000Z</published>
    <updated>2024-12-04T04:54:31.790Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文修改全部位于<code>screens.rpy</code>文件中</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li><a href="https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=1067">文字显示速度预览</a></li><li><a href="https://www.bilibili.com/opus/917056160034455554">对话框透明度调整</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1pZziY7En4&cid=27089634189&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="新建界面"><a href="#新建界面" class="headerlink" title="新建界面"></a>新建界面</h1><p>先新建一个界面，添加必要部分，参考代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">screen message():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line">    </span><br><span class="line">    add <span class="string">&quot;preference_bg.png&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## 子菜单</span></span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;system.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;hover_system.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;hover_message.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;sound.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;sound_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;sound&#x27;</span>)</span><br><span class="line">    hbox:</span><br><span class="line">        pos(<span class="number">1260</span>,<span class="number">40</span>)</span><br><span class="line">        spacing <span class="number">30</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;dialog.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;dialog_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;dialog&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;voi.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;voi_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;voice&#x27;</span>)</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;shortcut.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;shortcut_hover.png&quot;</span></span><br><span class="line">            action ShowMenu(<span class="string">&#x27;shortcut&#x27;</span>)</span><br><span class="line">   <span class="comment">## 返回按钮</span></span><br><span class="line">    hbox:</span><br><span class="line">        align (<span class="number">1.0</span>,<span class="number">1.0</span>)</span><br><span class="line">        xoffset -<span class="number">50</span></span><br><span class="line">        yoffset -<span class="number">50</span></span><br><span class="line">        spacing <span class="number">20</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> main_menu:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;return_title.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;return_title_hover.png&quot;</span></span><br><span class="line">                action MainMenu()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;end_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;end_game_hover.png&quot;</span></span><br><span class="line">            action Quit()</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle <span class="string">&quot;return_game.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;return_game_hover.png&quot;</span></span><br><span class="line">            action Return()</span><br></pre></td></tr></table></figure><h1 id="功能选项"><a href="#功能选项" class="headerlink" title="功能选项"></a>功能选项</h1><h2 id="文字显示速度"><a href="#文字显示速度" class="headerlink" title="文字显示速度"></a>文字显示速度</h2><p>由于文字显示速度只受<code>preferences.text_cps</code>影响，但我们需要至少<code>常规模式下文本显示速度</code>和<code>自动模式下文本显示速度</code>两个选项，所以采用自定义变量的方法实现</p><ol><li>自定义变量 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 常规模式下文本显示速度</span></span><br><span class="line">default normal_text_cps=<span class="number">50</span></span><br><span class="line"><span class="comment">## 自动模式下文本显示速度</span></span><br><span class="line">default afm_text_cps = <span class="number">50</span></span><br></pre></td></tr></table></figure></li><li><code>say</code>界面中添加如下代码<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 常规文本显示速度</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> _preferences.afm_enable:</span><br><span class="line">    $ preferences.text_cps = normal_text_cps</span><br><span class="line"><span class="comment">## 自动模式下文本显示速度</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    $ preferences.text_cps = afm_text_cps</span><br></pre></td></tr></table></figure></li><li>添加如下代码<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    xpos <span class="number">100</span></span><br><span class="line">    yalign <span class="number">0.5</span></span><br><span class="line">    spacing <span class="number">50</span></span><br><span class="line">    vbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">10</span></span><br><span class="line">            add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">            text <span class="string">&quot;文本显示速度&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">            </span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">5</span></span><br><span class="line">            bar:</span><br><span class="line">                value VariableValue(<span class="string">&quot;normal_text_cps&quot;</span>,<span class="built_in">range</span>=<span class="number">100</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                text <span class="string">&quot;[normal_text_cps]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br><span class="line">vbox:</span><br><span class="line">    xpos <span class="number">750</span></span><br><span class="line">    yoffset -<span class="number">73</span></span><br><span class="line">    yalign <span class="number">0.5</span></span><br><span class="line">    spacing <span class="number">50</span></span><br><span class="line">    vbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">10</span></span><br><span class="line">            add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">            text <span class="string">&quot;自动模式文本阅读速度&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">5</span></span><br><span class="line">            bar:</span><br><span class="line">                value VariableValue(<span class="string">&quot;afm_text_cps&quot;</span>,<span class="built_in">range</span>=<span class="number">100</span>)</span><br><span class="line">                xsize <span class="number">425</span></span><br><span class="line">                right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">                left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">                thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">                text <span class="string">&quot;[afm_text_cps]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="自动模式下等待时间"><a href="#自动模式下等待时间" class="headerlink" title="自动模式下等待时间"></a>自动模式下等待时间</h2><p>添加如下代码即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;自动模式速度&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">5</span></span><br><span class="line">        bar:</span><br><span class="line">            value Preference(<span class="string">&quot;auto-forward time&quot;</span>,<span class="built_in">range</span>=<span class="number">100</span>)</span><br><span class="line">            xsize <span class="number">425</span></span><br><span class="line">            right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">            left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">            thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">        frame:</span><br><span class="line">            background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">            $ auto_text_speed=<span class="built_in">int</span>(preferences.afm_time)</span><br><span class="line">            text <span class="string">&quot;[auto_text_speed]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></p><h2 id="自动模式下是否等待语音播放完毕"><a href="#自动模式下是否等待语音播放完毕" class="headerlink" title="自动模式下是否等待语音播放完毕"></a>自动模式下是否等待语音播放完毕</h2><p>添加如下代码即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;自动模式下是否等待语音播放完毕&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 等待语音播放完毕</span></span><br><span class="line">        <span class="keyword">if</span> preferences.wait_voice ==<span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;wait for voice&quot;</span>, <span class="string">&quot;enable&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;wait for voice&quot;</span>, <span class="string">&quot;disable&quot;</span>) </span><br><span class="line">        <span class="comment">## 不等待语音播放完毕</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;wait for voice&quot;</span>, <span class="string">&quot;enable&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;wait for voice&quot;</span>, <span class="string">&quot;disable&quot;</span>) </span><br></pre></td></tr></table></figure></p><h2 id="对话框透明度"><a href="#对话框透明度" class="headerlink" title="对话框透明度"></a>对话框透明度</h2><ol><li><p>自定义变量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 对话框不透明度</span></span><br><span class="line">default persistent.textbox_transparency = <span class="number">0.2</span></span><br></pre></td></tr></table></figure></li><li><p><code>say</code>界面中做出如下修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 文本框透明度</span></span><br><span class="line">$ textbox_alpha = <span class="number">1</span> - persistent.textbox_transparency</span><br><span class="line">window:</span><br><span class="line">    <span class="built_in">id</span> <span class="string">&quot;window&quot;</span></span><br><span class="line">    <span class="comment">## 调节对话框透明度</span></span><br><span class="line">    background Image(im.Alpha(<span class="string">&quot;gui/textbox.png&quot;</span>, textbox_alpha), xalign=<span class="number">0.5</span>, yalign=<span class="number">1.0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> who <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line"></span><br><span class="line">        window:</span><br><span class="line">            <span class="built_in">id</span> <span class="string">&quot;namebox&quot;</span></span><br><span class="line">            <span class="comment">## 调节姓名框透明度</span></span><br><span class="line">            background Image(im.Alpha(<span class="string">&quot;gui/namebox.png&quot;</span>, textbox_alpha))</span><br><span class="line">            style <span class="string">&quot;namebox&quot;</span></span><br><span class="line">            text who <span class="built_in">id</span> <span class="string">&quot;who&quot;</span> xoffset <span class="number">60</span> yoffset -<span class="number">30</span></span><br></pre></td></tr></table></figure></li><li><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;对话框透明度&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">5</span></span><br><span class="line">        bar:</span><br><span class="line">            value FieldValue(persistent, <span class="string">&quot;textbox_transparency&quot;</span>, <span class="built_in">range</span>=<span class="number">1.0</span>, style=<span class="string">&quot;slider&quot;</span>)</span><br><span class="line">            xsize <span class="number">425</span></span><br><span class="line">            right_bar <span class="string">&quot;volume.png&quot;</span></span><br><span class="line">            left_bar <span class="string">&quot;volume_left.png&quot;</span></span><br><span class="line">            thumb <span class="string">&quot;thu.png&quot;</span></span><br><span class="line">        frame:</span><br><span class="line">            background <span class="string">&quot;volume_num.png&quot;</span></span><br><span class="line">            $ textbox_alpha=<span class="built_in">int</span>(persistent.textbox_transparency*<span class="number">100</span>)</span><br><span class="line">            text <span class="string">&quot;[textbox_alpha]&quot;</span> xoffset <span class="number">10</span> yoffset -<span class="number">8</span></span><br></pre></td></tr></table></figure></li></ol><div class="note info modern"><p><code>preference</code>为声明为持久化变量的标识，在设置界面中，请尽量使用持久化数据</p></div><h2 id="文字阴影"><a href="#文字阴影" class="headerlink" title="文字阴影"></a>文字阴影</h2><ol><li><p>自定义变量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 文字阴影</span></span><br><span class="line">default text_shadow = <span class="literal">True</span></span><br></pre></td></tr></table></figure></li><li><p><code>say</code>界面中做出如下修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 已读文本变色</span></span><br><span class="line"><span class="keyword">if</span> text_color_changeable == <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 有文字阴影</span></span><br><span class="line">    <span class="keyword">if</span> text_shadow == <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        <span class="comment">## 已被查看(不包括当前文本)</span></span><br><span class="line">        <span class="keyword">if</span> renpy.is_seen(ever = <span class="literal">True</span>):</span><br><span class="line">            text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color  <span class="string">&quot;#FFFF00&quot;</span> outlines [(<span class="number">4</span>,<span class="string">&quot;#000000&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)]</span><br><span class="line">        <span class="comment">## 未被查看</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span> outlines [(<span class="number">4</span>,<span class="string">&quot;#000000&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 无文字阴影</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">## 已被查看(不包括当前文本)</span></span><br><span class="line">        <span class="keyword">if</span> renpy.is_seen(ever = <span class="literal">True</span>):</span><br><span class="line">            text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color  <span class="string">&quot;#FFFF00&quot;</span></span><br><span class="line">        <span class="comment">## 未被查看</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 不允许已读文本变色</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment">## 有文字阴影</span></span><br><span class="line">    <span class="keyword">if</span> text_shadow == <span class="literal">True</span>:</span><br><span class="line">        text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span> outlines [(<span class="number">4</span>,<span class="string">&quot;#000000&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)]</span><br><span class="line">    <span class="comment">## 无文字阴影</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;文本阴影&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 有文本阴影</span></span><br><span class="line">        <span class="keyword">if</span> text_shadow==<span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_shadow&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_shadow&quot;</span>, <span class="literal">False</span>)</span><br><span class="line">        <span class="comment">## 无文本阴影</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_shadow&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_shadow&quot;</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="快进设置"><a href="#快进设置" class="headerlink" title="快进设置"></a>快进设置</h2><p>添加如下代码即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;快进未读文本&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 仅已读文本</span></span><br><span class="line">        <span class="keyword">if</span> preferences.skip_unseen == <span class="literal">False</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;only_read.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;skip&quot;</span>, <span class="string">&quot;seen&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;all_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;all.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;skip&quot;</span>, <span class="string">&quot;all&quot;</span>)</span><br><span class="line">        <span class="comment">## 全部</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;only_read_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;only_read.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;skip&quot;</span>, <span class="string">&quot;seen&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;all.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;skip&quot;</span>, <span class="string">&quot;all&quot;</span>)</span><br></pre></td></tr></table></figure></p><h2 id="语音中断"><a href="#语音中断" class="headerlink" title="语音中断"></a>语音中断</h2><p>添加如下代码即可<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;语音中断&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 语音中断</span></span><br><span class="line">        <span class="keyword">if</span> preferences.voice_sustain ==<span class="literal">False</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;voice sustain&quot;</span>, <span class="string">&quot;disable&quot;</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;voice sustain&quot;</span>, <span class="string">&quot;enable&quot;</span>)</span><br><span class="line">        <span class="comment">## 不中断</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;voice sustain&quot;</span>, <span class="string">&quot;disable&quot;</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;voice sustain&quot;</span>, <span class="string">&quot;enable&quot;</span>)</span><br></pre></td></tr></table></figure></p><h2 id="文本显示速度预览"><a href="#文本显示速度预览" class="headerlink" title="文本显示速度预览"></a>文本显示速度预览</h2><ol><li><p>新建界面</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">screen textbox_preview():</span><br><span class="line">    tag preview</span><br><span class="line">    frame:</span><br><span class="line">        pos (<span class="number">750</span>,<span class="number">750</span>)</span><br><span class="line">        background <span class="literal">None</span></span><br><span class="line">        <span class="comment">## 默认模式</span></span><br><span class="line">        <span class="keyword">if</span> text_normal:</span><br><span class="line">            <span class="keyword">if</span> text_shadow:</span><br><span class="line">                text <span class="string">&quot;文本展示速度\n这是文本播放时的速度&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">20</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">                    color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                    outlines [(<span class="number">2</span>, <span class="string">&quot;#000&quot;</span>,<span class="number">0</span>, <span class="number">0</span>)] </span><br><span class="line">                    slow_cps normal_text_cps</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                text <span class="string">&quot;文本展示速度\n这是文本播放时的速度&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">20</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">                    color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                    slow_cps normal_text_cps</span><br><span class="line">        <span class="comment">## 自动模式</span></span><br><span class="line">        <span class="keyword">elif</span> text_auto:</span><br><span class="line">            <span class="keyword">if</span> text_shadow:</span><br><span class="line">                text <span class="string">&quot;自动模式速度\n这是自动模式下的速度&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">20</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">                    color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                    outlines [(<span class="number">2</span>, <span class="string">&quot;#000&quot;</span>,<span class="number">0</span>, <span class="number">0</span>)] </span><br><span class="line">                    slow_cps afm_text_cps</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                text <span class="string">&quot;自动模式速度\n这是自动模式下的速度&quot;</span>:</span><br><span class="line">                    xoffset <span class="number">20</span></span><br><span class="line">                    yoffset <span class="number">10</span></span><br><span class="line">                    color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                    slow_cps afm_text_cps</span><br><span class="line">        <span class="comment">## 不显示</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>轮换时间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 轮换时间</span></span><br><span class="line">define textbox_preview_repeat_time = <span class="number">3.0</span></span><br><span class="line">default countdown_time = <span class="number">0.0</span></span><br></pre></td></tr></table></figure></li><li><p>启用设置</p><ol><li><p><code>message</code>界面中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">default display_preview = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> display_preview:</span><br><span class="line"></span><br><span class="line">        timer <span class="number">0.2</span>:</span><br><span class="line">            action Show(<span class="string">&quot;textbox_preview&quot;</span>)</span><br><span class="line"></span><br><span class="line">    timer <span class="number">2.0</span>:</span><br><span class="line">        repeat <span class="literal">True</span></span><br><span class="line">        action [Hide(<span class="string">&#x27;textbox_preview&#x27;</span>),SetVariable(<span class="string">&quot;countdown_time&quot;</span>,textbox_preview_repeat_time+<span class="number">1.0</span>),Show(<span class="string">&quot;textbox_preview&quot;</span>)]</span><br><span class="line"></span><br><span class="line">$ box_alpha = <span class="number">1</span> - persistent.textbox_transparency</span><br><span class="line">frame:</span><br><span class="line">    xpos <span class="number">750</span></span><br><span class="line">    ypos <span class="number">750</span></span><br><span class="line">    background Image(im.Alpha(<span class="string">&quot;text_bg.png&quot;</span>, box_alpha), xalign=<span class="number">0.5</span>, yalign=<span class="number">1.0</span>)</span><br></pre></td></tr></table></figure></li><li><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;文字显示速度预览&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 默认模式</span></span><br><span class="line">        <span class="keyword">if</span> text_normal:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;normal.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;auto_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;auto.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;none_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;none.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>,<span class="literal">True</span> )]</span><br><span class="line">        <span class="comment">## 自动模式</span></span><br><span class="line">        <span class="keyword">elif</span> text_auto:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;normal_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;normal.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;auto.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;none_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;none.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>,<span class="literal">True</span> )]</span><br><span class="line">        <span class="comment">## 不显示</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;normal_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;normal.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;auto_hover.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;auto.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;none.png&quot;</span></span><br><span class="line">                action [SetVariable(<span class="string">&quot;text_normal&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_auto&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;text_none&quot;</span>,<span class="literal">True</span> )]</span><br></pre></td></tr></table></figure></li></ol></li><li><p>日志&amp;<code>bug</code>排查</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 文字显示速度预览</span></span><br><span class="line"><span class="comment">## 代码来源 https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=1067</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 问题 存在 bug 前往其他界面时文字会卡到其他界面</span></span><br><span class="line"><span class="comment">## 产生bug的原因 timer 语句不间断的 hide 与 show 行为</span></span><br><span class="line"><span class="comment">## 解决方法 前往其他界面的 action 行为中添加 Hide(&quot;textbox_preview&quot;)</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 2024.11.15</span></span><br><span class="line"><span class="comment">## 问题 添加背景后，文字显示于背景下方</span></span><br><span class="line"><span class="comment">## 解决方法 将 use textbox_preview 删去，第一个 timer 语句改为0.2s后显示 textbox_preview</span></span><br><span class="line"><span class="comment">## 最终效果还算理想</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中系统设置界面的一些修改，包括文本显示速度设置及其预览等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 系统设置界面修改(一)</title>
    <link href="http://lucylcarus.github.io/posts/508451ef.html"/>
    <id>http://lucylcarus.github.io/posts/508451ef.html</id>
    <published>2024-11-20T12:14:39.000Z</published>
    <updated>2024-12-04T05:17:56.650Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文修改全部位于<code>screens.rpy</code>文件中</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li><a href="https://doc.renpy.cn/zh-CN/preferences.html">环境变量</a></li><li><a href="https://doc.renpy.cn/zh-CN/screen_actions.html#Preference">Preference行为</a></li></ol><p><strong>特别感谢renpy官方交流群群友倾情相助</strong></p><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1EkUmY8Ey3&cid=26870417035&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="查看源代码"><a href="#查看源代码" class="headerlink" title="查看源代码"></a>查看源代码</h1><p>打开<code>screens.rpy</code>文件，你可以在708行看到如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 设置屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 设置屏幕允许用户配置游戏，使其更适合自己。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://doc.renpy.cn/zh-CN/screen_special.html#preferences</span></span><br><span class="line"></span><br><span class="line">screen preferences():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    use game_menu(_(<span class="string">&quot;设置&quot;</span>), scroll=<span class="string">&quot;viewport&quot;</span>):</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line"></span><br><span class="line">            hbox:</span><br><span class="line">                box_wrap <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> renpy.variant(<span class="string">&quot;pc&quot;</span>) <span class="keyword">or</span> renpy.variant(<span class="string">&quot;web&quot;</span>):</span><br><span class="line"></span><br><span class="line">                    vbox:</span><br><span class="line">                        style_prefix <span class="string">&quot;radio&quot;</span></span><br><span class="line">                        label _(<span class="string">&quot;显示&quot;</span>)</span><br><span class="line">                        textbutton _(<span class="string">&quot;窗口&quot;</span>) action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;window&quot;</span>)</span><br><span class="line">                        textbutton _(<span class="string">&quot;全屏&quot;</span>) action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;fullscreen&quot;</span>)</span><br><span class="line"></span><br><span class="line">                vbox:</span><br><span class="line">                    style_prefix <span class="string">&quot;check&quot;</span></span><br><span class="line">                    label _(<span class="string">&quot;快进&quot;</span>)</span><br><span class="line">                    textbutton _(<span class="string">&quot;未读文本&quot;</span>) action Preference(<span class="string">&quot;skip&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                    textbutton _(<span class="string">&quot;选项后继续&quot;</span>) action Preference(<span class="string">&quot;after choices&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                    textbutton _(<span class="string">&quot;忽略转场&quot;</span>) action InvertSelected(Preference(<span class="string">&quot;transitions&quot;</span>, <span class="string">&quot;toggle&quot;</span>))</span><br><span class="line"></span><br><span class="line">                <span class="comment">## 可在此处添加 radio_pref 或 check_pref 类型的额外 vbox，以添加</span></span><br><span class="line">                <span class="comment">## 额外的创建者定义的偏好设置。</span></span><br><span class="line"></span><br><span class="line">            null height (<span class="number">4</span> * gui.pref_spacing)</span><br><span class="line"></span><br><span class="line">            hbox:</span><br><span class="line">                style_prefix <span class="string">&quot;slider&quot;</span></span><br><span class="line">                box_wrap <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                vbox:</span><br><span class="line"></span><br><span class="line">                    label _(<span class="string">&quot;文字速度&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    bar value Preference(<span class="string">&quot;text speed&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    label _(<span class="string">&quot;自动前进时间&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    bar value Preference(<span class="string">&quot;auto-forward time&quot;</span>)</span><br><span class="line"></span><br><span class="line">                vbox:</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> config.has_music:</span><br><span class="line">                        label _(<span class="string">&quot;音乐音量&quot;</span>)</span><br><span class="line"></span><br><span class="line">                        hbox:</span><br><span class="line">                            bar value Preference(<span class="string">&quot;music volume&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> config.has_sound:</span><br><span class="line"></span><br><span class="line">                        label _(<span class="string">&quot;音效音量&quot;</span>)</span><br><span class="line"></span><br><span class="line">                        hbox:</span><br><span class="line">                            bar value Preference(<span class="string">&quot;sound volume&quot;</span>)</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> config.sample_sound:</span><br><span class="line">                                textbutton _(<span class="string">&quot;测试&quot;</span>) action Play(<span class="string">&quot;sound&quot;</span>, config.sample_sound)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> config.has_voice:</span><br><span class="line">                        label _(<span class="string">&quot;语音音量&quot;</span>)</span><br><span class="line"></span><br><span class="line">                        hbox:</span><br><span class="line">                            bar value Preference(<span class="string">&quot;voice volume&quot;</span>)</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> config.sample_voice:</span><br><span class="line">                                textbutton _(<span class="string">&quot;测试&quot;</span>) action Play(<span class="string">&quot;voice&quot;</span>, config.sample_voice)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> config.has_music <span class="keyword">or</span> config.has_sound <span class="keyword">or</span> config.has_voice:</span><br><span class="line">                        null height gui.pref_spacing</span><br><span class="line"></span><br><span class="line">                        textbutton _(<span class="string">&quot;全部静音&quot;</span>):</span><br><span class="line">                            action Preference(<span class="string">&quot;all mute&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                            style <span class="string">&quot;mute_all_button&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style pref_label <span class="keyword">is</span> gui_label</span><br><span class="line">style pref_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line">style pref_vbox <span class="keyword">is</span> vbox</span><br><span class="line"></span><br><span class="line">style radio_label <span class="keyword">is</span> pref_label</span><br><span class="line">style radio_label_text <span class="keyword">is</span> pref_label_text</span><br><span class="line">style radio_button <span class="keyword">is</span> gui_button</span><br><span class="line">style radio_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line">style radio_vbox <span class="keyword">is</span> pref_vbox</span><br><span class="line"></span><br><span class="line">style check_label <span class="keyword">is</span> pref_label</span><br><span class="line">style check_label_text <span class="keyword">is</span> pref_label_text</span><br><span class="line">style check_button <span class="keyword">is</span> gui_button</span><br><span class="line">style check_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line">style check_vbox <span class="keyword">is</span> pref_vbox</span><br><span class="line"></span><br><span class="line">style slider_label <span class="keyword">is</span> pref_label</span><br><span class="line">style slider_label_text <span class="keyword">is</span> pref_label_text</span><br><span class="line">style slider_slider <span class="keyword">is</span> gui_slider</span><br><span class="line">style slider_button <span class="keyword">is</span> gui_button</span><br><span class="line">style slider_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line">style slider_pref_vbox <span class="keyword">is</span> pref_vbox</span><br><span class="line"></span><br><span class="line">style mute_all_button <span class="keyword">is</span> check_button</span><br><span class="line">style mute_all_button_text <span class="keyword">is</span> check_button_text</span><br><span class="line"></span><br><span class="line">style pref_label:</span><br><span class="line">    top_margin gui.pref_spacing</span><br><span class="line">    bottom_margin <span class="number">3</span></span><br><span class="line"></span><br><span class="line">style pref_label_text:</span><br><span class="line">    yalign <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">style pref_vbox:</span><br><span class="line">    xsize <span class="number">338</span></span><br><span class="line"></span><br><span class="line">style radio_vbox:</span><br><span class="line">    spacing gui.pref_button_spacing</span><br><span class="line"></span><br><span class="line">style radio_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;radio_button&quot;</span>)</span><br><span class="line">    foreground <span class="string">&quot;gui/button/radio_[prefix_]foreground.png&quot;</span></span><br><span class="line"></span><br><span class="line">style radio_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;radio_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style check_vbox:</span><br><span class="line">    spacing gui.pref_button_spacing</span><br><span class="line"></span><br><span class="line">style check_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;check_button&quot;</span>)</span><br><span class="line">    foreground <span class="string">&quot;gui/button/check_[prefix_]foreground.png&quot;</span></span><br><span class="line"></span><br><span class="line">style check_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;check_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slider_slider:</span><br><span class="line">    xsize <span class="number">525</span></span><br><span class="line"></span><br><span class="line">style slider_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;slider_button&quot;</span>)</span><br><span class="line">    yalign <span class="number">0.5</span></span><br><span class="line">    left_margin <span class="number">15</span></span><br><span class="line"></span><br><span class="line">style slider_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;slider_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slider_vbox:</span><br><span class="line">    xsize <span class="number">675</span></span><br></pre></td></tr></table></figure><h1 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h1><p>我们先确定系统设置界面的功能，这里我分为六部分</p><p>由于<code>imagebutton</code>使用效果不佳，同时为给用户提示当前设置，我们使用<code>if</code>语句对当前环境变量进行判断，不过有些未给出的变量需要我们自定义</p><h2 id="全屏窗口切换"><a href="#全屏窗口切换" class="headerlink" title="全屏窗口切换"></a>全屏窗口切换</h2><p>修改为如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;屏幕尺寸&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span></span><br><span class="line">        <span class="comment">## 窗口状态下</span></span><br><span class="line">        <span class="keyword">if</span> preferences.fullscreen == <span class="literal">False</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;fullscreen.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;hover_fullscreen.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;fullscreen&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_window.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;window&quot;</span>)</span><br><span class="line">        <span class="comment">## 全屏状态下</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_fullscreen.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;fullscreen&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;window.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;hover_window.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;window&quot;</span>)</span><br></pre></td></tr></table></figure></p><h2 id="是否显示转场"><a href="#是否显示转场" class="headerlink" title="是否显示转场"></a>是否显示转场</h2><p>修改为如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;转场效果&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 显示所有转场</span></span><br><span class="line">        <span class="keyword">if</span> preferences.transitions == <span class="number">2</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;transitions&quot;</span>, <span class="string">&quot;all&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;transitions&quot;</span>, <span class="string">&quot;none&quot;</span>)</span><br><span class="line">        <span class="comment">## 忽略所有转场</span></span><br><span class="line">        <span class="keyword">if</span> preferences.transitions == <span class="number">0</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;transitions&quot;</span>, <span class="string">&quot;all&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;transitions&quot;</span>, <span class="string">&quot;none&quot;</span>)</span><br></pre></td></tr></table></figure></p><div class="note info modern"><p>忽略转场实际上忽略的是<code>with</code>从句的效果</p></div><h2 id="鼠标自动移动"><a href="#鼠标自动移动" class="headerlink" title="鼠标自动移动"></a>鼠标自动移动</h2><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;鼠标自动移动&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 允许鼠标自动移动</span></span><br><span class="line">        <span class="keyword">if</span> preferences.mouse_move == <span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;automatic move&quot;</span>, <span class="string">&quot;enable&quot;</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;automatic move&quot;</span>, <span class="string">&quot;disable&quot;</span>)</span><br><span class="line">        <span class="comment">## 禁止鼠标自动移动</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;automatic move&quot;</span>, <span class="string">&quot;enable&quot;</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;automatic move&quot;</span>, <span class="string">&quot;disable&quot;</span>)</span><br></pre></td></tr></table></figure><br>来到<code>screens.rpy</code>文件第1121行，你会看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 确认屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 当 Ren&#x27;Py 需要询问用户有关确定或取消的问题时，会调用确认屏幕。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://doc.renpy.cn/zh-CN/screen_special.html#confirm</span></span><br><span class="line"></span><br><span class="line">screen confirm(message, yes_action, no_action):</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 显示此屏幕时，确保其他屏幕无法输入。</span></span><br><span class="line">    modal <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    zorder <span class="number">200</span></span><br><span class="line"></span><br><span class="line">    style_prefix <span class="string">&quot;confirm&quot;</span></span><br><span class="line"></span><br><span class="line">    add <span class="string">&quot;gui/overlay/confirm.png&quot;</span></span><br><span class="line"></span><br><span class="line">    frame:</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            xalign <span class="number">.5</span></span><br><span class="line">            yalign <span class="number">.5</span></span><br><span class="line">            spacing <span class="number">45</span></span><br><span class="line"></span><br><span class="line">            label _(message):</span><br><span class="line">                style <span class="string">&quot;confirm_prompt&quot;</span></span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">            hbox:</span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                spacing <span class="number">150</span></span><br><span class="line"></span><br><span class="line">                textbutton _(<span class="string">&quot;确定&quot;</span>) action yes_action</span><br><span class="line">                textbutton _(<span class="string">&quot;取消&quot;</span>) action no_action</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 右键点击退出并答复 no（取消）。</span></span><br><span class="line">    key <span class="string">&quot;game_menu&quot;</span> action no_action</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style confirm_frame <span class="keyword">is</span> gui_frame</span><br><span class="line">style confirm_prompt <span class="keyword">is</span> gui_prompt</span><br><span class="line">style confirm_prompt_text <span class="keyword">is</span> gui_prompt_text</span><br><span class="line">style confirm_button <span class="keyword">is</span> gui_medium_button</span><br><span class="line">style confirm_button_text <span class="keyword">is</span> gui_medium_button_text</span><br><span class="line"></span><br><span class="line">style confirm_frame:</span><br><span class="line">    background Frame([ <span class="string">&quot;gui/confirm_frame.png&quot;</span>, <span class="string">&quot;gui/frame.png&quot;</span>], gui.confirm_frame_borders, tile=gui.frame_tile)</span><br><span class="line">    padding gui.confirm_frame_borders.padding</span><br><span class="line">    xalign <span class="number">.5</span></span><br><span class="line">    yalign <span class="number">.5</span></span><br><span class="line"></span><br><span class="line">style confirm_prompt_text:</span><br><span class="line">    textalign <span class="number">0.5</span></span><br><span class="line">    layout <span class="string">&quot;subtitle&quot;</span></span><br><span class="line"></span><br><span class="line">style confirm_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;confirm_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style confirm_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;confirm_button&quot;</span>)</span><br></pre></td></tr></table></figure><br>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">on <span class="string">&quot;show&quot;</span> action MouseMove(<span class="number">850</span>,<span class="number">570</span>)</span><br></pre></td></tr></table></figure></p><div class="note info modern"><p>这里添加的是没有自定义的参数，可以等自定义确认界面后再做修改</p></div><h2 id="已读文本变色"><a href="#已读文本变色" class="headerlink" title="已读文本变色"></a>已读文本变色</h2><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;已读文本变色&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 允许已读文本变色</span></span><br><span class="line">        <span class="keyword">if</span> text_color_changeable==<span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_color_changeable&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_color_changeable&quot;</span>, <span class="literal">False</span>)</span><br><span class="line">        <span class="comment">## 禁止已读文本变色</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_color_changeable&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;text_color_changeable&quot;</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure></p><p>自定义变量<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 已读文本变色</span></span><br><span class="line">default text_color_changeable=<span class="literal">True</span></span><br></pre></td></tr></table></figure></p><p><code>say</code>界面修改为如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 已读文本变色</span></span><br><span class="line"><span class="keyword">if</span> text_color_changeable==<span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 已被查看(不包括当前文本)</span></span><br><span class="line">    <span class="keyword">if</span> renpy.is_seen(ever = <span class="literal">True</span>):</span><br><span class="line">        text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color  <span class="string">&quot;#FFFF00&quot;</span></span><br><span class="line">    <span class="comment">## 未被查看</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 不允许已读文本变色</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span> color <span class="string">&quot;#fff&quot;</span></span><br></pre></td></tr></table></figure></p><h2 id="已选选项变色"><a href="#已选选项变色" class="headerlink" title="已选选项变色"></a>已选选项变色</h2><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;已选选项变色&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 允许已选选项变色</span></span><br><span class="line">        <span class="keyword">if</span> choice_color_changeable==<span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;choice_color_changeable&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;choice_color_changeable&quot;</span>, <span class="literal">False</span>)</span><br><span class="line">        <span class="comment">## 禁止已选选项变色</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;choice_color_changeable&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;choice_color_changeable&quot;</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure></p><p>自定义变量<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 已选选项变色</span></span><br><span class="line">default choice_color_changeable=<span class="literal">True</span></span><br></pre></td></tr></table></figure></p><p>来到<code>screens.rpy</code>文件第195行，你会看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 选择屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 此屏幕用于显示由 menu 语句生成的游戏内选项。参数 items 是一个对象列表，每个对</span></span><br><span class="line"><span class="comment">## 象都有字幕和动作字段。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://doc.renpy.cn/zh-CN/screen_special.html#choice</span></span><br><span class="line"></span><br><span class="line">screen choice(items):</span><br><span class="line">    style_prefix <span class="string">&quot;choice&quot;</span></span><br><span class="line"></span><br><span class="line">    vbox:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> items:</span><br><span class="line">            textbutton i.caption action i.action</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style choice_vbox <span class="keyword">is</span> vbox</span><br><span class="line">style choice_button <span class="keyword">is</span> button</span><br><span class="line">style choice_button_text <span class="keyword">is</span> button_text</span><br><span class="line"></span><br><span class="line">style choice_vbox:</span><br><span class="line">    xalign <span class="number">0.5</span></span><br><span class="line">    ypos <span class="number">405</span></span><br><span class="line">    yanchor <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">    spacing gui.choice_spacing</span><br><span class="line"></span><br><span class="line">style choice_button <span class="keyword">is</span> default:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;choice_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style choice_button_text <span class="keyword">is</span> default:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;choice_button&quot;</span>)</span><br></pre></td></tr></table></figure><br>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> items:</span><br><span class="line">        <span class="comment">## 允许已选选项变色</span></span><br><span class="line">        <span class="keyword">if</span> choice_color_changeable==<span class="literal">True</span>:</span><br><span class="line">            <span class="comment">## 已选选项</span></span><br><span class="line">            <span class="keyword">if</span> i.chosen:</span><br><span class="line">                textbutton i.caption:</span><br><span class="line">                    text_color <span class="string">&quot;#FFFF00&quot;</span></span><br><span class="line">                    action i.action</span><br><span class="line">            <span class="comment">## 未选选项</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton i.caption:</span><br><span class="line">                    text_color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                    action i.action</span><br><span class="line">        <span class="comment">## 禁止已选选项变色</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            textbutton i.caption:</span><br><span class="line">                text_color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                action i.action</span><br></pre></td></tr></table></figure></p><h2 id="侧边栏存档读档"><a href="#侧边栏存档读档" class="headerlink" title="侧边栏存档读档"></a>侧边栏存档读档</h2><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">vbox:</span><br><span class="line">    spacing <span class="number">10</span></span><br><span class="line">    xpos <span class="number">750</span></span><br><span class="line">    ypos <span class="number">207</span></span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">10</span></span><br><span class="line">        add <span class="string">&quot;label.png&quot;</span></span><br><span class="line">        text <span class="string">&quot;侧边存档读档栏显示&quot;</span> color <span class="string">&quot;#4e021f&quot;</span> </span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span> </span><br><span class="line">        <span class="comment">## 允许侧边栏存档读档显示</span></span><br><span class="line">        <span class="keyword">if</span> side_save_load==<span class="literal">True</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;side_save_load&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_off.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;side_save_load&quot;</span>, <span class="literal">False</span>)</span><br><span class="line">        <span class="comment">## 禁止侧边栏存档读档显示</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;hover_on.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;on.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;side_save_load&quot;</span>, <span class="literal">True</span>) </span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;off.png&quot;</span></span><br><span class="line">                action SetVariable(<span class="string">&quot;side_save_load&quot;</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><br>自定义变量<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 侧边栏存档读档</span></span><br><span class="line">default side_save =<span class="literal">True</span></span><br><span class="line">default side_load =<span class="literal">False</span></span><br><span class="line">default side_save_load=<span class="literal">True</span></span><br></pre></td></tr></table></figure></p><p>新建界面<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 鼠标位于侧边栏显示侧边栏存档</span></span><br><span class="line">init python:</span><br><span class="line">    config.overlay_screens.append(<span class="string">&quot;mini_save_show_area&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 鼠标位置判定</span></span><br><span class="line">screen mini_save_show_area():</span><br><span class="line">    zorder <span class="number">250</span></span><br><span class="line"></span><br><span class="line">    mousearea:</span><br><span class="line">        area (<span class="number">1820</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">1080</span>)</span><br><span class="line">        hovered Show(<span class="string">&quot;mini_save_load&quot;</span>)</span><br><span class="line">        unhovered Hide(<span class="string">&quot;mini_save_load&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 侧边栏存档读档</span></span><br><span class="line">screen mini_save_load():</span><br><span class="line">    </span><br><span class="line">    zorder <span class="number">200</span></span><br><span class="line">    <span class="keyword">if</span> side_save_load==<span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> side_save ==<span class="literal">True</span>:</span><br><span class="line">            vbox:</span><br><span class="line">                xalign <span class="number">1.0</span></span><br><span class="line">                xoffset <span class="number">420</span></span><br><span class="line">                <span class="comment">## 切换存档读档</span></span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;load.png&quot;</span></span><br><span class="line">                    xoffset -<span class="number">50</span></span><br><span class="line">                    hover <span class="string">&quot;load_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;side_load&quot;</span>, <span class="literal">True</span>),SetVariable(<span class="string">&quot;side_save&quot;</span>, <span class="literal">False</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;up.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;up_hover.png&quot;</span></span><br><span class="line">                    action FilePagePrevious(<span class="built_in">max</span>=<span class="number">9</span>,wrap=<span class="literal">True</span>,auto=<span class="literal">False</span>,quick=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 存档槽总数</span></span><br><span class="line">                grid <span class="number">1</span> gui.file_slot_cols*gui.file_slot_rows*<span class="number">9</span>:</span><br><span class="line">                    style_prefix <span class="string">&quot;slot&quot;</span></span><br><span class="line">                    spacing -<span class="number">150</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">                        $ slot = i + <span class="number">1</span></span><br><span class="line">                        </span><br><span class="line">                        button:</span><br><span class="line">                            </span><br><span class="line">                            action FileSave(slot)</span><br><span class="line">                            <span class="comment">#存档按钮背景图</span></span><br><span class="line">                            background <span class="string">&quot;mini_bg.png&quot;</span> </span><br><span class="line">                            <span class="comment">#存档按钮悬停图</span></span><br><span class="line">                            hover_background <span class="string">&quot;mini_bg_hover.png&quot;</span> </span><br><span class="line">                            <span class="comment">#存档编号</span></span><br><span class="line">                            text FileSlotName(slot, gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">                                size <span class="number">30</span></span><br><span class="line">                            tooltip [FileSaveName(slot)]</span><br><span class="line">                            hovered [SetVariable(<span class="string">&quot;ToolTipSlot&quot;</span>, <span class="built_in">int</span>(FileSlotName(slot, gui.file_slot_cols * gui.file_slot_rows)))]</span><br><span class="line">                            unhovered [SetVariable(<span class="string">&quot;ToolTipSlot&quot;</span>, <span class="literal">None</span>)]</span><br><span class="line"></span><br><span class="line">            imagebutton:</span><br><span class="line">                align (<span class="number">1.0</span>,<span class="number">0.8</span>)</span><br><span class="line">                yoffset -<span class="number">15</span></span><br><span class="line">                xoffset -<span class="number">5</span></span><br><span class="line">                idle <span class="string">&quot;down.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;down_hover.png&quot;</span></span><br><span class="line">                action FilePageNext(<span class="built_in">max</span>=<span class="number">9</span>,wrap=<span class="literal">True</span>,auto=<span class="literal">False</span>,quick=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> side_load ==<span class="literal">True</span>:</span><br><span class="line">            vbox:</span><br><span class="line">                xalign <span class="number">1.0</span></span><br><span class="line">                xoffset <span class="number">420</span></span><br><span class="line">                imagebutton:</span><br><span class="line">                    xoffset -<span class="number">50</span></span><br><span class="line">                    idle <span class="string">&quot;save.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;save_hover.png&quot;</span></span><br><span class="line">                    action [SetVariable(<span class="string">&quot;side_load&quot;</span>, <span class="literal">False</span>),SetVariable(<span class="string">&quot;side_save&quot;</span>, <span class="literal">True</span>)]</span><br><span class="line">                imagebutton:</span><br><span class="line">                    idle <span class="string">&quot;up.png&quot;</span></span><br><span class="line">                    hover <span class="string">&quot;up_hover.png&quot;</span></span><br><span class="line">                    action FilePagePrevious(<span class="built_in">max</span>=<span class="number">9</span>,wrap=<span class="literal">True</span>,auto=<span class="literal">False</span>,quick=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 存档槽总数</span></span><br><span class="line">                grid <span class="number">1</span> gui.file_slot_cols*gui.file_slot_rows*<span class="number">9</span>:</span><br><span class="line">                    style_prefix <span class="string">&quot;slot&quot;</span></span><br><span class="line">                    spacing -<span class="number">150</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">                        $ slot = i + <span class="number">1</span></span><br><span class="line">                        </span><br><span class="line">                        button:</span><br><span class="line">                            </span><br><span class="line">                            action FileLoad(slot)</span><br><span class="line">                            <span class="comment">#存档按钮背景图</span></span><br><span class="line">                            background <span class="string">&quot;mini_bg.png&quot;</span> </span><br><span class="line">                            <span class="comment">#存档按钮悬停图</span></span><br><span class="line">                            hover_background <span class="string">&quot;mini_bg_hover.png&quot;</span> </span><br><span class="line">                            <span class="comment">#存档编号</span></span><br><span class="line">                            text FileSlotName(slot, gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">                                size <span class="number">30</span></span><br><span class="line">                            tooltip [FileSaveName(slot)]</span><br><span class="line">                            hovered [SetVariable(<span class="string">&quot;ToolTipSlot&quot;</span>, <span class="built_in">int</span>(FileSlotName(slot, gui.file_slot_cols * gui.file_slot_rows)))]</span><br><span class="line">                            unhovered [SetVariable(<span class="string">&quot;ToolTipSlot&quot;</span>, <span class="literal">None</span>)]</span><br><span class="line"></span><br><span class="line">            imagebutton:</span><br><span class="line">                align (<span class="number">1.0</span>,<span class="number">0.8</span>)</span><br><span class="line">                yoffset -<span class="number">15</span></span><br><span class="line">                xoffset -<span class="number">5</span></span><br><span class="line">                idle <span class="string">&quot;down.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;down_hover.png&quot;</span></span><br><span class="line">                action FilePageNext(<span class="built_in">max</span>=<span class="number">9</span>,wrap=<span class="literal">True</span>,auto=<span class="literal">False</span>,quick=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    $ tooltip = GetTooltip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> tooltip:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">            $ slot = i + <span class="number">1</span></span><br><span class="line">            frame:</span><br><span class="line">                xpos <span class="number">1300</span></span><br><span class="line">                background <span class="string">&quot;gui/button/slot_hover_background.png&quot;</span> at tip</span><br><span class="line">                </span><br><span class="line">                add renpy.slot_screenshot(<span class="string">f&quot;<span class="subst">&#123;<span class="number">1</span> + <span class="built_in">int</span>((ToolTipSlot-<span class="number">1</span>) / <span class="number">9</span>)&#125;</span>-<span class="subst">&#123;<span class="number">1</span> + (<span class="built_in">int</span>(ToolTipSlot-<span class="number">1</span>) % <span class="number">9</span>)&#125;</span>&quot;</span>) xysize(<span class="number">231</span>,<span class="number">130</span>) xoffset <span class="number">6</span> yoffset <span class="number">72</span></span><br><span class="line">                frame:</span><br><span class="line">                    background <span class="literal">None</span></span><br><span class="line">                    xysize(<span class="number">210</span>,<span class="number">110</span>)</span><br><span class="line">                    xoffset <span class="number">240</span></span><br><span class="line">                    yoffset <span class="number">65</span></span><br><span class="line">                    text tooltip at tip size <span class="number">25</span> color <span class="string">&quot;#fff&quot;</span> outlines [(<span class="number">2</span>,<span class="string">&quot;#000000&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)] </span><br></pre></td></tr></table></figure><br><div class="note warning simple"><p>这里的悬停提示可能会与底部菜单的悬停提示有所冲突，可修改为如下代码</p></div></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> tooltip <span class="keyword">and</span> side_save_load ==<span class="literal">False</span>:</span><br><span class="line">    frame:</span><br><span class="line">        background <span class="literal">None</span></span><br><span class="line">        yalign <span class="number">1.0</span></span><br><span class="line">        xoffset <span class="number">580</span></span><br><span class="line">        yoffset -<span class="number">7</span></span><br><span class="line">        text <span class="string">&quot;[tooltip]&quot;</span>:</span><br><span class="line">            size <span class="number">30</span></span><br><span class="line">            color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">            outlines [(<span class="number">2</span>,<span class="string">&quot;#35ceff&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)]</span><br><span class="line">            at tip</span><br></pre></td></tr></table></figure><h1 id="必要部分"><a href="#必要部分" class="headerlink" title="必要部分"></a>必要部分</h1><p>添加返回按钮，返回标题菜单和结束游戏按钮<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hbox:</span><br><span class="line">    align (1.0,1.0)</span><br><span class="line">    xoffset -50</span><br><span class="line">    yoffset -50</span><br><span class="line">    spacing 20</span><br><span class="line">    if not main_menu:</span><br><span class="line">        imagebutton:</span><br><span class="line">            idle &quot;return_title.png&quot;</span><br><span class="line">            hover &quot;return_title_hover.png&quot;</span><br><span class="line">            action MainMenu()</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle &quot;end_game.png&quot;</span><br><span class="line">        hover &quot;end_game_hover.png&quot;</span><br><span class="line">        action Quit()</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle &quot;return_game.png&quot;</span><br><span class="line">        hover &quot;return_game_hover.png&quot;</span><br><span class="line">        action Return()</span><br></pre></td></tr></table></figure></p><h1 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h1><p>新建一个<code>rpy</code>文件，用于存放自定义变量</p><div class="note info simple"><p>新建<code>txt</code>文本文档，直接修改文件后缀即可</p></div>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中系统设置界面的一些修改，包括已读文本变色，侧边栏存档读档等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行(三)</title>
    <link href="http://lucylcarus.github.io/posts/d5a6d90f.html"/>
    <id>http://lucylcarus.github.io/posts/d5a6d90f.html</id>
    <published>2024-11-16T09:09:23.000Z</published>
    <updated>2024-12-04T04:55:03.501Z</updated>
    
    <content type="html"><![CDATA[<h1 id="管道符、重定向与环境变量"><a href="#管道符、重定向与环境变量" class="headerlink" title="管道符、重定向与环境变量"></a>管道符、重定向与环境变量</h1><h2 id="输入输出重定向"><a href="#输入输出重定向" class="headerlink" title="输入输出重定向"></a>输入输出重定向</h2><p>输入重定向是指把文件导入到命令中，输出重定向是指把原本要输出到屏幕的数据信息写入到指定文件中<br>相比于输入重定向，输出重定向使用频率要更高，所以进一步划分为标准输出重定向和错误输出重定向，以及覆盖写和追加写两种写入方式</p><ol><li>标准输入重定向(STDIN，文件描述为0):<br>默认从键盘输入，也可以从其他文件或命令中输入</li><li>标准输出重定向(STDOUT，文件描述为1):<br>默认输出到屏幕</li><li>错误输出重定向(STDERR，文件描述为2):<br>默认输出到屏幕</li></ol><p>输入重定向中用到的符号及其作用如下表所示</p><div class="table-container"><table><thead><tr><th>符号</th><th>作用</th></tr></thead><tbody><tr><td>命令 &lt; 文件</td><td>将文件作为命令的标准输入</td></tr><tr><td>命令 &lt;&lt; 文件</td><td>从标准输入中读入，直到遇见分界符才停止</td></tr><tr><td>命令 &lt; 文件1 &gt; 文件2</td><td>将文件1作为命令的标准输入并将标准输出到文件2</td></tr></tbody></table></div><p>输出重定向中用到的符号及其作用</p><div class="table-container"><table><thead><tr><th>符号</th><th>作用</th></tr></thead><tbody><tr><td>命令 &gt; 文件</td><td>将标准输出重定向到一个文件中(清空原有文件的数据)</td></tr><tr><td>命令 2&gt; 文件</td><td>将错误输出重定向到一个文件中(清空原有文件的数据)</td></tr><tr><td>命令 &gt;&gt; 文件</td><td>将标准输出重定向到一个文件中(追加到原有内容的后面)</td></tr><tr><td>命令 2&gt;&gt; 文件</td><td>将错误输出重定向到一个文件中(追加到原有内容的后面)</td></tr><tr><td>命令 &gt;&gt; 文件2&gt;&amp;1 或 命令 &amp;&gt;&gt; 文件</td><td>将标准输出与错误输出共同写入到文件中(追加到原有内容的后面)</td></tr></tbody></table></div><blockquote><p>例：<br>通过标准重定向将<code>man bash</code>命令原本要输出到屏幕的信息写入到文件<code>readme.txt</code>中<br>man bash &gt; readme.txt</p></blockquote><h1 id="管道命令符"><a href="#管道命令符" class="headerlink" title="管道命令符"></a>管道命令符</h1><p>把前一个命令原本要输出到屏幕的信息当作后一个命令的标准输入</p><blockquote><p>例：<br>统计被限制登录的用户<br>grep /sbin/nologin /etc/passwd | wc -l</p></blockquote><div class="note info modern"><p>可使用多次管道命令符，如<code>命令A | 命令B | 命令C</code></p></div><h1 id="命令行的通配符"><a href="#命令行的通配符" class="headerlink" title="命令行的通配符"></a>命令行的通配符</h1><p>通配符就是通用匹配信息的符号，比如</p><ol><li>星号<code>*</code>代表匹配0个或多个字符</li><li>问号<code>?</code>代表匹配单个字符</li></ol><p>更多通配符如下表所示</p><div class="table-container"><table><thead><tr><th>通配符</th><th>含义</th></tr></thead><tbody><tr><td>[a-z]</td><td>单个小写字母</td></tr><tr><td>[A-Z]</td><td>单个大写字母</td></tr><tr><td>[a-Z]</td><td>单个字母</td></tr><tr><td>[0-9]</td><td>单个数字</td></tr><tr><td>[[:alpha:]]</td><td>任意字母</td></tr><tr><td>[[:upper:]]</td><td>任意大写字母</td></tr><tr><td>[[:lower:]]</td><td>任意小写字母</td></tr><tr><td>[[:digit:]]</td><td>所以数字</td></tr><tr><td>[[:alnum:]]</td><td>任意字母加数字</td></tr><tr><td>[[:punct:]]</td><td>标点符号</td></tr></tbody></table></div><h1 id="常用转义字符"><a href="#常用转义字符" class="headerlink" title="常用转义字符"></a>常用转义字符</h1><p>四个最常用转义字符</p><ol><li>反斜杠 \</li><li>单引号 ‘’</li><li>双引号 “”</li><li>反引号 ``</li></ol><blockquote><p>例：<br>衬衫的价格是九磅十五便士<br>echo “Price is \￡9.15”</p></blockquote><h1 id="重要的环境变量"><a href="#重要的环境变量" class="headerlink" title="重要的环境变量"></a>重要的环境变量</h1><p>在Linux系统中，变量名称一般都是大写的，命令都是小写的<br>Linux中最重要的环境变量如下表所示</p><div class="table-container"><table><thead><tr><th>环境变量</th><th>作用</th></tr></thead><tbody><tr><td>HOME</td><td>用户的主目录(家目录)</td></tr><tr><td>SHELL</td><td>用户在使用的Shell解释器名称</td></tr><tr><td>HISTSIZE</td><td>输出的历史命令记录条数</td></tr><tr><td>HISTFILESIZE</td><td>保存的历史命令记录条数</td></tr><tr><td>MAIL</td><td>邮件保存路径</td></tr><tr><td>LANG</td><td>系统语言、语系名称</td></tr><tr><td>RANDOM</td><td>生成一个随机数字</td></tr><tr><td>PS1</td><td>Bash解释器的提示符</td></tr><tr><td>PATH</td><td>定义解释器搜索用户执行命令的路径</td></tr><tr><td>EDITOR</td><td>用户默认的文本编辑器</td></tr></tbody></table></div><h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><p>正则表达式，又称正规表示式、正规表示法、正规表达式、规则表达式、常规表示法（英语：Regular Expression，在代码中常简写为 regex、regexp 或 RE），计算机科学的一个概念。正则表达式使用单个字符串来描述、匹配一系列符合某个句法规则的字符串。在很多文本编辑器里，正则表达式通常被用来检索、替换那些符合某个模式的文本。</p><div class="table-container"><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>\</td><td>将下一个字符标记为一个特殊字符、或一个原义字符<br>例如，“n”匹配字符“n”。“\n”匹配一个换行符。序列“\”匹配“\”而“(”则匹配“(”</td></tr><tr><td>^</td><td>匹配输入字符串的开始位置</td></tr><tr><td>$</td><td>匹配输入字符串的结束位置</td></tr><tr><td>{n}</td><td>n 是一个非负整数。匹配确定的 n 次<br>例如，“o{2}”不能匹配“Bob”中的“o”，但是能匹配“food”中的两个 o</td></tr><tr><td>{n,}</td><td>n 是一个非负整数。至少匹配 n 次<br>例如，“o{2,}”不能匹配“Bob”中的“o”，但能匹配“foooood”中的所有 o。“o{1,}”等价于“o+”。“o{0,}”则等价于“o*”</td></tr><tr><td>{n,m}</td><td>m 和 n 均为非负整数，其中 n&lt;=m。最少匹配 n 次且最多匹配 m 次<br>例如，“o{1,3}”将匹配“fooooood”中的前三个 o。“o{0,1}”等价于“o?”。请注意在逗号和两个数之间不能有空格</td></tr><tr><td>*</td><td>匹配前面的子表达式零次或多次<br>例如，zo*能匹配“z”、“zo”以及“zoo”。*等价于{0,}</td></tr><tr><td>+</td><td>匹配前面的子表达式一次或多次<br>例如，“zo+”能匹配“zo”以及“zoo”，但不能匹配“z”。+等价于{1,}</td></tr><tr><td>?</td><td>匹配前面的子表达式零次或一次<br>例如，“do(es)?”可以匹配“do”或“does”中的“do”。?等价于{0,1}</td></tr><tr><td>?</td><td>当该字符紧跟在任何一个其他限制符（*,+,?，{n}，{n,}，{n,m}）后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串<br>例如，对于字符串“oooo”，“o+?”将匹配单个“o”，而“o+”将匹配所有“o”</td></tr><tr><td>.</td><td>匹配除“\n”之外的任何单个字符。要匹配包括“\n”在内的任何字符，请使用像“(.｜\n)”的模式</td></tr><tr><td>(pattern)</td><td>匹配 pattern 并获取这一匹配的子字符串。该子字符串用于向后引用。要匹配圆括号字符，请使用 “(”，右括号同样</td></tr><tr><td>x ｜ y</td><td>匹配 x 或 y<br>例如，“z ｜ food” 能匹配 “z” 或 “food”。“(z ｜ f)ood”则匹配“zood”或“food”</td></tr><tr><td>[xyz]</td><td>字符集合（character class）。匹配所包含的任意一个字符<br>例如，“[abc]”可以匹配“plain”中的“a”。其中特殊字符仅有反斜线\保持特殊含义，用于转义字符。其它特殊字符如星号、加号、各种括号等均作为普通字符。脱字符^如果出现在首位则表示负值字符集合；如果出现在字符串中间就仅作为普通字符。连字符 - 如果出现在字符串中间表示字符范围描述；如果出现在首位则仅作为普通字符</td></tr><tr><td>[^xyz]</td><td>排除型（negate）字符集合。匹配未列出的任意字符<br>例如，“[^abc]”可以匹配“plain”中的“plin”</td></tr><tr><td>[a-z]</td><td>字符范围。匹配指定范围内的任意字符<br>例如，“[a-z]”可以匹配“a”到“z”范围内的任意小写字母字符</td></tr><tr><td>[^a-z]</td><td>排除型的字符范围。匹配任何不在指定范围内的任意字符<br>例如，“[^a-z]”可以匹配任何不在“a”到“z”范围内的任意字符</td></tr></tbody></table></div>]]></content>
    
    
    <summary type="html">Linux不仅系统性能稳定，而且是开源软件。其核心防火墙组件性能高效、配置简单，保证了系统的安全。在很多企业网络中，为了追求速度和安全，Linux不仅仅是被网络运维人员当作服务器使用，甚至当作网络防火墙，这是Linux的一大亮点。</summary>
    
    
    
    <category term="操作系统" scheme="http://lucylcarus.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="http://lucylcarus.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>MySQL语法使用(四)</title>
    <link href="http://lucylcarus.github.io/posts/b3623411.html"/>
    <id>http://lucylcarus.github.io/posts/b3623411.html</id>
    <published>2024-11-12T07:42:09.000Z</published>
    <updated>2024-12-06T12:31:44.929Z</updated>
    
    <content type="html"><![CDATA[<h1 id="多关系数据查询"><a href="#多关系数据查询" class="headerlink" title="多关系数据查询"></a>多关系数据查询</h1><h2 id="多关系查询结构"><a href="#多关系查询结构" class="headerlink" title="多关系查询结构"></a>多关系查询结构</h2><p>表的连接方法有以下两种</p><ol><li>表之间满足一定条件的进行连接时，<code>FROM</code>子句指明进行连接的表名，<code>WHERE</code>子句指明连接的列名及其连接条件。语法格式为<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>] [TOP N [<span class="keyword">PERCENT</span>] [<span class="keyword">WITH</span> TIES]] <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">AS</span> 别名<span class="number">1</span>] [&#123;,<span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">AS</span> 别名<span class="number">2</span>]&#125;]</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="number">1</span><span class="operator">&gt;</span> [[<span class="keyword">AS</span>] 表<span class="number">1</span>别名] [&#123;,<span class="operator">&lt;</span>表名<span class="number">2</span><span class="operator">&gt;</span> [[<span class="keyword">AS</span>] 表<span class="number">2</span>别名,……]&#125;]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>检索条件<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> [<span class="keyword">HAVING</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>]]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]];  </span><br></pre></td></tr></table></figure></li><li>利用关键字<code>JOIN</code>进行连接，格式语法如下<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>] [TOP N [<span class="keyword">PERCENT</span>] [<span class="keyword">WITH</span> TIES]] 字段名<span class="number">1</span> [<span class="keyword">AS</span> 别名<span class="number">1</span>] [,字段名<span class="number">2</span> [<span class="keyword">AS</span> 别名<span class="number">2</span>]……]</span><br><span class="line"><span class="keyword">FROM</span> 表名<span class="number">1</span> [[<span class="keyword">AS</span>] 表<span class="number">1</span>别名] [<span class="keyword">INNER</span><span class="operator">|</span>[<span class="keyword">LEFT</span><span class="operator">|</span><span class="keyword">RIGHT</span><span class="operator">|</span><span class="keyword">FULL</span><span class="operator">|</span>[<span class="keyword">OUTER</span>]]<span class="operator">|</span><span class="keyword">CROSS</span>] <span class="keyword">JOIN</span> 表名<span class="number">2</span> [[<span class="keyword">AS</span>] 表<span class="number">2</span>别名]</span><br><span class="line"><span class="keyword">ON</span> 条件;  </span><br></pre></td></tr></table></figure>相关说明如下<blockquote><p><code>LNNER JOIN</code>成为内连接，用于显示符合条件的记录，此为默认值<br><code>LEFT[OUTER] JOIN</code>称为左连接(外连接)，用于显示符合条件的记录以及左边表中不符合条件的记录(此时右边表记录会以<code>NIULL</code>来显示)<br><code>RIGHT[OUTER] JOIN</code>称为右连接(外连接)，用于显示符合条件的记录以及右边表中不符合条件的记录(此时左边表记录会以<code>NIULL</code>来显示)<br><code>FULL[OUTER] JOIN</code>称为全连接(外连接)，用于显示符合条件的记录以及左边表和右边表中不符合条件的记录(此时缺乏的数据会以<code>NIULL</code>来显示)。目前MYSQL暂不支持全外连接，但可以通过左外连接和右外连接联合实现<br><code>CROSS JOIN</code>称为交叉连接，用于将一个表的记录和另一个表的每个记录匹配成新的记录<br>当将<code>JOIN</code>关键字放于<code>FROM</code>子句中时，应有关键词<code>ON</code>与之对应，以表名连接的条件</p></blockquote></li></ol><h2 id="内连接查询"><a href="#内连接查询" class="headerlink" title="内连接查询"></a>内连接查询</h2><p>实例讲解，现有s和sc两个表，s表中包含学生基本信息(学号(sno)，姓名(sname)，性别(sex)，年龄(age)，专业(major)……)，sc表中包含学生各科成绩(学号(sno)，姓名(sname)，数学(math)，语文(chinese)……)，现要查询学号为<code>114514</code>的学生的学号，姓名，性别，年龄，数学成绩，语文成绩</p><ol><li><p>方法一</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.sno,s.sname,sex,age,math,chinese</span><br><span class="line"><span class="keyword">FROM</span> s,sc</span><br><span class="line"><span class="keyword">WHERE</span> s.sno<span class="operator">=</span>&quot;114514&quot; <span class="keyword">AND</span> s.sno<span class="operator">=</span>sc.sno</span><br></pre></td></tr></table></figure></li><li><p>方法二</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.sno,s.sname,sex,age,math,chinese</span><br><span class="line"><span class="keyword">FROM</span> s <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sc</span><br><span class="line"><span class="keyword">ON</span> s.sno<span class="operator">=</span>&quot;114514&quot; <span class="keyword">AND</span> s.sno<span class="operator">=</span>sc.sno;</span><br></pre></td></tr></table></figure></li></ol><div class="note info modern"><p>上述语句的学号<code>sno</code>和姓名<code>sname</code>需要加上表名作为前缀(因为两个表中都有，如果不加，学号和姓名会出现两次)，其他字段名由于只出现一次，可以不用添加前缀,<code>s.sno=sc.sno</code>则是将s表中的sno和sc表中的sno进行等值连接</p></div><h2 id="外连接查询"><a href="#外连接查询" class="headerlink" title="外连接查询"></a>外连接查询</h2><p>在内连接查询中，不满足连接条件的元组不能作为查询结果输出，而在外连接查询中，参与连接的表有主从之分，以主表的每行数据去匹配从表的数据列，符合连接条件的数据将直接返回到结果中，对于那些不符合连接条件的列，被填上<code>NULL</code>值后，在返回到结果中<br>外连接查询分为左外连接查询和右外连接查询两种，以主表所在的方向区分外连接查询，主表在左边，则称为左外连接查询，主表在右边，则称其为右外连接查询</p><blockquote><p>例:<br>查询所有学生的学号，姓名，性别，年龄，数学成绩，语文成绩，并按学号排序<br>SELECT s.sno,s.sname,sex,age,math,chinese<br>FROM s LEFT OUTER JOIN sc ON  s.sno=sc.sno<br>ORDER BY sno;</p></blockquote><h2 id="交叉连接查询"><a href="#交叉连接查询" class="headerlink" title="交叉连接查询"></a>交叉连接查询</h2><p>交叉连接查询为连接查询没有特殊的要求，任何表都可以进行交叉查询操作</p><blockquote><p>例:<br>对s表和sc表进行交叉查询<br>SELECT *<br>FROM s CROSS JOIN sc;</p></blockquote><h2 id="自连接查询"><a href="#自连接查询" class="headerlink" title="自连接查询"></a>自连接查询</h2><p>当一个表与其自身进行连接查询操作时，称为表的自连接查询<br>比如，查询学号比<code>114514</code>大的学生的学号，姓名，性别</p><ol><li>方法一<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> x.sno <span class="keyword">AS</span> 学号, x.sname <span class="keyword">AS</span> 姓名,x.sex <span class="keyword">AS</span> 性别</span><br><span class="line"><span class="keyword">FROM</span> s <span class="keyword">AS</span> x,s <span class="keyword">AS</span> y</span><br><span class="line"><span class="keyword">WHERE</span> x.sno<span class="operator">&gt;</span>y.sno <span class="keyword">AND</span> y.sno<span class="operator">=</span>&quot;114514&quot;;</span><br></pre></td></tr></table></figure></li><li>方法二<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> x.sno <span class="keyword">AS</span> 学号, x.sname <span class="keyword">AS</span> 姓名,x.sex <span class="keyword">AS</span> 性别</span><br><span class="line"><span class="keyword">FROM</span> s <span class="keyword">AS</span> x <span class="keyword">INNER</span> <span class="keyword">JOIN</span> s <span class="keyword">AS</span> y</span><br><span class="line"><span class="keyword">On</span> x.sno<span class="operator">&gt;</span>y.sno <span class="keyword">AND</span> y.sno<span class="operator">=</span>&quot;114514&quot;;</span><br></pre></td></tr></table></figure><h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><h2 id="普通子查询"><a href="#普通子查询" class="headerlink" title="普通子查询"></a>普通子查询</h2>普通子查询的执行顺序：首先执行子查询，然后把子查询的结果带入父查询的查询条件中，普通子查询只执行一次，而父查询所涉及的所有记录行都与其查询结果进行比较以确保查询结果集合<h3 id="返回一个值的普通子查询"><a href="#返回一个值的普通子查询" class="headerlink" title="返回一个值的普通子查询"></a>返回一个值的普通子查询</h3>当子查询的返回值只有一个时，可以使用比较运算符将父查询和子查询连接起来<br>比如，查询比张三年龄大的学生的学号，姓名，年龄<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sno,sname,age</span><br><span class="line"><span class="keyword">FROM</span> s</span><br><span class="line"><span class="keyword">WHERE</span> age<span class="operator">&gt;</span>(<span class="keyword">SELECT</span> age</span><br><span class="line">           <span class="keyword">FROM</span> s</span><br><span class="line">           <span class="keyword">WHERE</span> sname<span class="operator">=</span>&quot;张三&quot;)</span><br></pre></td></tr></table></figure><h3 id="返回一组值的普通子查询"><a href="#返回一组值的普通子查询" class="headerlink" title="返回一组值的普通子查询"></a>返回一组值的普通子查询</h3>如果子查询的返回值不止一个，而是一个集合，则不能直接使用比较运算符，可以在比较运算符和子查询之间插入<code>ANY</code>和<code>ALL</code>，其中等值关系可以用<code>IN</code>，不等值关系则可使用<code>NOT IN</code><div class="note info modern"><p><code>ANY</code>可以与<code>=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;</code>结合起来使⽤，分别表示等于、⼤于、⼤于等于、⼩于、⼩于等于、不等于其中的任何⼀个数据。也就是说只要有任意一个满足就是true，并且显示满足条件的数据。<br><code>ALL</code>可以与<code>=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;</code>结合是来使⽤，分别表示等于、⼤于、⼤于等于、 ⼩于、⼩于等于、不等于其中的所有数据。当所有数据都满足才是true，会返回满足所有条件的数据。</p></div>现添加c表和stuc表，c表中包含课程基本信息(课程号(cno)，课程名(cname)，任教教师(cteacher)，课时(ctime)……)，stuc表中包含学生选课基本信息(学号(sno)，姓名(sname)，课程号(cno)，课程名(cname)……)，现要查询姓名为张三的学生所选课程的课程号，课程名，任教教师<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cno,cname,cteacher</span><br><span class="line"><span class="keyword">FROM</span> c</span><br><span class="line"><span class="keyword">WHERE</span> cno<span class="operator">=</span><span class="keyword">ANY</span>(<span class="keyword">SELECT</span> cno</span><br><span class="line">              <span class="keyword">FROM</span> stuc</span><br><span class="line">              <span class="keyword">WHERE</span> sname<span class="operator">=</span>&quot;张三&quot;)</span><br></pre></td></tr></table></figure><h3 id="用于数据操纵的普通查询"><a href="#用于数据操纵的普通查询" class="headerlink" title="用于数据操纵的普通查询"></a>用于数据操纵的普通查询</h3>比如，将sc表中数学平均成绩进行赋分(平均成绩*80%+20)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> sc</span><br><span class="line"><span class="keyword">SET</span> math<span class="operator">=</span>(<span class="keyword">SELECT</span> <span class="number">0.8</span><span class="operator">*</span><span class="built_in">AVG</span>(math)<span class="operator">+</span><span class="number">20</span></span><br><span class="line">          <span class="keyword">FROM</span> sc); </span><br></pre></td></tr></table></figure></li></ol><h2 id="相关子查询"><a href="#相关子查询" class="headerlink" title="相关子查询"></a>相关子查询</h2><p>在某些查询任务中，子查询的查询条件需要引用父查询表中的属性值，这类查询成为相关子查询</p><p>相关子查询的查询顺序：首先，选取父查询表中的第一行记录，子查询利用此行中相关的属性值在子查询涉及的基本表中进行查询，然后，父查询根据子查询返回的结果判断父查询表中的此行是否满足条件如果满足条件，则把该行放入父查询的查询结果集合中，重复执行这一过程，知道处理完父查询表中的每一行数据</p><p>比如，查询学生的学号，姓名，查询条件是该学生选课中有c1课程<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sno,sname</span><br><span class="line"><span class="keyword">FROM</span> s</span><br><span class="line"><span class="keyword">WHERE</span> &quot;c1&quot; <span class="keyword">IN</span> (<span class="keyword">SELECT</span> cno</span><br><span class="line">               <span class="keyword">FROM</span> stuc</span><br><span class="line">               <span class="keyword">WHERE</span> sno<span class="operator">=</span>s.sno);</span><br></pre></td></tr></table></figure></p><h2 id="集合运算查询"><a href="#集合运算查询" class="headerlink" title="集合运算查询"></a>集合运算查询</h2><p>集合运算查询是使用<code>UNION</code>关键字将来自不同查询的数据组合起来，形成一个具有综合信息的查询结果，使用<code>UNION</code>时，系统会自动将重复的数据行剔除</p><div class="note danger morden flat"><p>参加集合运算查询的各子查询，其查询结果的结果应该是相同的，即各子查询结果中数据的数目和对应的数据类型都必须相同</p></div><p>比如，查询主修为计算机专业的学生，再查询主修为数学的学生<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> s</span><br><span class="line"><span class="keyword">WHERE</span> major<span class="operator">=</span>&quot;计算机&quot;</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> s</span><br><span class="line"><span class="keyword">WHERE</span> major<span class="operator">=</span>&quot;数学&quot;;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">对于一般的个人使用者和中小型企业来说，MySQL提供的功能已经绰绰有余，而且由于 MySQL是开放源码软件，因此可以大大降低总体拥有成本。</summary>
    
    
    
    <category term="数据库" scheme="http://lucylcarus.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="http://lucylcarus.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行(二)</title>
    <link href="http://lucylcarus.github.io/posts/ab55f924.html"/>
    <id>http://lucylcarus.github.io/posts/ab55f924.html</id>
    <published>2024-11-09T09:09:23.000Z</published>
    <updated>2024-12-04T04:54:57.959Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查找定位文件命令"><a href="#查找定位文件命令" class="headerlink" title="查找定位文件命令"></a>查找定位文件命令</h1><h2 id="pwd命令"><a href="#pwd命令" class="headerlink" title="pwd命令"></a><code>pwd</code>命令</h2><p>显示用户当前所在目录</p><blockquote><p>例：<br>显示当前所在目录<br>pwd</p></blockquote><h2 id="cd命令"><a href="#cd命令" class="headerlink" title="cd命令"></a><code>cd</code>命令</h2><p>切换当前工作路径</p><blockquote><p>例：<br>切换到<code>/etc</code>目录<br>cd /etc</p><p>例：<br>返回上一级目录<br>cd -</p></blockquote><h2 id="ls命令"><a href="#ls命令" class="headerlink" title="ls命令"></a><code>ls</code>命令</h2><p>显示目录文件中文件信息，可搭配<code>-a</code>显示全部文件，<code>-l</code>查看文件属性、大小等详细信息</p><blockquote><p>例：<br>显示目录中全部文件信息<br>ls -a</p></blockquote><h2 id="tree命令"><a href="#tree命令" class="headerlink" title="tree命令"></a><code>tree</code>命令</h2><p>以树状图的形式列出目录内容及结构</p><blockquote><p>例：<br>以树状图的形式列出目录内容及结构<br>tree</p></blockquote><h2 id="find命令"><a href="#find命令" class="headerlink" title="find命令"></a><code>find</code>命令</h2><p>按照指定条件查找文件所在位置，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-name</td><td>匹配名称</td></tr><tr><td>-perm</td><td>匹配权限(mode为完全匹配，-mode为包含即可)</td></tr><tr><td>-user</td><td>匹配所有者</td></tr><tr><td>-group</td><td>匹配所属组</td></tr><tr><td>-mtime -n +n</td><td>匹配修改内容的时间(-n为n天以内，+n为n天以前)</td></tr><tr><td>-atime -n +n</td><td>匹配访问文件的时间(-n为n天以内，+n为n天以前)</td></tr><tr><td>-ctime -n +n</td><td>匹配修改文件权限的时间(-n为n天以内，+n为n天以前)</td></tr><tr><td>-nouser</td><td>匹配无所有者文件</td></tr><tr><td>-nogroup</td><td>匹配无所属组的文件</td></tr><tr><td>-newer f1 !f2</td><td>匹配比文件f1新但比文件f2旧的文件</td></tr><tr><td>-type</td><td>匹配文件类型(b块设备，d目录，c字符设备，p管道，l链接文件，f文本文件)</td></tr><tr><td>-size</td><td>匹配文件大小(+50KB为查找超过50KB的文件，-50KB为查找小于50KB的文件)</td></tr><tr><td>-prune</td><td>忽略某个目录</td></tr><tr><td>-exec…… {}\;</td><td>后面可跟用于进一步处理搜索结果的命令</td></tr></tbody></table></div><blockquote><p>例：<br>搜索所有以<code>host</code>开头的文件<br>find /etc -name “host*”</p></blockquote><h2 id="locate命令"><a href="#locate命令" class="headerlink" title="locate命令"></a><code>locate</code>命令</h2><p>按照名称快速搜索文件所对应的位置</p><div class="note info modern"><p>首次使用<code>locate</code>命令前，需要使用<code>updatedb</code>命令来生成索引数据库<br>updatedb</p></div><blockquote><p>例：<br>搜索所有包含<code>whereis</code>名称的文件所在的位置<br>locate whereis</p></blockquote><h2 id="whereis命令"><a href="#whereis命令" class="headerlink" title="whereis命令"></a><code>whereis</code>命令</h2><p>按照名称快速搜索二进制程序(命令)、源代码以及帮助文件所对应的位置</p><blockquote><p>例：<br>查找<code>ls</code>命令所在位置<br>whereis ls</p></blockquote><h2 id="which命令"><a href="#which命令" class="headerlink" title="which命令"></a><code>which</code>命令</h2><p>按照指定名称快速搜索二进制程序(命令)所对应的位置</p><blockquote><p>例：<br>查找<code>locate</code>命令所在位置<br>which locate</p></blockquote><h1 id="文本文件编辑命令"><a href="#文本文件编辑命令" class="headerlink" title="文本文件编辑命令"></a>文本文件编辑命令</h1><h2 id="cat命令"><a href="#cat命令" class="headerlink" title="cat命令"></a><code>cat</code>命令</h2><p>查看纯文本文件(内容较少)</p><blockquote><p>例：<br>查看<code>initial-setup-ks.cfg</code>文件(添加<code>-n</code>可以显示行号)<br>cat -n initial-setup-ks.cfg</p></blockquote><h2 id="more命令"><a href="#more命令" class="headerlink" title="more命令"></a><code>more</code>命令</h2><p>查看纯文本文件(内容较多)</p><blockquote><p>例：<br>查看<code>initial-setup-ks.cfg</code>文件<br>more initial-setup-ks.cfg</p></blockquote><h2 id="head命令"><a href="#head命令" class="headerlink" title="head命令"></a><code>head</code>命令</h2><p>查看纯文本文件的前N行</p><blockquote><p>例：<br>查看<code>initial-setup-ks.cfg</code>文件前10行<br>head -n 10 initial-setup-ks.cfg</p></blockquote><h2 id="tail命令"><a href="#tail命令" class="headerlink" title="tail命令"></a><code>tail</code>命令</h2><p>查看纯文本文件的后N行</p><blockquote><p>例：<br>查看<code>initial-setup-ks.cfg</code>文件(添加<code>-n</code>可以显示行号)<br>tail -n 10 initial-setup-ks.cfg</p></blockquote><h2 id="tr命令"><a href="#tr命令" class="headerlink" title="tr命令"></a><code>tr</code>命令</h2><p>用于替换文本内容中的字符</p><blockquote><p>例：<br>将文本中的英文替换为大写<br>cat anaconda-ks.cfg | tr [a-z] [A-Z]</p></blockquote><h2 id="wc命令"><a href="#wc命令" class="headerlink" title="wc命令"></a><code>wc</code>命令</h2><p>统计指定文本文件的行数、字数或字节数，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-l</td><td>只显示行数</td></tr><tr><td>-w</td><td>只显示单词数</td></tr><tr><td>-c</td><td>只显示字节数</td></tr></tbody></table></div><blockquote><p>例：<br>查看当前系统有多少用户<br>wc -l /etc/passwd</p></blockquote><h2 id="stat命令"><a href="#stat命令" class="headerlink" title="stat命令"></a><code>stat</code>命令</h2><p>用于查看文件的具体存储细节和时间等信息</p><blockquote><p>例：<br>查看<code>anaconda-ks.cfg</code>文件信息<br>stat anaconda-ks.cfg</p></blockquote><h2 id="grep命令"><a href="#grep命令" class="headerlink" title="grep命令"></a><code>grep</code>命令</h2><p>按行提取文本内容，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-b</td><td>将可执行文件(binary)当作文本文件(text)来搜索</td></tr><tr><td>-c</td><td>仅显示找到的行数</td></tr><tr><td>-I</td><td>忽略大小写</td></tr><tr><td>-n</td><td>显示行号</td></tr><tr><td>-v</td><td>反向选择——仅列出没有关键词的行</td></tr></tbody></table></div><blockquote><p>例：<br>查看当前系统中不允许登录系统的所有用户信息<br>grep /sbin/nologin /etc/passwd</p></blockquote><h2 id="cut命令"><a href="#cut命令" class="headerlink" title="cut命令"></a><code>cut</code>命令</h2><p>按列提取文本内容，<code>-f</code>设置需要查看的列数，<code>-d</code>设置间隔符号</p><blockquote><p>例：<br>提取<code>passwd</code>文件中用户名信息，提取以<code>:</code>为间隔符的第一列内容<br>cut -d : -f 1 /etc/passwd</p></blockquote><h2 id="diff命令"><a href="#diff命令" class="headerlink" title="diff命令"></a><code>diff</code>命令</h2><p>比较多个文件之间内容的差异，<code>--brief</code>确认两个文件是否相同，<code>-c</code>详细比较多个文件的差异之处</p><blockquote><p>例：<br>比较<code>fileA.txt</code>和<code>fileB.txt</code>内容具体不同<br>diff -c fileA.txt fileB.txt</p></blockquote><h2 id="uniq命令"><a href="#uniq命令" class="headerlink" title="uniq命令"></a><code>uniq</code>命令</h2><p>去除文本中连续的重复行</p><blockquote><p>例：<br>去除<code>fileA.txt</code>文件中重复行<br>uniq fileA.txt</p></blockquote><h2 id="sort命令"><a href="#sort命令" class="headerlink" title="sort命令"></a><code>sort</code>命令</h2><p>对文本内容进行再排序</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td>忽略大小写</td></tr><tr><td>-b</td><td>忽略缩进与空格</td></tr><tr><td>-n</td><td>以数值型排序</td></tr><tr><td>-r</td><td>反向排序</td></tr><tr><td>-u</td><td>去除重复行</td></tr><tr><td>-t</td><td>指定间隔符</td></tr><tr><td>-k</td><td>设置字段范围</td></tr></tbody></table></div><blockquote><p>例：<br>默认按照字母顺序排序<br>sort fileA.txt</p></blockquote><h1 id="文件目录管理命令"><a href="#文件目录管理命令" class="headerlink" title="文件目录管理命令"></a>文件目录管理命令</h1><h2 id="touch命令"><a href="#touch命令" class="headerlink" title="touch命令"></a><code>touch</code>命令</h2><p>创建空白文件或设置文件的时间，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>仅修改”访问时间”</td></tr><tr><td>-m</td><td>仅修改”修改时间”</td></tr><tr><td>-d</td><td>同时修改”访问时间”和”修改时间”</td></tr></tbody></table></div><blockquote><p>例：<br>创建文件<code>test</code><br>touch test</p></blockquote><h2 id="mkdir命令"><a href="#mkdir命令" class="headerlink" title="mkdir命令"></a><code>mkdir</code>命令</h2><p>创建空白目录，可使用<code>-p</code>参数递归创建具有嵌套层叠关系的文件</p><blockquote><p>例：<br>创建空目录<code>test</code><br>mkdir test</p></blockquote><h2 id="cp命令"><a href="#cp命令" class="headerlink" title="cp命令"></a><code>cp</code>命令</h2><p>复制文件或目录，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-p</td><td>保留原始文件属性</td></tr><tr><td>-d</td><td>若对象为”链接文件”，则保留该”链接文件”的属性</td></tr><tr><td>-r</td><td>递归持续复制(用于目录)</td></tr><tr><td>-i</td><td>若目标文件存在则询问是否覆盖</td></tr><tr><td>-a</td><td>相当于<code>-pdr</code>(以上p、d、r三种效果)</td></tr></tbody></table></div><blockquote><p>例：<br>复制<code>test</code>文件<br>cp test</p></blockquote><h2 id="mv命令"><a href="#mv命令" class="headerlink" title="mv命令"></a><code>mv</code>命令</h2><p>用于剪切或重命名文件</p><blockquote><p>例:<br>将<code>test</code>文件重命名为<code>test.txt</code><br>mv test test.txt</p></blockquote><h2 id="rm命令"><a href="#rm命令" class="headerlink" title="rm命令"></a><code>rm</code>命令</h2><p>用于删除文件或目录，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-f</td><td>强制执行</td></tr><tr><td>-i</td><td>删除前询问</td></tr><tr><td>-r</td><td>删除目录</td></tr><tr><td>-v</td><td>显示过程</td></tr></tbody></table></div><blockquote><p>例：<br>删除<code>test.txt</code>文件<br>rm test.txt</p></blockquote><h2 id="dd命令"><a href="#dd命令" class="headerlink" title="dd命令"></a><code>dd</code>命令</h2><p>按照指定大小和个数的数据块来复制文件或转换文件，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>if</td><td>输入的文件名称</td></tr><tr><td>of</td><td>输出的文件名称</td></tr><tr><td>bs</td><td>设置每个块的大小</td></tr><tr><td>count</td><td>设置要复制的块的个数</td></tr></tbody></table></div><blockquote><p>例：<br>从<code>/dev/zero</code>中取出一个大小10KB的数据块存入<code>test</code>文件中<br>dd if=/dev/zero of=test count=1 bs=10KB</p></blockquote><h2 id="file命令"><a href="#file命令" class="headerlink" title="file命令"></a><code>file</code>命令</h2><p>用于查看文件类型</p><blockquote><p>例：<br>查看<code>anaconda-ks.cfg</code>文件类型<br>file anaconda-ks.cfg</p></blockquote><h2 id="tar命令"><a href="#tar命令" class="headerlink" title="tar命令"></a><code>tar</code>命令</h2><p>用于对文件进行打包压缩或解压，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-c</td><td>创建压缩文件</td></tr><tr><td>-x</td><td>解开压缩文件</td></tr><tr><td>-t</td><td>查看压缩包内有哪些文件</td></tr><tr><td>-z</td><td>用gzip压缩或解压</td></tr><tr><td>-j</td><td>用bzip2压缩或解压</td></tr><tr><td>-v</td><td>显示文件名</td></tr><tr><td>-p</td><td>保留原始的权限或属性</td></tr><tr><td>-P</td><td>使用绝对路径来压缩</td></tr><tr><td>-C</td><td>指定解压到的目录</td></tr></tbody></table></div>]]></content>
    
    
    <summary type="html">伴随着互联网的发展，Linux得到了来自全世界软件爱好者、组织、公司的支持。它除了在服务器方面保持着强劲的发展势头以外，在个人电脑、嵌入式系统上都有着长足的进步。使用者不仅可以直观地获取该操作系统的实现机制，而且可以根据自身的需要来修改完善Linux，使其最大化地适应用户的需要。</summary>
    
    
    
    <category term="操作系统" scheme="http://lucylcarus.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="http://lucylcarus.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 历史记录界面修改</title>
    <link href="http://lucylcarus.github.io/posts/b4c31191.html"/>
    <id>http://lucylcarus.github.io/posts/b4c31191.html</id>
    <published>2024-11-07T01:42:21.000Z</published>
    <updated>2024-12-04T04:54:45.650Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文主要修改文件为<code>screens.rpy</code>文件</strong></p><h1 id="更新日志"><a href="#更新日志" class="headerlink" title="更新日志"></a>更新日志</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滚轮下滑关闭历史记录</span></span><br><span class="line"><span class="comment">## 2024.11.27 发现历史记录对话过少时滚轮下滑无法关闭历史记录界面</span></span><br><span class="line"><span class="comment">## 解决方法 判断当前历史记录个数，小于临界值的部分使用key &quot;mousedown_5&quot; action Return()</span></span><br></pre></td></tr></table></figure><p>参考代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(_history_list)&lt;<span class="number">3</span>:</span><br><span class="line">    key <span class="string">&quot;mousedown_5&quot;</span> action Return()</span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li>大佬教程<br> <a href="https://zhuanlan.zhihu.com/p/348107987">界面样式</a><br> <a href="https://www.bilibili.com/opus/949420104408367120">滑块居中</a><br> <a href="https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=221">记录跳转</a><br> <a href="https://www.bilibili.com/opus/685189039369748514">语音重播</a><br> <a href="https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=846&amp;extra=page%3D3">滚轮关闭</a></li><li>文档链接<br> <a href="https://doc.renpy.cn/zh-CN/history.html#HistoryEntry.image_tag">添加头像</a><br> <a href="https://doc.renpy.cn/zh-CN/history.html#HistoryEntry.voice">语音重播</a><br> <a href="https://doc.renpy.cn/zh-CN/history.html#HistoryEntry.rollback_identifier">记录跳转</a><br> <a href="https://doc.renpy.cn/zh-CN/screen_python.html#ui.adjustment">滚轮关闭</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV11xDqYEETf&cid=26679708170&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="查看源代码"><a href="#查看源代码" class="headerlink" title="查看源代码"></a>查看源代码</h1><p>打开<code>screens.rpy</code>文件，你可以在866行看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 历史屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 这是一个向用户显示对话历史的屏幕。虽然此屏幕没有什么特别之处，但它必须访问储</span></span><br><span class="line"><span class="comment">## 存在 _history_list 中的对话历史记录。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://doc.renpy.cn/zh-CN/history.html</span></span><br><span class="line"></span><br><span class="line">screen history():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 避免预缓存此屏幕，因为它可能非常大。</span></span><br><span class="line">    predict <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    use game_menu(_(<span class="string">&quot;历史&quot;</span>), scroll=(<span class="string">&quot;vpgrid&quot;</span> <span class="keyword">if</span> gui.history_height <span class="keyword">else</span> <span class="string">&quot;viewport&quot;</span>), yinitial=<span class="number">1.0</span>, spacing=gui.history_spacing):</span><br><span class="line"></span><br><span class="line">        style_prefix <span class="string">&quot;history&quot;</span></span><br><span class="line">        <span class="comment">## 记录列表</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> _history_list:</span><br><span class="line"></span><br><span class="line">            window:</span><br><span class="line"></span><br><span class="line">                <span class="comment">## 此代码可确保如果 history_height 为 None 时仍可正常显示条目。</span></span><br><span class="line">                has fixed:</span><br><span class="line">                    yfit <span class="literal">True</span></span><br><span class="line">                <span class="comment">## 如果有名字</span></span><br><span class="line">                <span class="keyword">if</span> h.who:</span><br><span class="line"></span><br><span class="line">                    label h.who:</span><br><span class="line">                        style <span class="string">&quot;history_name&quot;</span></span><br><span class="line">                        substitute <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">## 从 Character 对象中获取叙述角色的文字颜色，如果设置了</span></span><br><span class="line">                        <span class="comment">## 的话。</span></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;color&quot;</span> <span class="keyword">in</span> h.who_args:</span><br><span class="line">                            text_color h.who_args[<span class="string">&quot;color&quot;</span>]</span><br><span class="line">                <span class="comment">## 对话</span></span><br><span class="line">                $ what = renpy.filter_text_tags(h.what, allow=gui.history_allow_tags)</span><br><span class="line">                text what:</span><br><span class="line">                    substitute <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _history_list:</span><br><span class="line">            label _(<span class="string">&quot;尚无对话历史记录。&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码决定了允许在历史记录屏幕上显示哪些标签。</span></span><br><span class="line"></span><br><span class="line">define gui.history_allow_tags = &#123; <span class="string">&quot;alt&quot;</span>, <span class="string">&quot;noalt&quot;</span>, <span class="string">&quot;rt&quot;</span>, <span class="string">&quot;rb&quot;</span>, <span class="string">&quot;art&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style history_window <span class="keyword">is</span> empty</span><br><span class="line"></span><br><span class="line">style history_name <span class="keyword">is</span> gui_label</span><br><span class="line">style history_name_text <span class="keyword">is</span> gui_label_text</span><br><span class="line">style history_text <span class="keyword">is</span> gui_text</span><br><span class="line"></span><br><span class="line">style history_label <span class="keyword">is</span> gui_label</span><br><span class="line">style history_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line"></span><br><span class="line">style history_window:</span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line">    ysize gui.history_height</span><br><span class="line"></span><br><span class="line">style history_name:</span><br><span class="line">    xpos gui.history_name_xpos</span><br><span class="line">    xanchor gui.history_name_xalign</span><br><span class="line">    ypos gui.history_name_ypos</span><br><span class="line">    xsize gui.history_name_width</span><br><span class="line"></span><br><span class="line">style history_name_text:</span><br><span class="line">    min_width gui.history_name_width</span><br><span class="line">    textalign gui.history_name_xalign</span><br><span class="line"></span><br><span class="line">style history_text:</span><br><span class="line">    xpos gui.history_text_xpos</span><br><span class="line">    ypos gui.history_text_ypos</span><br><span class="line">    xanchor gui.history_text_xalign</span><br><span class="line">    xsize gui.history_text_width</span><br><span class="line">    min_width gui.history_text_width</span><br><span class="line">    textalign gui.history_text_xalign</span><br><span class="line">    layout (<span class="string">&quot;subtitle&quot;</span> <span class="keyword">if</span> gui.history_text_xalign <span class="keyword">else</span> <span class="string">&quot;tex&quot;</span>)</span><br><span class="line"></span><br><span class="line">style history_label:</span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style history_label_text:</span><br><span class="line">    xalign <span class="number">0.5</span></span><br></pre></td></tr></table></figure></p><h1 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h1><p>默认界面总体而言还是比较简单单调的，我们稍作修改，示例代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 历史屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 这是一个向用户显示对话历史的屏幕。虽然此屏幕没有什么特别之处，但它必须访问储</span></span><br><span class="line"><span class="comment">## 存在 _history_list 中的对话历史记录。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://www.renpy.cn/doc/history.html</span></span><br><span class="line"></span><br><span class="line">screen history():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 避免预缓存此屏幕，因为它可能非常大。</span></span><br><span class="line">    predict <span class="literal">False</span></span><br><span class="line">    <span class="comment">#添加历史记录背景图</span></span><br><span class="line">    add <span class="string">&quot;history_bg.png&quot;</span></span><br><span class="line">    frame:</span><br><span class="line">        style<span class="string">&quot;history_frame_style&quot;</span></span><br><span class="line">        frame:</span><br><span class="line">            style<span class="string">&quot;history_window_frame_style&quot;</span></span><br><span class="line"></span><br><span class="line">            vpgrid <span class="built_in">id</span> <span class="string">&quot;history_list&quot;</span>:</span><br><span class="line">                <span class="comment">#行数</span></span><br><span class="line">                cols <span class="number">1</span></span><br><span class="line">                <span class="comment">#视口初始垂直偏移量</span></span><br><span class="line">                yinitial <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">                mousewheel <span class="literal">True</span></span><br><span class="line">                draggable <span class="literal">True</span></span><br><span class="line">                pagekeys <span class="literal">True</span></span><br><span class="line">                </span><br><span class="line">                side_xfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> h <span class="keyword">in</span> _history_list:</span><br><span class="line">                    </span><br><span class="line">                    window:</span><br><span class="line">                        <span class="comment"># 背景默认为对话框</span></span><br><span class="line">                        background <span class="literal">None</span></span><br><span class="line">                        <span class="comment"># 高度</span></span><br><span class="line">                        ysize <span class="number">200</span></span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">if</span> h.who:</span><br><span class="line">                            </span><br><span class="line">                            <span class="comment"># 角色名字</span></span><br><span class="line">                            label h.who:</span><br><span class="line">                                xoffset <span class="number">100</span></span><br><span class="line">                                substitute <span class="literal">False</span></span><br><span class="line">                                text_color <span class="string">&quot;#fff&quot;</span></span><br><span class="line">                                text_outlines [(<span class="number">3</span>, <span class="string">&quot;#000000&quot;</span>, <span class="number">0</span>, <span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line">                        <span class="comment"># 历史记录</span></span><br><span class="line">                        $ what = renpy.filter_text_tags(h.what, allow=gui.history_allow_tags)</span><br><span class="line">                        text what:</span><br><span class="line">                            color <span class="string">&quot;#ffffff&quot;</span></span><br><span class="line">                            outlines [(<span class="number">3</span>, <span class="string">&quot;#000000&quot;</span>, <span class="number">0</span>, <span class="number">0</span>)]</span><br><span class="line">                            xoffset <span class="number">250</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> _history_list:</span><br><span class="line">                    label _(<span class="string">&quot;尚无对话历史记录。&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 滚动条</span></span><br><span class="line">    vbar:</span><br><span class="line">        xsize <span class="number">44</span></span><br><span class="line">        ysize <span class="number">570</span></span><br><span class="line">        align (<span class="number">0.95</span>, <span class="number">0.5</span>)</span><br><span class="line">        base_bar <span class="string">&quot;history_bar.png&quot;</span></span><br><span class="line">        thumb Frame(<span class="string">&quot;thumb.png&quot;</span>,xysize=(<span class="number">44</span>,<span class="number">44</span>))</span><br><span class="line">        thumb_offset <span class="number">14</span></span><br><span class="line">        value YScrollValue(<span class="string">&quot;history_list&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回按钮</span></span><br><span class="line">    imagebutton:</span><br><span class="line">        align (<span class="number">0.95</span>, <span class="number">0.9</span>)</span><br><span class="line">        idle <span class="string">&quot;return.png&quot;</span></span><br><span class="line">        hover <span class="string">&quot;return_hover.png&quot;</span></span><br><span class="line">        action Return()</span><br><span class="line"></span><br><span class="line"><span class="comment">#新添加样式  </span></span><br><span class="line">style history_frame_style:</span><br><span class="line">    left_padding <span class="number">200</span> <span class="comment">#左边距</span></span><br><span class="line">    right_padding <span class="number">0</span> <span class="comment">#右边距</span></span><br><span class="line"></span><br><span class="line">style history_window_frame_style:</span><br><span class="line">    top_padding <span class="number">185</span> <span class="comment">#顶部边距</span></span><br><span class="line">    bottom_padding <span class="number">150</span> <span class="comment">#底部边距</span></span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码决定了允许在历史记录屏幕上显示哪些标签。</span></span><br><span class="line"></span><br><span class="line">define gui.history_allow_tags = &#123; <span class="string">&quot;alt&quot;</span>, <span class="string">&quot;noalt&quot;</span>, <span class="string">&quot;rt&quot;</span>, <span class="string">&quot;rb&quot;</span>, <span class="string">&quot;art&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style history_window <span class="keyword">is</span> empty</span><br><span class="line"></span><br><span class="line">style history_name <span class="keyword">is</span> gui_label</span><br><span class="line">style history_name_text <span class="keyword">is</span> gui_label_text</span><br><span class="line">style history_text <span class="keyword">is</span> gui_text</span><br><span class="line"></span><br><span class="line">style history_label <span class="keyword">is</span> gui_label</span><br><span class="line">style history_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line"></span><br><span class="line">style history_window:</span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line">    ysize gui.history_height</span><br><span class="line"></span><br><span class="line">style history_name:</span><br><span class="line">    xpos gui.history_name_xpos</span><br><span class="line">    xanchor gui.history_name_xalign</span><br><span class="line">    ypos gui.history_name_ypos</span><br><span class="line">    xsize gui.history_name_width</span><br><span class="line"></span><br><span class="line">style history_name_text:</span><br><span class="line">    min_width gui.history_name_width</span><br><span class="line">    textalign gui.history_name_xalign</span><br><span class="line"></span><br><span class="line">style history_text:</span><br><span class="line">    xpos gui.history_text_xpos</span><br><span class="line">    ypos gui.history_text_ypos</span><br><span class="line">    xanchor gui.history_text_xalign</span><br><span class="line">    xsize gui.history_text_width</span><br><span class="line">    min_width gui.history_text_width</span><br><span class="line">    textalign gui.history_text_xalign</span><br><span class="line">    layout (<span class="string">&quot;subtitle&quot;</span> <span class="keyword">if</span> gui.history_text_xalign <span class="keyword">else</span> <span class="string">&quot;tex&quot;</span>)</span><br><span class="line"></span><br><span class="line">style history_label:</span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style history_label_text:</span><br><span class="line">    xalign <span class="number">0.5</span></span><br></pre></td></tr></table></figure></p><h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><p>到这里比较基础的部分就完成了，接下来我们添加一些功能选项</p><h2 id="历史记录跳转"><a href="#历史记录跳转" class="headerlink" title="历史记录跳转"></a>历史记录跳转</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 跳转按钮</span></span><br><span class="line">imagebutton:</span><br><span class="line">    idle <span class="string">&quot;jump.png&quot;</span></span><br><span class="line">    hover <span class="string">&quot;jump_hover.png&quot;</span></span><br><span class="line">    action Confirm(<span class="string">&quot;确定要跳转到该处吗？&quot;</span>,yes=RollbackToIdentifier(h.rollback_identifier), no=<span class="literal">None</span>, confirm_selected=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h2 id="添加角色头像"><a href="#添加角色头像" class="headerlink" title="添加角色头像"></a>添加角色头像</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加头像，如果你在对话框中的头像合适的话，可以直接写为side [h.image_tag]</span></span><br><span class="line"><span class="comment"># (但大多数情况下是不合适的)</span></span><br><span class="line"><span class="keyword">if</span> h.image_tag:</span><br><span class="line">    add <span class="string">&quot;[h.image_tag]_side.png&quot;</span> xysize (<span class="number">100</span>,<span class="number">100</span>) xoffset <span class="number">90</span> yoffset <span class="number">50</span></span><br></pre></td></tr></table></figure><h2 id="角色语音重播"><a href="#角色语音重播" class="headerlink" title="角色语音重播"></a>角色语音重播</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语音重播</span></span><br><span class="line"><span class="keyword">if</span> h.voice.filename:</span><br><span class="line">    imagebutton:</span><br><span class="line">        yoffset <span class="number">45</span></span><br><span class="line">        idle <span class="string">&quot;voice.png&quot;</span></span><br><span class="line">        hover <span class="string">&quot;voice_hover.png&quot;</span></span><br><span class="line">        action Play(<span class="string">&#x27;voice&#x27;</span>, h.voice.filename)</span><br></pre></td></tr></table></figure><h2 id="滚轮上滑打开历史记录"><a href="#滚轮上滑打开历史记录" class="headerlink" title="滚轮上滑打开历史记录"></a>滚轮上滑打开历史记录</h2><p><code>say</code>界面添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key <span class="string">&quot;mousedown_4&quot;</span> action ShowMenu(<span class="string">&#x27;history&#x27;</span>) </span><br></pre></td></tr></table></figure></p><h2 id="滚轮下滑返回游戏"><a href="#滚轮下滑返回游戏" class="headerlink" title="滚轮下滑返回游戏"></a>滚轮下滑返回游戏</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滚轮下滑关闭历史记录</span></span><br><span class="line">init python:</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">MyAdjustment</span>(renpy.display.behavior.Adjustment):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">self, value, end_animation=<span class="literal">True</span></span>):</span><br><span class="line">            <span class="keyword">if</span> value &gt; <span class="variable language_">self</span>._<span class="built_in">range</span> <span class="keyword">and</span> <span class="variable language_">self</span>._value == <span class="variable language_">self</span>._<span class="built_in">range</span>:</span><br><span class="line">                <span class="comment"># 返回游戏界面</span></span><br><span class="line">                <span class="keyword">return</span> Return()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 其他情况，正常执行</span></span><br><span class="line">                <span class="keyword">return</span> renpy.display.behavior.Adjustment.change(<span class="variable language_">self</span>, value, end_animation)</span><br><span class="line"><span class="comment"># 理论上这里的range应该修改为我们需要的范围，但不做修改也不会有问题</span></span><br><span class="line">default history_bar_pos = MyAdjustment(<span class="built_in">range</span> = <span class="number">100</span>,changed =<span class="literal">None</span>,adjustable=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><code>vpgrid</code>内<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yadjustment history_bar_pos</span><br></pre></td></tr></table></figure></p><h2 id="直达顶部底部"><a href="#直达顶部底部" class="headerlink" title="直达顶部底部"></a>直达顶部底部</h2><p>添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回顶部</span></span><br><span class="line">imagebutton:</span><br><span class="line">    idle <span class="string">&quot;top.png&quot;</span></span><br><span class="line">    hover <span class="string">&quot;top_hover.png&quot;</span></span><br><span class="line">    action Function(history_bar_pos.change,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回底部</span></span><br><span class="line">imagebutton:</span><br><span class="line">    idle <span class="string">&quot;buttom.png&quot;</span></span><br><span class="line">    hover <span class="string">&quot;buttom_hover.png&quot;</span></span><br><span class="line">    insensitive <span class="string">&quot;top.png&quot;</span></span><br><span class="line">    <span class="comment"># 历史记录最大块数乘高度</span></span><br><span class="line">    action Function(history_bar_pos.change,config.history_length*<span class="number">200</span>)</span><br></pre></td></tr></table></figure></p><h1 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h1><p>在<code>gui.rpy</code>文件中有一些有关历史记录界面的设置，你可以在317行左右看到<br>我修改后的代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 历史 ##########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 历史记录屏幕显示玩家已经阅读过的对话。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Ren&#x27;Py 将保留的对话历史块数。</span></span><br><span class="line">define config.history_length = <span class="number">250</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 历史屏幕条目的高度，或设置为 None 以使高度变量自适应。</span></span><br><span class="line">define gui.history_height = <span class="number">210</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Additional space to add between history screen entries.</span></span><br><span class="line">define gui.history_spacing = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 所指定叙述角色的标签的坐标、宽度和对齐方式。</span></span><br><span class="line">define gui.history_name_xpos = <span class="number">233</span></span><br><span class="line">define gui.history_name_ypos = <span class="number">0</span></span><br><span class="line">define gui.history_name_width = <span class="number">233</span></span><br><span class="line">define gui.history_name_xalign = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 对话文本的坐标、宽度和对齐方式。</span></span><br><span class="line">define gui.history_text_xpos = <span class="number">255</span></span><br><span class="line">define gui.history_text_ypos = <span class="number">3</span></span><br><span class="line">define gui.history_text_width = <span class="number">1110</span></span><br><span class="line">define gui.history_text_xalign = <span class="number">0.0</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中历史记录界面的一些修改，包括添加角色头像，语音重播，记录跳转等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行(一)</title>
    <link href="http://lucylcarus.github.io/posts/9211474f.html"/>
    <id>http://lucylcarus.github.io/posts/9211474f.html</id>
    <published>2024-11-04T09:09:23.000Z</published>
    <updated>2024-12-04T04:54:53.045Z</updated>
    
    <content type="html"><![CDATA[<h1 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h1><ol><li><p><code>Tab</code>：补全</p></li><li><p><code>Ctrl + C</code>：中止当前正在执行的命令</p></li><li><p><code>Ctrl + D</code>：键盘输入结束</p></li><li><p><code>Ctrl + I</code>：清空终端内容</p></li></ol><h1 id="常用系统工作命令"><a href="#常用系统工作命令" class="headerlink" title="常用系统工作命令"></a>常用系统工作命令</h1><h2 id="echo命令"><a href="#echo命令" class="headerlink" title="echo命令"></a><code>echo</code>命令</h2><p>在终端设备上显示输出字符串的值或变量提取后的值</p><div class="note info modern"><p>输出字符</p></div><blockquote><p>例：<br>输出字符linux<br>echo linux</p></blockquote><div class="note info modern"><p>输出变量提取后的值</p></div><blockquote><p>例：<br>输出SHELL的值<br>echo $SHELL</p></blockquote><h2 id="date命令"><a href="#date命令" class="headerlink" title="date命令"></a><code>date</code>命令</h2><p>显示或设置系统的时间与日期，使用时需在参数前加上符号<code>+</code>, 一些参数设置如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>%S</td><td>秒(0-59)</td></tr><tr><td>%M</td><td>分(0-59)</td></tr><tr><td>%H</td><td>时(0-23)</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>%I</td><td>小时(0-12)</td></tr><tr><td>%m</td><td>月份(1-12)</td></tr><tr><td>%p</td><td>显示出AM或PM</td></tr><tr><td>%a</td><td>缩写工作日名称</td></tr><tr><td>%A</td><td>完整工作日名称</td></tr><tr><td>%b</td><td>缩写月份名称</td></tr><tr><td>%B</td><td>完整月份名称</td></tr><tr><td>%q</td><td>季度</td></tr><tr><td>%y</td><td>简写年份</td></tr><tr><td>%Y</td><td>完整年份</td></tr><tr><td>%d</td><td>本月中的第几天</td></tr><tr><td>%j</td><td>本年中的第几天</td></tr><tr><td>%n</td><td>换行符</td></tr><tr><td>%t</td><td>缩进</td></tr></tbody></table></div><blockquote><p>例：<br>查看当前系统时间<br>date</p></blockquote><div class="note info modern"><p>输出格式为 星期 月 日 时:分:秒 时区 年</p></div><blockquote><p>例：<br>以<code>年-月-日 时:分:秒</code>的格式查看当前系统时间<br>date “+%Y-%m-%d %H:%M:%S”</p></blockquote><h2 id="timedatectl命令"><a href="#timedatectl命令" class="headerlink" title="timedatectl命令"></a><code>timedatectl</code>命令</h2><p>设置系统时间，常见参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>status</td><td>显示状态信息</td></tr><tr><td>list-timezones</td><td>列出已知时区</td></tr><tr><td>set-time</td><td>设置系统时间</td></tr><tr><td>set-timezone</td><td>设置生效时区</td></tr></tbody></table></div><blockquote><p>例：<br>设置时区为上海<br>timedatectl set-timezone Asia/Shanghai</p></blockquote><h2 id="reboot命令"><a href="#reboot命令" class="headerlink" title="reboot命令"></a><code>reboot</code>命令</h2><p>重启系统(最好使用root用户)</p><blockquote><p>例：<br>重启系统<br>reboot</p></blockquote><h2 id="poweroff命令"><a href="#poweroff命令" class="headerlink" title="poweroff命令"></a><code>poweroff</code>命令</h2><p>关闭系统(最好使用root用户)</p><blockquote><p>例：<br>关闭系统<br>poweroff</p></blockquote><h2 id="wget命令"><a href="#wget命令" class="headerlink" title="wget命令"></a><code>wget</code>命令</h2><p>下载文件，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-b</td><td>后台下载模式</td></tr><tr><td>-P</td><td>下载到指定目录</td></tr><tr><td>-t</td><td>最大尝试次数</td></tr><tr><td>-c</td><td>断点续传</td></tr><tr><td>-p</td><td>下载页面所有资源</td></tr><tr><td>-r</td><td>递归下载</td></tr></tbody></table></div><blockquote><p>例：<br>下载本篇文章<br>wget <a href="https://lucylcarus.github.io/posts/9211474f.html">https://lucylcarus.github.io/posts/9211474f.html</a></p></blockquote><h2 id="ps命令"><a href="#ps命令" class="headerlink" title="ps命令"></a><code>ps</code>命令</h2><p>查看进程状态，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>显示所有进程</td></tr><tr><td>-u</td><td>用户以及其他详细信息</td></tr><tr><td>-x</td><td>显示没有控制终端的进程</td></tr></tbody></table></div><div class="note info modern"><p>Linux中进程常见状态<br>R(运行)  S(中断)   D(不可中断)   Z(僵死)   T(停止)</p></div><h2 id="pstree命令"><a href="#pstree命令" class="headerlink" title="pstree命令"></a><code>pstree</code>命令</h2><p>树状图展示进程间的关系</p><h2 id="top命令"><a href="#top命令" class="headerlink" title="top命令"></a><code>top</code>命令</h2><p>动态监视进程活动及系统负载信息</p><h2 id="nice命令"><a href="#nice命令" class="headerlink" title="nice命令"></a><code>nice</code>命令</h2><p>用于调整进程优先级，用法为<code>nice + 优先级数字 + 服务</code><br>优先级数字范围为-20~19，数字越小，优先级越高</p><blockquote><p>例：<br>调整bash服务的优先级为最高<br>nice -20 bash</p></blockquote><h2 id="pidof命令"><a href="#pidof命令" class="headerlink" title="pidof命令"></a><code>pidof</code>命令</h2><p>查询某个服务进程的pid号码值</p><blockquote><p>例：<br>查询sshd服务的pid<br>pidof sshd</p></blockquote><h2 id="kill命令"><a href="#kill命令" class="headerlink" title="kill命令"></a><code>kill</code>命令</h2><p>终止某个指定pid值的服务进程</p><blockquote><p>例：<br>终止sshd服务<br>kill 2156</p></blockquote><h2 id="killall命令"><a href="#killall命令" class="headerlink" title="killall命令"></a><code>killall</code>命令</h2><p>终止某个指定服务所对应的全部进程</p><blockquote><p>例：<br>终止httpd服务<br>killall httpd</p></blockquote><h1 id="系统状态检测命令"><a href="#系统状态检测命令" class="headerlink" title="系统状态检测命令"></a>系统状态检测命令</h1><h2 id="ifconfig命令"><a href="#ifconfig命令" class="headerlink" title="ifconfig命令"></a><code>ifconfig</code>命令</h2><p>用于获取网卡配置与网络状态等信息</p><blockquote><p>例：<br>查看本机网卡配置与网络状态等信息<br>ifconfig</p></blockquote><h2 id="uname命令"><a href="#uname命令" class="headerlink" title="uname命令"></a><code>uname</code>命令</h2><p>查看系统内核版本与系统结构框架等信息，一般搭配<code>-a</code>使用</p><blockquote><p>例：<br>查看本机系统内核版本与系统结构框架等信息<br>uname -a</p></blockquote><h2 id="uptime命令"><a href="#uptime命令" class="headerlink" title="uptime命令"></a><code>uptime</code>命令</h2><p>查看系统负载信息</p><blockquote><p>例：<br>查看本机系统负载信息<br>uptime</p></blockquote><h2 id="free命令"><a href="#free命令" class="headerlink" title="free命令"></a><code>free</code>命令</h2><p>显示当前系统内存使用量信息</p><blockquote><p>例：<br>显示当前系统内存使用量信息<br>free -h</p></blockquote><h2 id="who命令"><a href="#who命令" class="headerlink" title="who命令"></a><code>who</code>命令</h2><p>查看当前登入主机用户终端信息</p><blockquote><p>例：<br>查看当前登入主机用户终端信息<br>who</p></blockquote><h2 id="last命令"><a href="#last命令" class="headerlink" title="last命令"></a><code>last</code>命令</h2><p>调取主机被访问记录</p><blockquote><p>例：<br>调取主机被访问记录<br>last</p></blockquote><h2 id="ping命令"><a href="#ping命令" class="headerlink" title="ping命令"></a><code>ping</code>命令</h2><p>测试主机间的网络连通性，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-c</td><td>总共发送次数</td></tr><tr><td>-l</td><td>指定网卡名称</td></tr><tr><td>-I</td><td>每次间隔时间(秒)</td></tr><tr><td>-W</td><td>最长等待时间(秒)</td></tr></tbody></table></div><blockquote><p>例：<br>ping 百度官网<br>ping www.baidu.com</p></blockquote><h2 id="tracepath命令"><a href="#tracepath命令" class="headerlink" title="tracepath命令"></a><code>tracepath</code>命令</h2><p>显示数据包到达目的主机时途中经过的所有路由信息</p><blockquote><p>例：<br>显示数据包到达百度官网时途中经过的所有路由信息<br>tracepath www.baidu.com</p></blockquote><h2 id="netstat命令"><a href="#netstat命令" class="headerlink" title="netstat命令"></a><code>netstat</code>命令</h2><p>查看网络状态等信息，常用参数如下表所示</p><div class="table-container"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>显示所有连接中的Socket</td></tr><tr><td>-p</td><td>显示正在使用的Socket信息</td></tr><tr><td>-t</td><td>显示TCP协议的连接状态</td></tr><tr><td>-u</td><td>显示UDP协议的连接状态</td></tr><tr><td>-n</td><td>使用ip地址，不使用域名</td></tr><tr><td>-l</td><td>仅列出正在监听的服务状态</td></tr><tr><td>-i</td><td>现在网卡列表信息</td></tr><tr><td>-r</td><td>显示路由表信息</td></tr></tbody></table></div><blockquote><p>例：<br>显示网卡列表<br>netstat -i</p></blockquote><h2 id="history命令"><a href="#history命令" class="headerlink" title="history命令"></a><code>history</code>命令</h2><p>显示执行过的命令历史，可以使用<code>-c</code>命令清空所有命令历史记录</p><blockquote><p>例：<br>显示执行过的命令历史<br>history -c</p></blockquote><h2 id="sosreport命令"><a href="#sosreport命令" class="headerlink" title="sosreport命令"></a><code>sosreport</code>命令</h2><p>用于收集系统配置及架构信息并输出诊断文档</p><blockquote><p>例：<br>加粗部分为收集好的资料压缩文件及校验码<br>sosreport</p></blockquote>]]></content>
    
    
    <summary type="html">Linux是一套免费使用和自由传播的类Unix操作系统，是一个遵循POSIX的多用户、多任务、支持多线程和多CPU的操作系统。</summary>
    
    
    
    <category term="操作系统" scheme="http://lucylcarus.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="http://lucylcarus.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 存档读档界面修改</title>
    <link href="http://lucylcarus.github.io/posts/39e7251c.html"/>
    <id>http://lucylcarus.github.io/posts/39e7251c.html</id>
    <published>2024-10-31T12:14:39.000Z</published>
    <updated>2024-12-04T04:55:43.238Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文主要修改的文件为<code>screens.rpy</code>，次要修改文件为<code>gui.rpy</code></strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol><li>大佬教程<br> <a href="https://www.renpy.cn/forum.php?mod=viewthread&amp;tid=847">添加描述</a></li><li>文档链接<br><a href="https://doc.renpy.cn/zh-CN/other.html#last_say">最近发言</a><br><a href="https://doc.renpy.cn/zh-CN/screen_actions.html#FileSlotName">存档编号</a><br><a href="https://doc.renpy.cn/zh-CN/screen_actions.html#FileNewest">最新存档</a><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1></li></ol><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1WYSHYeECU&cid=26552764189&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="查看源代码"><a href="#查看源代码" class="headerlink" title="查看源代码"></a>查看源代码</h1><p>打开<code>screens.rpy</code>文件，你可以在564行看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 读取和保存屏幕 #####################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 这些屏幕负责让用户保存游戏并能够再次读取。由于它们几乎完全一样，因此这两个屏</span></span><br><span class="line"><span class="comment">## 幕都是以第三个屏幕 file_slots 来实现的。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://doc.renpy.cn/zh-CN/screen_special.html#save https://doc.renpy.cn/zh-</span></span><br><span class="line"><span class="comment">## CN/screen_special.html#load</span></span><br><span class="line"><span class="comment">## 存档界面</span></span><br><span class="line">screen save():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    use file_slots(_(<span class="string">&quot;保存&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">## 读档界面</span></span><br><span class="line">screen load():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    use file_slots(_(<span class="string">&quot;读取游戏&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">## 调用的界面</span></span><br><span class="line">screen file_slots(title):</span><br><span class="line"><span class="comment">## 当前页数，非必须</span></span><br><span class="line">    default page_name_value = FilePageNameInputValue(pattern=_(<span class="string">&quot;第 &#123;&#125; 页&quot;</span>), auto=_(<span class="string">&quot;自动存档&quot;</span>), quick=_(<span class="string">&quot;快速存档&quot;</span>))</span><br><span class="line">    <span class="comment">## 调用game_menu界面，非必须</span></span><br><span class="line">    use game_menu(title):</span><br><span class="line"></span><br><span class="line">        fixed:</span><br><span class="line"></span><br><span class="line">            <span class="comment">## 此代码确保输入控件在任意按钮执行前可以获取 enter 事件。</span></span><br><span class="line">            order_reverse <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">## 页面名称，可以通过单击按钮进行编辑。</span></span><br><span class="line">            button:</span><br><span class="line">                style <span class="string">&quot;page_label&quot;</span></span><br><span class="line"></span><br><span class="line">                key_events <span class="literal">True</span></span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                action page_name_value.Toggle()</span><br><span class="line">                <span class="comment">## 可通过点击第几页实现页面跳转，非必须</span></span><br><span class="line">                <span class="built_in">input</span>:</span><br><span class="line">                    style <span class="string">&quot;page_label_text&quot;</span></span><br><span class="line">                    value page_name_value</span><br><span class="line"></span><br><span class="line">            <span class="comment">## 存档位网格。</span></span><br><span class="line">            grid gui.file_slot_cols gui.file_slot_rows:</span><br><span class="line">                style_prefix <span class="string">&quot;slot&quot;</span></span><br><span class="line"></span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                yalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">                spacing gui.slot_spacing</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line"></span><br><span class="line">                    $ slot = i + <span class="number">1</span></span><br><span class="line">                    <span class="comment">## 存档按钮</span></span><br><span class="line">                    button:</span><br><span class="line">                        action FileAction(slot)<span class="comment">## 执行正确的行为，如果在存档界面则为存档，如果在读档界面则为读档</span></span><br><span class="line"></span><br><span class="line">                        has vbox<span class="comment">## vbox的另一种写法，省略了缩进</span></span><br><span class="line"></span><br><span class="line">                        add FileScreenshot(slot) xalign <span class="number">0.5</span><span class="comment">## 添加屏幕快照</span></span><br><span class="line">                        <span class="comment">## 存档时间，empty为空存档的名称</span></span><br><span class="line">                        text FileTime(slot, <span class="built_in">format</span>=_(<span class="string">&quot;&#123;#file_time&#125;%Y-%m-%d %H:%M&quot;</span>), empty=_(<span class="string">&quot;空存档位&quot;</span>)):</span><br><span class="line">                            style <span class="string">&quot;slot_time_text&quot;</span></span><br><span class="line">                        <span class="comment">## 返回存档文件保存时的save_name，如果文件不存在则返回empty。</span></span><br><span class="line">                        text FileSaveName(slot):</span><br><span class="line">                            style <span class="string">&quot;slot_name_text&quot;</span></span><br><span class="line">                        <span class="comment">## 键盘delete键删除存档</span></span><br><span class="line">                        key <span class="string">&quot;save_delete&quot;</span> action FileDelete(slot)</span><br><span class="line"></span><br><span class="line">            <span class="comment">## 用于访问其他页面的按钮。</span></span><br><span class="line">            vbox:</span><br><span class="line">                style_prefix <span class="string">&quot;page&quot;</span></span><br><span class="line"></span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                yalign <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">                hbox:</span><br><span class="line">                    xalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">                    spacing gui.page_spacing</span><br><span class="line"></span><br><span class="line">                    textbutton _(<span class="string">&quot;&lt;&quot;</span>) action FilePagePrevious() <span class="comment">## 上一页</span></span><br><span class="line">                    key <span class="string">&quot;save_page_prev&quot;</span> action FilePagePrevious() <span class="comment">## 键盘上一页翻页</span></span><br><span class="line">                    <span class="comment">## 自动存档页</span></span><br><span class="line">                    <span class="keyword">if</span> config.has_autosave:</span><br><span class="line">                        textbutton _(<span class="string">&quot;&#123;#auto_page&#125;A&quot;</span>) action FilePage(<span class="string">&quot;auto&quot;</span>)</span><br><span class="line">                    <span class="comment">## 快速存档页</span></span><br><span class="line">                    <span class="keyword">if</span> config.has_quicksave:</span><br><span class="line">                        textbutton _(<span class="string">&quot;&#123;#quick_page&#125;Q&quot;</span>) action FilePage(<span class="string">&quot;quick&quot;</span>)</span><br><span class="line">                    <span class="comment">## 普通存档页页数</span></span><br><span class="line">                    <span class="comment">## range(1, 10) 给出 1 到 9 之间的数字。</span></span><br><span class="line">                    <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">                        textbutton <span class="string">&quot;[page]&quot;</span> action FilePage(page)</span><br><span class="line"></span><br><span class="line">                    textbutton _(<span class="string">&quot;&gt;&quot;</span>) action FilePageNext() <span class="comment">## 下一页</span></span><br><span class="line">                    key <span class="string">&quot;save_page_next&quot;</span> action FilePageNext() <span class="comment">## 键盘下一页翻页</span></span><br><span class="line">                <span class="comment">## 上传下载存档，非必须</span></span><br><span class="line">                <span class="keyword">if</span> config.has_sync:</span><br><span class="line">                    <span class="keyword">if</span> CurrentScreenName() == <span class="string">&quot;save&quot;</span>:</span><br><span class="line">                        textbutton _(<span class="string">&quot;上传同步&quot;</span>):</span><br><span class="line">                            action UploadSync()</span><br><span class="line">                            xalign <span class="number">0.5</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        textbutton _(<span class="string">&quot;下载同步&quot;</span>):</span><br><span class="line">                            action DownloadSync()</span><br><span class="line">                            xalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档读档界面所需样式</span></span><br><span class="line">style page_label <span class="keyword">is</span> gui_label</span><br><span class="line">style page_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line">style page_button <span class="keyword">is</span> gui_button</span><br><span class="line">style page_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line"></span><br><span class="line">style slot_button <span class="keyword">is</span> gui_button</span><br><span class="line">style slot_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line">style slot_time_text <span class="keyword">is</span> slot_button_text</span><br><span class="line">style slot_name_text <span class="keyword">is</span> slot_button_text</span><br><span class="line"></span><br><span class="line">style page_label:</span><br><span class="line">    xpadding <span class="number">75</span></span><br><span class="line">    ypadding <span class="number">5</span></span><br><span class="line"></span><br><span class="line">style page_label_text:</span><br><span class="line">    textalign <span class="number">0.5</span></span><br><span class="line">    layout <span class="string">&quot;subtitle&quot;</span></span><br><span class="line">    hover_color gui.hover_color</span><br><span class="line"></span><br><span class="line">style page_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;page_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style page_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;page_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slot_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;slot_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slot_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;slot_button&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>由于存档界面和读档界面并无太大差别，所以在Ren’py中，存档界面和读档界面都是调用第三个界面——<code>file_slots</code>来实现的，各部分的详细作用请查看上述注释</p><h1 id="初步自定义"><a href="#初步自定义" class="headerlink" title="初步自定义"></a>初步自定义</h1><p>现在我们删去不必要的部分，添加些背景图像，并为存档添加描述，参考代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 读取和保存屏幕 #####################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 这些屏幕负责让用户保存游戏并能够再次读取。由于它们几乎完全一样，因此这两个屏</span></span><br><span class="line"><span class="comment">## 幕都是以第三个屏幕 file_slots 来实现的。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">##引入必要模块</span></span><br><span class="line"></span><br><span class="line">init python:</span><br><span class="line">    <span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#存档界面</span></span><br><span class="line">screen save():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line">    <span class="comment">#存档界面背景图</span></span><br><span class="line">    add <span class="string">&quot;save_load_bg&quot;</span></span><br><span class="line">    <span class="comment">#存档界面logo</span></span><br><span class="line">    add <span class="string">&quot;gui/button/save.png&quot;</span> zoom <span class="number">1.5</span> yoffset <span class="number">50</span></span><br><span class="line"></span><br><span class="line">    fixed:</span><br><span class="line">        <span class="comment">## 此语句确保输入控件在任意按钮执行前可以获取“enter”事件。</span></span><br><span class="line">        order_reverse <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">## 存档位网格。</span></span><br><span class="line">        grid gui.file_slot_cols gui.file_slot_rows:</span><br><span class="line">            style_prefix <span class="string">&quot;slot&quot;</span> <span class="comment">#该语句不可省略</span></span><br><span class="line">            spacing <span class="number">10</span></span><br><span class="line">            align (<span class="number">0.7</span>, <span class="number">0.5</span>)</span><br><span class="line">            xoffset -<span class="number">10</span></span><br><span class="line">            yoffset <span class="number">25</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line"></span><br><span class="line">                $ slot = i + <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">                button:</span><br><span class="line">                    </span><br><span class="line">                    action FileAction(slot)</span><br><span class="line">                    <span class="comment">#存档按钮背景图</span></span><br><span class="line">                    background <span class="string">&quot;gui/button/slot_idle_background.png&quot;</span></span><br><span class="line">                    <span class="comment">#存档按钮悬停图</span></span><br><span class="line">                    hover_background <span class="string">&quot;gui/button/slot_hover_background.png&quot;</span></span><br><span class="line">                    <span class="comment">#添加屏幕快照缩略图</span></span><br><span class="line">                    add FileScreenshot(slot) xysize(<span class="number">231</span>,<span class="number">130</span>) xoffset -<span class="number">3</span> yoffset <span class="number">62</span></span><br><span class="line">                    </span><br><span class="line">                    vbox:</span><br><span class="line">                        <span class="comment">#时间</span></span><br><span class="line">                        text FileTime(slot, <span class="built_in">format</span>=_(<span class="string">&quot;&#123;#file_time&#125;%Y-%m-%d %H:%M&quot;</span>), empty=_(<span class="string">&quot;空存档&quot;</span>)):</span><br><span class="line">                            style <span class="string">&quot;slot_time_text&quot;</span></span><br><span class="line">                            size <span class="number">30</span></span><br><span class="line">                        </span><br><span class="line">                        frame:</span><br><span class="line">                            background <span class="literal">None</span></span><br><span class="line">                            xysize(<span class="number">210</span>,<span class="number">110</span>)</span><br><span class="line">                            xoffset <span class="number">230</span></span><br><span class="line">                            yoffset <span class="number">20</span></span><br><span class="line">                            <span class="comment">#存档描述</span></span><br><span class="line">                            text FileSaveName(slot):</span><br><span class="line">                                size <span class="number">25</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">#添加存档描述，正则表达式，该语句只可用于存档界面</span></span><br><span class="line">                    <span class="comment">#(大佬给出的代码为固定的快速存档，会导致普通存档无法正常存档，将其修改为FileAction(slot)，执行正确的操作)</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(_last_say_what) &gt;<span class="number">15</span>:</span><br><span class="line">                        action [SetVariable(<span class="string">&quot;save_name&quot;</span>, re.sub(<span class="string">&#x27;(\&#123;.*?\&#125;)|(\\\w)|\s&#x27;</span>, <span class="string">&#x27;&#x27;</span>, _last_say_what[:<span class="number">15</span>])+<span class="string">&quot;...&quot;</span>),FileAction(slot) ]</span><br><span class="line">                    <span class="keyword">elif</span> <span class="built_in">len</span>(_last_say_what) &gt; <span class="number">0</span>:</span><br><span class="line">                        action [SetVariable(<span class="string">&quot;save_name&quot;</span>, re.sub(<span class="string">&#x27;(\&#123;.*?\&#125;)|(\\\w)|\s&#x27;</span>, <span class="string">&#x27;&#x27;</span>, _last_say_what)),FileAction(slot) ]</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        action FileAction(slot)</span><br><span class="line"></span><br><span class="line">        <span class="comment">## 用于访问其他页面的按钮。</span></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;page&quot;</span></span><br><span class="line"></span><br><span class="line">            xalign <span class="number">0.8</span></span><br><span class="line">            yalign <span class="number">0.1</span></span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            <span class="keyword">if</span> config.has_autosave:</span><br><span class="line">                textbutton _(<span class="string">&quot;&#123;#auto_page&#125;A&quot;</span>) action FilePage(<span class="string">&quot;auto&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> config.has_quicksave:</span><br><span class="line">                textbutton _(<span class="string">&quot;&#123;#quick_page&#125;Q&quot;</span>) action FilePage(<span class="string">&quot;quick&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page1.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover1.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover1.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">1</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page2.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover2.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover2.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">2</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page3.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover3.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover3.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">3</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page4.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover4.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover4.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">4</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page5.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover5.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover5.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">5</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page6.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover6.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover6.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">6</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page7.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover7.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover7.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">7</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page8.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover8.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover8.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">8</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page9.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover9.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover9.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.05</span>, <span class="number">0.95</span>)</span><br><span class="line">        text_color <span class="string">&quot;#000&quot;</span></span><br><span class="line">        text_size <span class="number">50</span></span><br><span class="line">        action Return()</span><br><span class="line"></span><br><span class="line"><span class="comment">#读档界面</span></span><br><span class="line">screen load():</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line">    <span class="comment">#读档界面背景图</span></span><br><span class="line">    add <span class="string">&quot;save_load_bg&quot;</span></span><br><span class="line">    <span class="comment">#读档界面logo</span></span><br><span class="line">    add <span class="string">&quot;gui/button/load.png&quot;</span> zoom <span class="number">1.5</span> yoffset <span class="number">50</span></span><br><span class="line"></span><br><span class="line">    fixed:</span><br><span class="line">        <span class="comment">## 此语句确保输入控件在任意按钮执行前可以获取“enter”事件。</span></span><br><span class="line">        order_reverse <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        <span class="comment">## 存档位网格。</span></span><br><span class="line">        grid gui.file_slot_cols gui.file_slot_rows:</span><br><span class="line">            style_prefix <span class="string">&quot;slot&quot;</span> <span class="comment">#该语句不可省略</span></span><br><span class="line">            spacing <span class="number">10</span></span><br><span class="line">            align (<span class="number">0.7</span>, <span class="number">0.5</span>)</span><br><span class="line">            xoffset -<span class="number">10</span></span><br><span class="line">            yoffset <span class="number">25</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line"></span><br><span class="line">                $ slot = i + <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">                button:</span><br><span class="line">                    </span><br><span class="line">                    action FileAction(slot)</span><br><span class="line">                    <span class="comment">#存档按钮背景图</span></span><br><span class="line">                    background <span class="string">&quot;gui/button/slot_idle_background.png&quot;</span></span><br><span class="line">                    <span class="comment">#存档按钮悬停图</span></span><br><span class="line">                    hover_background <span class="string">&quot;gui/button/slot_hover_background.png&quot;</span></span><br><span class="line">                    <span class="comment">#添加屏幕快照缩略图</span></span><br><span class="line">                    add FileScreenshot(slot) xysize(<span class="number">231</span>,<span class="number">130</span>) xoffset -<span class="number">3</span> yoffset <span class="number">62</span></span><br><span class="line">                    </span><br><span class="line">                    vbox:</span><br><span class="line">                        <span class="comment">#时间</span></span><br><span class="line">                        text FileTime(slot, <span class="built_in">format</span>=_(<span class="string">&quot;&#123;#file_time&#125;%Y-%m-%d %H:%M&quot;</span>), empty=_(<span class="string">&quot;空存档&quot;</span>)):</span><br><span class="line">                            style <span class="string">&quot;slot_time_text&quot;</span></span><br><span class="line">                            size <span class="number">30</span></span><br><span class="line">                        </span><br><span class="line">                        frame:</span><br><span class="line">                            background <span class="literal">None</span></span><br><span class="line">                            xysize(<span class="number">210</span>,<span class="number">110</span>)</span><br><span class="line">                            xoffset <span class="number">230</span></span><br><span class="line">                            yoffset <span class="number">20</span></span><br><span class="line">                            <span class="comment">#存档描述</span></span><br><span class="line">                            text FileSaveName(slot):</span><br><span class="line">                                size <span class="number">25</span></span><br><span class="line">                    <span class="comment">#从标题界面进入读档界面无法获取_last_say_what,游戏会报错，因此将其删除</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">## 用于访问其他页面的按钮。</span></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;page&quot;</span></span><br><span class="line"></span><br><span class="line">            xalign <span class="number">0.8</span></span><br><span class="line">            yalign <span class="number">0.1</span></span><br><span class="line">            spacing <span class="number">20</span></span><br><span class="line">            <span class="keyword">if</span> config.has_autosave:</span><br><span class="line">                textbutton _(<span class="string">&quot;&#123;#auto_page&#125;A&quot;</span>) action FilePage(<span class="string">&quot;auto&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> config.has_quicksave:</span><br><span class="line">                textbutton _(<span class="string">&quot;&#123;#quick_page&#125;Q&quot;</span>) action FilePage(<span class="string">&quot;quick&quot;</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page1.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover1.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover1.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">1</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page2.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover2.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover2.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">2</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page3.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover3.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover3.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">3</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page4.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover4.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover4.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">4</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page5.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover5.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover5.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">5</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page6.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover6.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover6.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">6</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page7.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover7.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover7.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">7</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page8.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover8.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover8.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">8</span>)</span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/button/page9.png&quot;</span></span><br><span class="line">                hover <span class="string">&quot;gui/button/page_hover9.png&quot;</span></span><br><span class="line">                selected_idle <span class="string">&quot;gui/button/page_hover9.png&quot;</span></span><br><span class="line">                action FilePage(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.05</span>, <span class="number">0.95</span>)</span><br><span class="line">        text_color <span class="string">&quot;#000&quot;</span></span><br><span class="line">        text_size <span class="number">50</span></span><br><span class="line">        action Return()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style page_label <span class="keyword">is</span> gui_label</span><br><span class="line">style page_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line">style page_button <span class="keyword">is</span> gui_button</span><br><span class="line">style page_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line"></span><br><span class="line">style slot_button <span class="keyword">is</span> gui_button</span><br><span class="line">style slot_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line">style slot_time_text <span class="keyword">is</span> slot_button_text</span><br><span class="line">style slot_name_text <span class="keyword">is</span> slot_button_text</span><br><span class="line"></span><br><span class="line">style page_label:</span><br><span class="line">    xpadding <span class="number">75</span></span><br><span class="line">    ypadding <span class="number">5</span></span><br><span class="line"></span><br><span class="line">style page_label_text:</span><br><span class="line">    textalign <span class="number">0.5</span></span><br><span class="line">    layout <span class="string">&quot;subtitle&quot;</span></span><br><span class="line">    hover_color gui.hover_color</span><br><span class="line"></span><br><span class="line">style page_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;page_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style page_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;page_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slot_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;slot_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style slot_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;slot_button&quot;</span>)</span><br></pre></td></tr></table></figure></p><div class="note info modern"><p>由于我是将存档界面和读档界面分开编写的，所以这部分代码仅供参考，如果你想沿用源代码，请自行修改</p></div><h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><p>其实到上一步我们的自定义就已经差不多完成了，但我们还可以在完善一下</p><h2 id="存档编号"><a href="#存档编号" class="headerlink" title="存档编号"></a>存档编号</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#存档编号</span></span><br><span class="line">text <span class="string">&quot;NO.&quot;</span>+FileSlotName(slot, gui.file_slot_cols * gui.file_slot_rows):</span><br><span class="line">    align (<span class="number">1.0</span>, <span class="number">0.0</span>)</span><br><span class="line">    size <span class="number">30</span></span><br></pre></td></tr></table></figure><h2 id="最新存档标识"><a href="#最新存档标识" class="headerlink" title="最新存档标识"></a>最新存档标识</h2><p>添加如下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最新存档标识(只记录普通存档页)</span></span><br><span class="line"><span class="keyword">if</span> FileNewest(slot):</span><br><span class="line">    add <span class="string">&quot;gui/button/newest.png&quot;</span> align (<span class="number">0.75</span>, <span class="number">0.0</span>)</span><br></pre></td></tr></table></figure><div class="note info modern"><p>可添加一个transform组件，使最新存档标识连续闪烁</p></div><h2 id="删除存档按钮"><a href="#删除存档按钮" class="headerlink" title="删除存档按钮"></a>删除存档按钮</h2><p>源代码中使用键盘delete键删除存档并不具备标识度，我们将其改为更明显的图像按钮，代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除存档</span></span><br><span class="line">imagebutton:</span><br><span class="line">    xysize(<span class="number">120</span>,<span class="number">30</span>)</span><br><span class="line">    align((<span class="number">1.0</span>, <span class="number">1.0</span>))</span><br><span class="line">    idle <span class="string">&quot;gui/button/delate.png&quot;</span></span><br><span class="line">    hove<span class="string">r&quot;gui/button/delate_hover.png&quot;</span></span><br><span class="line">    action FileDelete(slot)</span><br></pre></td></tr></table></figure></p><h1 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h1><p>别忘了修改<code>gui.rpy</code>文件中220行左右如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 存档按钮 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 存档按钮是一种特殊的按钮。它包含一个缩略图和描述该存档内容的文本。存档使用</span></span><br><span class="line"><span class="comment">## gui/button 中的图像文件，就像其他类型的按钮一样。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档位按钮。</span></span><br><span class="line">define gui.slot_button_width = <span class="number">475</span></span><br><span class="line">define gui.slot_button_height = <span class="number">227</span></span><br><span class="line">define gui.slot_button_borders = Borders(<span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>)</span><br><span class="line">define gui.slot_button_text_size = <span class="number">21</span></span><br><span class="line">define gui.slot_button_text_xalign = <span class="number">0.5</span></span><br><span class="line">define gui.slot_button_text_idle_color = gui.idle_small_color</span><br><span class="line">define gui.slot_button_text_selected_idle_color = gui.selected_color</span><br><span class="line">define gui.slot_button_text_selected_hover_color = gui.hover_color</span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档所用缩略图的宽度和高度。</span></span><br><span class="line">define config.thumbnail_width = <span class="number">384</span></span><br><span class="line">define config.thumbnail_height = <span class="number">216</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档网格中的列数和行数。</span></span><br><span class="line">define gui.file_slot_cols = <span class="number">3</span></span><br><span class="line">define gui.file_slot_rows = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 定位和间距 #######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 这些变量控制各种用户界面元素的位置和间距。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 导航按钮左侧相对于屏幕左侧的位置。</span></span><br><span class="line">define gui.navigation_xpos = <span class="number">60</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 快进指示器的垂直位置。</span></span><br><span class="line">define gui.skip_ypos = <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 通知界面的垂直位置。</span></span><br><span class="line">define gui.notify_ypos = <span class="number">68</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 菜单选项之间的间距。</span></span><br><span class="line">define gui.choice_spacing = <span class="number">33</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 标题菜单和游戏菜单的导航部分中的按钮。</span></span><br><span class="line">define gui.navigation_spacing = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 控制设置项目之间的间隔量。</span></span><br><span class="line">define gui.pref_spacing = <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 控制设置按钮之间的间距。</span></span><br><span class="line">define gui.pref_button_spacing = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档页面按钮之间的间距。</span></span><br><span class="line">define gui.page_spacing = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 存档按钮之间的间距。</span></span><br><span class="line">define gui.slot_spacing = <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 标题菜单文本的位置。</span></span><br><span class="line">define gui.main_menu_text_xalign = <span class="number">1.0</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中存档读档界面的一些修改，包括添加存档描述，删除存档等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py自制插件</title>
    <link href="http://lucylcarus.github.io/posts/3447be97.html"/>
    <id>http://lucylcarus.github.io/posts/3447be97.html</id>
    <published>2024-10-25T07:31:00.000Z</published>
    <updated>2024-12-08T14:53:53.844Z</updated>
    
    <content type="html"><![CDATA[<h1 id="立绘动画效果"><a href="#立绘动画效果" class="headerlink" title="立绘动画效果"></a>立绘动画效果</h1><p>包含十余种通用动画效果和两种特殊动画效果</p><h1 id="素材"><a href="#素材" class="headerlink" title="素材"></a>素材</h1><h2 id="转场图像"><a href="#转场图像" class="headerlink" title="转场图像"></a>转场图像</h2><p>一些常用转场图像，请使用<code>ImageDissolve</code>为其定义</p><div class="note info modern"><p>图像基于<code>1920*1080</code>分辨率所制，如有需求，请修改为合适尺寸</p></div><h2 id="人物表情"><a href="#人物表情" class="headerlink" title="人物表情"></a>人物表情</h2><p>一些人物表情素材，使用 <code>show/hide</code> 进行 <code>展示/隐藏</code></p><h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><p>分为<code>可商用字体</code>和<strong><em><code>不可商用字体</code></em></strong></p><div class="note danger modern"><p>如想使用<strong><em>不可商用字体</em></strong>，请自行购买字体版权</p></div><h2 id="粒子"><a href="#粒子" class="headerlink" title="粒子"></a>粒子</h2><p>一些粒子素材，请搭配<code>SnowBlossom</code>使用</p><h2 id="图标"><a href="#图标" class="headerlink" title="图标"></a>图标</h2><p>一些图标素材，可自行修改、填充颜色</p><h2 id="帧动画"><a href="#帧动画" class="headerlink" title="帧动画"></a>帧动画</h2><p>一些帧动画素材，请参考<a href="https://www.renpy.org/wiki/renpy/doc/reference/functions/anim.Filmstrip">Ren’py Wiki文档</a>使用</p><h2 id="鼠标光标"><a href="#鼠标光标" class="headerlink" title="鼠标光标"></a>鼠标光标</h2><p>一些鼠标光标样式，分为常态，悬停和按下三种</p><h2 id="集中线"><a href="#集中线" class="headerlink" title="集中线"></a>集中线</h2><p>一些集中线图像，使用 <code>show/hide</code> 进行 <code>展示/隐藏</code></p><h2 id="精选BGM"><a href="#精选BGM" class="headerlink" title="精选BGM"></a>精选BGM</h2><p>精心挑选的免费BGM，已转换为<code>OGG</code>格式，可放心使用</p><div class="note info modern"><p>感谢<a href="https://www.sentive.net/">sentive</a>创作的免费公共素材</p></div><h2 id="音效"><a href="#音效" class="headerlink" title="音效"></a>音效</h2><p>一些较为常用音效，<code>OGG</code>格式与<code>WAV</code>格式均可使用</p><h1 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接"></a>下载链接</h1><p><a href="https://github.com/lucylcarus/Plug-ins/archive/refs/heads/master.zip">点我下载</a></p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中一些实用插件，不定期更新。</summary>
    
    
    
    <category term="插件" scheme="http://lucylcarus.github.io/categories/%E6%8F%92%E4%BB%B6/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py say界面修改</title>
    <link href="http://lucylcarus.github.io/posts/9312ffd8.html"/>
    <id>http://lucylcarus.github.io/posts/9312ffd8.html</id>
    <published>2024-10-20T12:14:39.000Z</published>
    <updated>2024-12-04T04:55:38.482Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文所有配置均位于<code>screns.rpy</code>文件中</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://doc.renpy.cn/zh-CN/screen_actions.html#tooltips">悬停提示</a></p><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1jpykYPEuW&cid=26444760861&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="底部菜单自定义"><a href="#底部菜单自定义" class="headerlink" title="底部菜单自定义"></a>底部菜单自定义</h1><p>打开<code>screens.rpy</code>文件，你会在228行左右看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 快捷菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 快捷菜单显示于游戏内，以便于访问游戏外的菜单。</span></span><br><span class="line"></span><br><span class="line">screen quick_menu():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 确保该菜单出现在其他屏幕之上，</span></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> quick_menu:</span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;quick&quot;</span></span><br><span class="line"></span><br><span class="line">            xalign <span class="number">0.5</span></span><br><span class="line">            yalign <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;回退&quot;</span>) action Rollback()</span><br><span class="line">            textbutton _(<span class="string">&quot;历史&quot;</span>) action ShowMenu(<span class="string">&#x27;history&#x27;</span>)</span><br><span class="line">            textbutton _(<span class="string">&quot;快进&quot;</span>) action Skip() alternate Skip(fast=<span class="literal">True</span>, confirm=<span class="literal">True</span>)</span><br><span class="line">            textbutton _(<span class="string">&quot;自动&quot;</span>) action Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">            textbutton _(<span class="string">&quot;保存&quot;</span>) action ShowMenu(<span class="string">&#x27;save&#x27;</span>)</span><br><span class="line">            textbutton _(<span class="string">&quot;快存&quot;</span>) action QuickSave()</span><br><span class="line">            textbutton _(<span class="string">&quot;快读&quot;</span>) action QuickLoad()</span><br><span class="line">            textbutton _(<span class="string">&quot;设置&quot;</span>) action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码确保只要用户没有主动隐藏界面，就会在游戏中显示 quick_menu 屏幕。</span></span><br><span class="line">init python:</span><br><span class="line">    config.overlay_screens.append(<span class="string">&quot;quick_menu&quot;</span>)</span><br><span class="line"></span><br><span class="line">default quick_menu = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style quick_button <span class="keyword">is</span> default</span><br><span class="line">style quick_button_text <span class="keyword">is</span> button_text</span><br><span class="line"></span><br><span class="line">style quick_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style quick_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>这里是游戏内的底部菜单，也可以称为快捷菜单，我们对该界面的修改基本只是将<code>textbutton</code>替换为<code>imagebutton</code>，<code>action</code>行为可以不用修改，下面给出示例代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 快捷菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 快捷菜单显示于游戏内，以便于访问游戏外的菜单。</span></span><br><span class="line"></span><br><span class="line">screen quick_menu():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 确保该菜单出现在其他屏幕之上，</span></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> quick_menu:</span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;quick&quot;</span></span><br><span class="line">            spacing <span class="number">50</span></span><br><span class="line">            xalign <span class="number">0.8</span></span><br><span class="line">            yalign <span class="number">1.0</span></span><br><span class="line">            <span class="comment">#存档按钮</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/save.png&quot;</span></span><br><span class="line">                <span class="comment">#可自行添加hover等属性</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;save&#x27;</span>)</span><br><span class="line">            <span class="comment">#读档按钮    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/load.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;load&#x27;</span>)</span><br><span class="line">            <span class="comment">#快速存档    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qsave.png&quot;</span></span><br><span class="line">                action QuickSave()</span><br><span class="line">            <span class="comment">#快速读档    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qload.png&quot;</span></span><br><span class="line">                action QuickLoad()</span><br><span class="line">            <span class="comment">#设置按钮    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                yoffset -<span class="number">5</span></span><br><span class="line">                idle <span class="string">&quot;gui/set.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line">            <span class="comment">#自动按钮</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/auto.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">            <span class="comment">#快进按钮    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/skip.png&quot;</span></span><br><span class="line">                action Skip() alternate Skip(fast=<span class="literal">False</span>, confirm=<span class="literal">True</span>)</span><br><span class="line">            <span class="comment">#历史按钮   </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/his.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;history&#x27;</span>)</span><br><span class="line">            <span class="comment">#隐藏对话框和底部菜单按钮    </span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/hide.png&quot;</span></span><br><span class="line">                action Call(<span class="string">&quot;_hide_windows&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码确保只要用户没有主动隐藏界面，就会在游戏中显示 quick_menu 屏幕。</span></span><br><span class="line">init python:</span><br><span class="line">    config.overlay_screens.append(<span class="string">&quot;quick_menu&quot;</span>)</span><br><span class="line"></span><br><span class="line">default quick_menu = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style quick_button <span class="keyword">is</span> default</span><br><span class="line">style quick_button_text <span class="keyword">is</span> button_text</span><br><span class="line"></span><br><span class="line">style quick_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style quick_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line">                </span><br></pre></td></tr></table></figure><br>相比于源代码，我们添加了隐藏对话框和底部菜单的按钮，删除了用处不大的回退功能，并优化了底部菜单的位置和间距等属性</p><h1 id="底部菜单优化"><a href="#底部菜单优化" class="headerlink" title="底部菜单优化"></a>底部菜单优化</h1><h2 id="悬停提示"><a href="#悬停提示" class="headerlink" title="悬停提示"></a>悬停提示</h2><p>其实到上一步我们的自定义就已经做的差不多了，但我们还可以做一些悬停提示的优化，使用<code>tooltip</code>我们可以很轻松地达到该效果，示例代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 快捷菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 快捷菜单显示于游戏内，以便于访问游戏外的菜单。</span></span><br><span class="line"></span><br><span class="line">screen quick_menu():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 确保该菜单出现在其他屏幕之上，</span></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> quick_menu:</span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;quick&quot;</span></span><br><span class="line">            spacing <span class="number">50</span></span><br><span class="line">            xalign <span class="number">0.8</span></span><br><span class="line">            yalign <span class="number">1.0</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/save.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;save&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;存档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/load.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;load&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;读档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qsave.png&quot;</span></span><br><span class="line">                action QuickSave()</span><br><span class="line">                tooltip <span class="string">&quot;快速存档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qload.png&quot;</span></span><br><span class="line">                action QuickLoad()</span><br><span class="line">                tooltip <span class="string">&quot;快速读档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                yoffset -<span class="number">5</span></span><br><span class="line">                idle <span class="string">&quot;gui/set.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;设置&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/auto.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;自动&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/skip.png&quot;</span></span><br><span class="line">                action Skip() alternate Skip(fast=<span class="literal">False</span>, confirm=<span class="literal">True</span>)</span><br><span class="line">                tooltip <span class="string">&quot;快进&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/his.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;history&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;回顾&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/hide.png&quot;</span></span><br><span class="line">                action Call(<span class="string">&quot;_hide_windows&quot;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;隐藏对话框&quot;</span></span><br><span class="line"></span><br><span class="line">            $ tooltip = GetTooltip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> tooltip:</span><br><span class="line"></span><br><span class="line">        nearrect:</span><br><span class="line">            focus <span class="string">&quot;tooltip&quot;</span></span><br><span class="line">            prefer_top <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">            frame:</span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                text tooltip</span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码确保只要用户没有主动隐藏界面，就会在游戏中显示 quick_menu 屏幕。</span></span><br><span class="line">init python:</span><br><span class="line">    config.overlay_screens.append(<span class="string">&quot;quick_menu&quot;</span>)</span><br><span class="line"></span><br><span class="line">default quick_menu = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style quick_button <span class="keyword">is</span> default</span><br><span class="line">style quick_button_text <span class="keyword">is</span> button_text</span><br><span class="line"></span><br><span class="line">style quick_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style quick_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br></pre></td></tr></table></figure></p><h2 id="美化-amp-动画"><a href="#美化-amp-动画" class="headerlink" title="美化&amp;动画"></a>美化&amp;动画</h2><p>虽然最后呈现的效果是不错，但默认效果还是有点太过单调，同时，快进按钮没有区分可用/不可用状态，我们稍微修改一下代码，优化一下表现效果，代码示例如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 快捷菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 快捷菜单显示于游戏内，以便于访问游戏外的菜单。</span></span><br><span class="line"></span><br><span class="line">screen quick_menu():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 确保该菜单出现在其他屏幕之上，</span></span><br><span class="line">    zorder <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> quick_menu:</span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            style_prefix <span class="string">&quot;quick&quot;</span></span><br><span class="line">            spacing <span class="number">50</span></span><br><span class="line">            xalign <span class="number">0.8</span></span><br><span class="line">            yalign <span class="number">1.0</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/save.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;save&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;存档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/load.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;load&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;读档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qsave.png&quot;</span></span><br><span class="line">                action QuickSave()</span><br><span class="line">                tooltip <span class="string">&quot;快速存档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/qload.png&quot;</span></span><br><span class="line">                action QuickLoad()</span><br><span class="line">                tooltip <span class="string">&quot;快速读档&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                yoffset -<span class="number">5</span></span><br><span class="line">                idle <span class="string">&quot;gui/set.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;preferences&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;设置&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/auto.png&quot;</span></span><br><span class="line">                action Preference(<span class="string">&quot;auto-forward&quot;</span>, <span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;自动&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/skip.png&quot;</span></span><br><span class="line">                insensitive <span class="string">&quot;gui/skip_off.png&quot;</span><span class="comment">#修改图像，将其不透明度改为50%</span></span><br><span class="line">                action Skip() alternate Skip(fast=<span class="literal">False</span>, confirm=<span class="literal">True</span>)</span><br><span class="line">                tooltip <span class="string">&quot;快进&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/his.png&quot;</span></span><br><span class="line">                action ShowMenu(<span class="string">&#x27;history&#x27;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;回顾&quot;</span></span><br><span class="line">            imagebutton:</span><br><span class="line">                idle <span class="string">&quot;gui/hide.png&quot;</span></span><br><span class="line">                action Call(<span class="string">&quot;_hide_windows&quot;</span>)</span><br><span class="line">                tooltip <span class="string">&quot;隐藏对话框&quot;</span></span><br><span class="line"></span><br><span class="line">            $ tooltip = GetTooltip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> tooltip:</span><br><span class="line"></span><br><span class="line">        nearrect:</span><br><span class="line">            focus <span class="string">&quot;tooltip&quot;</span></span><br><span class="line">            prefer_top <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">            frame:</span><br><span class="line">                background <span class="literal">None</span></span><br><span class="line">                xalign <span class="number">0.5</span></span><br><span class="line">                text tooltip at tip size <span class="number">25</span> color <span class="string">&quot;#fff&quot;</span> outlines [(<span class="number">2</span>,<span class="string">&quot;#35ceff&quot;</span>,<span class="number">0</span>,<span class="number">0</span>)] </span><br><span class="line">            </span><br><span class="line">transform tip:</span><br><span class="line">    yoffset <span class="number">10</span></span><br><span class="line">    alpha <span class="number">0.0</span></span><br><span class="line">    parallel:</span><br><span class="line">        easein <span class="number">0.5</span> yoffset <span class="number">5</span></span><br><span class="line">    parallel:</span><br><span class="line">        easein <span class="number">0.5</span> alpha <span class="number">1.0</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">## 此代码确保只要用户没有主动隐藏界面，就会在游戏中显示 quick_menu 屏幕。</span></span><br><span class="line">init python:</span><br><span class="line">    config.overlay_screens.append(<span class="string">&quot;quick_menu&quot;</span>)</span><br><span class="line"></span><br><span class="line">default quick_menu = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style quick_button <span class="keyword">is</span> default</span><br><span class="line">style quick_button_text <span class="keyword">is</span> button_text</span><br><span class="line"></span><br><span class="line">style quick_button:</span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style quick_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;quick_button&quot;</span>)</span><br></pre></td></tr></table></figure></p><h1 id="对话框-textbox-和姓名框-namebox"><a href="#对话框-textbox-和姓名框-namebox" class="headerlink" title="对话框(textbox)和姓名框(namebox)"></a>对话框(textbox)和姓名框(namebox)</h1><p>打开<code>gui</code>文件夹，我们可以在这里看到对话框<code>textbox</code>和姓名框<code>namebox</code>两张图像，建议先拷贝一份留作备用，将我们的素材导入该文件夹进行同名替换即可</p><h2 id="问题1-对话框尺寸不合适"><a href="#问题1-对话框尺寸不合适" class="headerlink" title="问题1: 对话框尺寸不合适"></a>问题1: 对话框尺寸不合适</h2><p>解答：请鼠标右击-&gt;属性，修改对话框分辨率，建议与原对话框尺寸保持一致</p><h2 id="问题2-姓名框表现效果不佳"><a href="#问题2-姓名框表现效果不佳" class="headerlink" title="问题2: 姓名框表现效果不佳"></a>问题2: 姓名框表现效果不佳</h2><p>解答: 修改<code>namebox</code>的样式和<code>text</code>显示位置</p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>以我的代码为例，你可以在<code>screens.rpy</code>文件的85行左右看到相关代码，修改后代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"><span class="comment">## 游戏内屏幕</span></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 对话屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 对话屏幕用于向用户显示对话。它需要两个参数，who 和 what，分别是叙述角色的名字</span></span><br><span class="line"><span class="comment">## 和所叙述的文本。（如果没有名字，参数 who 可以是 None。）</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 此屏幕必须创建一个 id 为 what 的文本可视控件，因为 Ren&#x27;Py 使用它来管理文本显</span></span><br><span class="line"><span class="comment">## 示。它还可以创建 id 为 who 和 id 为 window 的可视控件来应用样式属性。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://www.renpy.cn/doc/screen_special.html#say</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">screen say(who, what):</span><br><span class="line">    style_prefix <span class="string">&quot;say&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    window:</span><br><span class="line">        <span class="built_in">id</span> <span class="string">&quot;window&quot;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> who <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line"></span><br><span class="line">            window:</span><br><span class="line">                <span class="built_in">id</span> <span class="string">&quot;namebox&quot;</span></span><br><span class="line">                style <span class="string">&quot;namebox&quot;</span></span><br><span class="line">                text who <span class="built_in">id</span> <span class="string">&quot;who&quot;</span> xoffset <span class="number">45</span> yoffset -<span class="number">8</span> </span><br><span class="line">                <span class="comment">#由于角色名字会从namebox的左上角展示，为让其适应namebox的表现效果，对文字进行位置调整</span></span><br><span class="line">        </span><br><span class="line">        text what <span class="built_in">id</span> <span class="string">&quot;what&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">## 如果有对话框头像，会将其显示在文本之上。请不要在手机界面下显示这个，因为</span></span><br><span class="line">    <span class="comment">## 没有空间。</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> renpy.variant(<span class="string">&quot;small&quot;</span>):</span><br><span class="line">        add SideImage() xalign <span class="number">0.0</span> yalign <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 通过 Character 对象使名称框可用于样式化。</span></span><br><span class="line">init python:</span><br><span class="line">    config.character_id_prefixes.append(<span class="string">&#x27;namebox&#x27;</span>)</span><br><span class="line"></span><br><span class="line">style window <span class="keyword">is</span> default</span><br><span class="line">style say_label <span class="keyword">is</span> default</span><br><span class="line">style say_dialogue <span class="keyword">is</span> default</span><br><span class="line">style say_thought <span class="keyword">is</span> say_dialogue</span><br><span class="line"></span><br><span class="line">style namebox <span class="keyword">is</span> default</span><br><span class="line">style namebox_label <span class="keyword">is</span> say_label</span><br><span class="line"></span><br><span class="line"><span class="comment">#对话框样式</span></span><br><span class="line">style window:</span><br><span class="line">    xalign <span class="number">0.5</span></span><br><span class="line">    xfill <span class="literal">True</span></span><br><span class="line">    yalign gui.textbox_yalign</span><br><span class="line">    ysize gui.textbox_height</span><br><span class="line"></span><br><span class="line">    background Image(<span class="string">&quot;gui/textbox.png&quot;</span>, xalign=<span class="number">0.5</span>, yalign=<span class="number">1.0</span>)</span><br><span class="line"><span class="comment">#姓名框样式</span></span><br><span class="line"><span class="comment">#由于namebox的pos被占用，我们使用offest来调整namebox的位置，同时将namebox的size改为固定，防止其自适应角色名字长短变化</span></span><br><span class="line">style namebox:</span><br><span class="line">    xpos gui.name_xpos</span><br><span class="line">    xanchor gui.name_xalign</span><br><span class="line">    xsize <span class="number">238</span></span><br><span class="line">    ypos gui.name_ypos</span><br><span class="line">    yoffset -<span class="number">60</span></span><br><span class="line">    ysize <span class="number">72</span></span><br><span class="line"></span><br><span class="line">    background Frame(<span class="string">&quot;gui/namebox.png&quot;</span>, gui.namebox_borders, tile=gui.namebox_tile, xalign=gui.name_xalign)</span><br><span class="line">    padding gui.namebox_borders.padding</span><br><span class="line"></span><br><span class="line">style say_label:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;name&quot;</span>, accent=<span class="literal">True</span>)</span><br><span class="line">    xalign gui.name_xalign</span><br><span class="line">    yalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">style say_dialogue:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;dialogue&quot;</span>)</span><br><span class="line"></span><br><span class="line">    xpos gui.dialogue_xpos</span><br><span class="line">    xsize gui.dialogue_width</span><br><span class="line">    ypos gui.dialogue_ypos</span><br><span class="line"></span><br><span class="line">    adjust_spacing <span class="literal">False</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中底部菜单和对话框的一些修改，包括样式修改，添加动画等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>MySQL语法使用(三)</title>
    <link href="http://lucylcarus.github.io/posts/4921db1e.html"/>
    <id>http://lucylcarus.github.io/posts/4921db1e.html</id>
    <published>2024-10-16T08:27:09.000Z</published>
    <updated>2024-12-04T04:55:28.232Z</updated>
    
    <content type="html"><![CDATA[<h1 id="单关系数据查询"><a href="#单关系数据查询" class="headerlink" title="单关系数据查询"></a>单关系数据查询</h1><h2 id="单关系数据查询结构"><a href="#单关系数据查询结构" class="headerlink" title="单关系数据查询结构"></a>单关系数据查询结构</h2><p>数据查询是数据库中最常用的操作。SQL提供<code>SELECT</code>语句，用户通过查询操作可得到所需的信息<br>关系表的<code>SELECT</code>语句一般语法如下<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>] <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">AS</span> 别名] [&#123;,<span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">AS</span> 别名]&#125;]</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span> [[<span class="keyword">AS</span>] 表别名]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>检索条件<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">HAVING</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>]]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]]</span><br><span class="line">[LIMIT子句]</span><br></pre></td></tr></table></figure><br><code>SELECT</code>子句从列的角度进行投影操作，指定要在查询结果中显示的字段名。用户也可以用关键字<code>AS</code>为字段名指定别名<br>关键字<code>ALL</code>表示所有元组，关键字<code>DISTINCT</code>表示消除查询结果中的重复元组<br><code>FROM</code>子句指定要查询的表明或视图名，如果有多个，应用逗号隔开<br><code>WHERE</code>子句从行的角度进行选取操作，只有满足条件的元组才会出现在查询结果中<br><code>GROUP BY</code>子句将查询结果按照其后的<code>&lt;字段名&gt;</code>的值进行分组<br><code>HAVING</code>子句不能单据存在，必须跟在<code>GROUP BY</code>子句后面<br><code>ORDER BY</code>子句用于对查询结果进行排序，<code>ASC</code>为升序，<code>DESC</code>为降序<br><code>LIMIT</code>子句限制查询结果行数</p><h2 id="无条件查询"><a href="#无条件查询" class="headerlink" title="无条件查询"></a>无条件查询</h2><p>无条件查询只包含<code>SELECT……FROM……</code>语句</p><h3 id="查询表中指定字段名"><a href="#查询表中指定字段名" class="headerlink" title="查询表中指定字段名"></a>查询表中指定字段名</h3><blockquote><p>例:查询student表中学生姓名<br>SELECT sname AS 学生姓名<br>FROM student;</p></blockquote><h3 id="查询表中全部字段名"><a href="#查询表中全部字段名" class="headerlink" title="查询表中全部字段名"></a>查询表中全部字段名</h3><blockquote><p>例:查询student表中全部字段名<br>SELECT *<br>FROM student;</p></blockquote><h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><p>条件查询需要用到<code>WHERE</code>子句指定查询条件<br>查询条件中，字段名与字段名之间，或字段名与常数之间，通常使用比较运算符连接<br>常用比较运算符如下</p><div class="table-container"><table><thead><tr><th>运算符</th><th>含义</th></tr></thead><tbody><tr><td>=、&gt;、&lt;、&gt;=、&lt;=、!=、&lt;&gt;</td><td>比较大小</td></tr><tr><td>AND、OR、NOT</td><td>多重条件</td></tr><tr><td>BETWEEN AND、NOT BETWEEN AND</td><td>确定范围</td></tr><tr><td>IN、NOT IN</td><td>确定集合</td></tr><tr><td>LIKE、NOT LIKE</td><td>字符匹配</td></tr><tr><td>IS NULL、IS NOT NULL</td><td>空值</td></tr></tbody></table></div><div class="note info modern"><p>比较大小中<code>!=</code>和<code>&lt;&gt;</code>表示不等于<br>多重条件中，<code>AND</code>可表示为<code>&amp;&amp;</code>，<code>OR</code>可表示为<code>||</code>，<code>NOT</code>可表示为<code>!</code></p></div><h3 id="比较大小"><a href="#比较大小" class="headerlink" title="比较大小"></a>比较大小</h3><blockquote><p>例:查询student表中已成年学生<br>SELECT *<br>FROM student<br>WHERE age&gt;=18;</p></blockquote><h3 id="多重条件"><a href="#多重条件" class="headerlink" title="多重条件"></a>多重条件</h3><blockquote><p>例:查询student表中已成年且性别为女的学生<br>SELECT *<br>FROM student<br>WHERE age&gt;=18 AND sex=”女”;</p></blockquote><h3 id="确定范围"><a href="#确定范围" class="headerlink" title="确定范围"></a>确定范围</h3><blockquote><p>例:查询student表中年龄段在18-20的学生<br>SELECT *<br>FROM student<br>WHERE age EBETWEEN 18 AND 20;</p></blockquote><h3 id="确定集合"><a href="#确定集合" class="headerlink" title="确定集合"></a>确定集合</h3><blockquote><p>例:查询student表中所学专业为计算机的学生<br>SELECT *<br>FROM student<br>WHERE major=”计算机”;</p></blockquote><h3 id="字符匹配"><a href="#字符匹配" class="headerlink" title="字符匹配"></a>字符匹配</h3><p>利用通配符，可以进行模糊查询<br>常用通配符如下</p><div class="table-container"><table><thead><tr><th>通配符</th><th>功能</th></tr></thead><tbody><tr><td>%</td><td>代表0个或多个字符</td></tr><tr><td>_</td><td>代表一个字符</td></tr><tr><td>[ ]</td><td>表示在某一范围的字符</td></tr><tr><td>[^]</td><td>表示不在某一范围的字符</td></tr></tbody></table></div><blockquote><p>例:查询student表中学号带有数字7的学生<br>SELECT *<br>FROM student<br>WHERE sno LIKE “%7%”;</p></blockquote><h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><blockquote><p>例:查询student表中未选定专业的学生<br>SELECT *<br>FROM student<br>WHERE major IS NULL;</p></blockquote><h2 id="聚合函数查询"><a href="#聚合函数查询" class="headerlink" title="聚合函数查询"></a>聚合函数查询</h2><p>SQL提供了许多使用的聚合函数，常用聚合函数如下</p><div class="table-container"><table><thead><tr><th>函数名称</th><th>功能</th></tr></thead><tbody><tr><td>AVG</td><td>按列计算平均值</td></tr><tr><td>SUM</td><td>按列计算值的总和</td></tr><tr><td>MAX</td><td>求一列中的最大值</td></tr><tr><td>MIN</td><td>求一列中的最小值</td></tr><tr><td>COUNT</td><td>按列值统计个数</td></tr></tbody></table></div><blockquote><p>例:查询student表中年龄最小的学生<br>SELECT MIN(age)<br>FROM student;</p></blockquote><h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><blockquote><p>例:查询student表中已成年的学生，按性别分组<br>SELECT *<br>FROM student<br>WHERE age&gt;=18<br>GROUP BY sex;</p></blockquote><h2 id="查询结果排序"><a href="#查询结果排序" class="headerlink" title="查询结果排序"></a>查询结果排序</h2><blockquote><p>例:查询student表中已成年的学生，按年龄大小降序排列<br>SELECT *<br>FROM student<br>WHERE age&gt;=18<br>ORDER BY age DESC;</p></blockquote><h2 id="限制查询结果数量"><a href="#限制查询结果数量" class="headerlink" title="限制查询结果数量"></a>限制查询结果数量</h2><blockquote><p>例:查询student表中已成年的学生，按年龄大小降序排列，只显示前三人<br>SELECT *<br>FROM student<br>WHERE age&gt;=18<br>ORDER BY age DESC<br>LIMIT 3;</p></blockquote>]]></content>
    
    
    <summary type="html">MySQL是最流行的关系型数据库管理系统，在WEB应用方面MySQL是最好的关系数据库管理系统应用软件之一。</summary>
    
    
    
    <category term="数据库" scheme="http://lucylcarus.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="http://lucylcarus.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 标题菜单界面</title>
    <link href="http://lucylcarus.github.io/posts/e6e80026.html"/>
    <id>http://lucylcarus.github.io/posts/e6e80026.html</id>
    <published>2024-10-13T12:14:39.000Z</published>
    <updated>2024-12-04T04:55:48.502Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文主要修改的文件为<code>screens.rpy</code>，次要修改文件为<code>gui.rpy</code>以及<code>script.rpy</code></strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://zhuanlan.zhihu.com/p/346838182">被诅咒的章鱼大佬的Ren’py教程</a></p><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1QryAYmE6C&cid=26326863249&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="背景图修改"><a href="#背景图修改" class="headerlink" title="背景图修改"></a>背景图修改</h1><p>打开<code>gui.rpy</code>，在86行左右可以看到标题菜单界面，代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 标题和游戏菜单 #####################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 标题菜单和游戏菜单使用的图像。</span></span><br><span class="line">define gui.main_menu_background = <span class="string">&quot;gui/main_menu.png&quot;</span></span><br><span class="line">define gui.game_menu_background = <span class="string">&quot;gui/game_menu.png&quot;</span></span><br></pre></td></tr></table></figure><br>打开<code>screens.rpy</code>,在335行左右可以看到如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 标题菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 用于在 Ren&#x27;Py 启动时显示标题菜单。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## https://www.renpy.cn/doc/screen_special.html#main-menu</span></span><br><span class="line"></span><br><span class="line">screen main_menu():</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 此语句可确保替换掉任何其他菜单屏幕。</span></span><br><span class="line">    tag menu</span><br><span class="line"></span><br><span class="line">    add gui.main_menu_background</span><br><span class="line"></span><br><span class="line">    <span class="comment">## 此空框可使标题菜单变暗。</span></span><br><span class="line">    frame:</span><br><span class="line">        style <span class="string">&quot;main_menu_frame&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## use 语句将其他的屏幕包含进此屏幕。标题屏幕的实际内容在导航屏幕中。</span></span><br><span class="line">    use navigation</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gui.show_name:</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            style <span class="string">&quot;main_menu_vbox&quot;</span></span><br><span class="line"></span><br><span class="line">            text <span class="string">&quot;[config.name!t]&quot;</span>:</span><br><span class="line">                style <span class="string">&quot;main_menu_title&quot;</span></span><br><span class="line"></span><br><span class="line">            text <span class="string">&quot;[config.version]&quot;</span>:</span><br><span class="line">                style <span class="string">&quot;main_menu_version&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style main_menu_frame <span class="keyword">is</span> empty</span><br><span class="line">style main_menu_vbox <span class="keyword">is</span> vbox</span><br><span class="line">style main_menu_text <span class="keyword">is</span> gui_text</span><br><span class="line">style main_menu_title <span class="keyword">is</span> main_menu_text</span><br><span class="line">style main_menu_version <span class="keyword">is</span> main_menu_text</span><br><span class="line"></span><br><span class="line">style main_menu_frame:</span><br><span class="line">    xsize <span class="number">420</span></span><br><span class="line">    yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    background <span class="string">&quot;gui/overlay/main_menu.png&quot;</span></span><br><span class="line"></span><br><span class="line">style main_menu_vbox:</span><br><span class="line">    xalign <span class="number">1.0</span></span><br><span class="line">    xoffset -<span class="number">30</span></span><br><span class="line">    xmaximum <span class="number">1200</span></span><br><span class="line">    yalign <span class="number">1.0</span></span><br><span class="line">    yoffset -<span class="number">30</span></span><br><span class="line"></span><br><span class="line">style main_menu_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;main_menu&quot;</span>, accent=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">style main_menu_title:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;title&quot;</span>)</span><br><span class="line"></span><br><span class="line">style main_menu_version:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;version&quot;</span>)</span><br></pre></td></tr></table></figure><br>另外在<code>screens.rpy</code>文件中,在396行左右可以看到游戏菜单界面，代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 游戏菜单屏幕 ######################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 此屏幕列出了游戏菜单的基本共同结构。可使用屏幕标题调用，并显示背景、标题和导</span></span><br><span class="line"><span class="comment">## 航菜单。</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## scroll 参数可以是 None，也可以是 viewport 或 vpgrid。此屏幕旨在与一个或多个子</span></span><br><span class="line"><span class="comment">## 屏幕同时使用，这些子屏幕将被嵌入（放置）在其中。</span></span><br><span class="line"></span><br><span class="line">screen game_menu(title, scroll=<span class="literal">None</span>, yinitial=<span class="number">0.0</span>, spacing=<span class="number">0</span>):</span><br><span class="line"></span><br><span class="line">    style_prefix <span class="string">&quot;game_menu&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> main_menu:</span><br><span class="line">        add gui.main_menu_background</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        add gui.game_menu_background</span><br><span class="line"></span><br><span class="line">    frame:</span><br><span class="line">        style <span class="string">&quot;game_menu_outer_frame&quot;</span></span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line"></span><br><span class="line">            <span class="comment">## 导航部分的预留空间。</span></span><br><span class="line">            frame:</span><br><span class="line">                style <span class="string">&quot;game_menu_navigation_frame&quot;</span></span><br><span class="line"></span><br><span class="line">            frame:</span><br><span class="line">                style <span class="string">&quot;game_menu_content_frame&quot;</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> scroll == <span class="string">&quot;viewport&quot;</span>:</span><br><span class="line"></span><br><span class="line">                    viewport:</span><br><span class="line">                        yinitial yinitial</span><br><span class="line">                        scrollbars <span class="string">&quot;vertical&quot;</span></span><br><span class="line">                        mousewheel <span class="literal">True</span></span><br><span class="line">                        draggable <span class="literal">True</span></span><br><span class="line">                        pagekeys <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                        side_yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                        vbox:</span><br><span class="line">                            spacing spacing</span><br><span class="line"></span><br><span class="line">                            transclude</span><br><span class="line"></span><br><span class="line">                <span class="keyword">elif</span> scroll == <span class="string">&quot;vpgrid&quot;</span>:</span><br><span class="line"></span><br><span class="line">                    vpgrid:</span><br><span class="line">                        cols <span class="number">1</span></span><br><span class="line">                        yinitial yinitial</span><br><span class="line"></span><br><span class="line">                        scrollbars <span class="string">&quot;vertical&quot;</span></span><br><span class="line">                        mousewheel <span class="literal">True</span></span><br><span class="line">                        draggable <span class="literal">True</span></span><br><span class="line">                        pagekeys <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                        side_yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                        spacing spacing</span><br><span class="line"></span><br><span class="line">                        transclude</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">                    transclude</span><br><span class="line"></span><br><span class="line">    use navigation</span><br><span class="line"></span><br><span class="line">    textbutton _(<span class="string">&quot;返回&quot;</span>):</span><br><span class="line">        style <span class="string">&quot;return_button&quot;</span></span><br><span class="line"></span><br><span class="line">        action Return()</span><br><span class="line"></span><br><span class="line">    label title</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> main_menu:</span><br><span class="line">        key <span class="string">&quot;game_menu&quot;</span> action ShowMenu(<span class="string">&quot;main_menu&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style game_menu_outer_frame <span class="keyword">is</span> empty</span><br><span class="line">style game_menu_navigation_frame <span class="keyword">is</span> empty</span><br><span class="line">style game_menu_content_frame <span class="keyword">is</span> empty</span><br><span class="line">style game_menu_viewport <span class="keyword">is</span> gui_viewport</span><br><span class="line">style game_menu_side <span class="keyword">is</span> gui_side</span><br><span class="line">style game_menu_scrollbar <span class="keyword">is</span> gui_vscrollbar</span><br><span class="line"></span><br><span class="line">style game_menu_label <span class="keyword">is</span> gui_label</span><br><span class="line">style game_menu_label_text <span class="keyword">is</span> gui_label_text</span><br><span class="line"></span><br><span class="line">style return_button <span class="keyword">is</span> navigation_button</span><br><span class="line">style return_button_text <span class="keyword">is</span> navigation_button_text</span><br><span class="line"></span><br><span class="line">style game_menu_outer_frame:</span><br><span class="line">    bottom_padding <span class="number">45</span></span><br><span class="line">    top_padding <span class="number">180</span></span><br><span class="line"></span><br><span class="line">    background <span class="string">&quot;gui/overlay/game_menu.png&quot;</span></span><br><span class="line"></span><br><span class="line">style game_menu_navigation_frame:</span><br><span class="line">    xsize <span class="number">420</span></span><br><span class="line">    yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">style game_menu_content_frame:</span><br><span class="line">    left_margin <span class="number">60</span></span><br><span class="line">    right_margin <span class="number">30</span></span><br><span class="line">    top_margin <span class="number">15</span></span><br><span class="line"></span><br><span class="line">style game_menu_viewport:</span><br><span class="line">    xsize <span class="number">1380</span></span><br><span class="line"></span><br><span class="line">style game_menu_vscrollbar:</span><br><span class="line">    unscrollable gui.unscrollable</span><br><span class="line"></span><br><span class="line">style game_menu_side:</span><br><span class="line">    spacing <span class="number">15</span></span><br><span class="line"></span><br><span class="line">style game_menu_label:</span><br><span class="line">    xpos <span class="number">75</span></span><br><span class="line">    ysize <span class="number">180</span></span><br><span class="line"></span><br><span class="line">style game_menu_label_text:</span><br><span class="line">    size gui.title_text_size</span><br><span class="line">    color gui.accent_color</span><br><span class="line">    yalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">style return_button:</span><br><span class="line">    xpos gui.navigation_xpos</span><br><span class="line">    yalign <span class="number">1.0</span></span><br><span class="line">    yoffset -<span class="number">45</span></span><br></pre></td></tr></table></figure></p><div class="note info modern"><p><code>screens.rpy</code>文件中，<code>style</code>的部分为样式，一般情况下我们不需要修改，如需修改，会特别指示</p></div><p>对比两个文件，我们可以发现<code>gui.rpy</code>文件中的两句代码对应<code>screens.rpy</code>文件中如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#标题菜单界面</span></span><br><span class="line">add gui.main_menu_background</span><br><span class="line"><span class="comment">#游戏菜单界面</span></span><br><span class="line"><span class="keyword">if</span> main_menu:</span><br><span class="line">        add gui.main_menu_background</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        add gui.game_menu_background</span><br></pre></td></tr></table></figure><br>由此我们可以了解到，<code>define gui.main_menu_background = &quot;gui/main_menu.png&quot;</code>为标题界面背景，<code>define gui.game_menu_background = &quot;gui/game_menu.png&quot;</code>为游戏菜单背景，不过，在游戏菜单界面中，还加了当前界面的判断语句，如果是标题菜单界面就展示标题菜单背景，否则就展示游戏菜单界面</p><div class="note warning modern"><p>一般情况下，我们会为各个界面设定单独的背景图，所以游戏菜单界面功能用处不大，当然，如果想设定一致背景图，该功能还是很方便的</p></div><p>我们打开其所对应的文件夹，可以看到两张图片是一样的<br><img src="https://www.helloimg.com/i/2024/11/19/673c17d82b89c.png" alt=""><br>修改代码指向文件，如下所示<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define gui.main_menu_background = <span class="string">&quot;gui/main.png&quot;</span></span><br><span class="line"></span><br><span class="line">define gui.game_menu_background = <span class="string">&quot;gui/game.png&quot;</span></span><br></pre></td></tr></table></figure><br><img src="https://www.helloimg.com/i/2024/11/19/673c182b3fed5.png" alt=""><br>运行游戏，可以发现背景图已经更换<br><img src="https://www.helloimg.com/i/2024/11/19/673c19e13d8b3.png" alt=""><br>但我们可以发现，游戏的侧边栏会遮挡部分背景图，让视觉体验大打折扣，这时我们继续查看<code>screens.rpy</code>文件中有关标题菜单界面的代码，可以发现在该样式中，额外添加了<code>background</code>属性<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">style main_menu_frame:</span><br><span class="line">    xsize <span class="number">420</span></span><br><span class="line">    yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    background <span class="string">&quot;gui/overlay/main_menu.png&quot;</span></span><br></pre></td></tr></table></figure><br>我们打开其所指定文件夹，即可发现问题所在<br><img src="https://www.helloimg.com/i/2024/11/19/673c1a1fc8f0d.png" alt=""><br>将该样式中的<code>background</code>属性改为<code>None</code>或直接删除该行代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">style main_menu_frame:</span><br><span class="line">    xsize <span class="number">420</span></span><br><span class="line">    yfill <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    background <span class="literal">None</span></span><br><span class="line"><span class="comment">######或改成如下样式</span></span><br><span class="line">style main_menu_frame:</span><br><span class="line">    xsize <span class="number">420</span></span><br><span class="line">    yfill <span class="literal">True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>再次运行游戏，即可发现侧边栏消失了</p><p><img src="https://www.helloimg.com/i/2024/11/19/673c7a2bbec0a.png" alt=""></p><h1 id="按钮按键修改"><a href="#按钮按键修改" class="headerlink" title="按钮按键修改"></a>按钮按键修改</h1><p>该部分比较简单，如果想轻松点可以直接修改<code>screens.rpy</code>文件中280行左右代码，也就是navigation，导航菜单界面，代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 导航屏幕 ########################################################################</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 该屏幕包含在标题菜单和游戏菜单中，并提供导航到其他菜单，以及启动游戏。</span></span><br><span class="line"></span><br><span class="line">screen navigation():</span><br><span class="line"></span><br><span class="line">    vbox:</span><br><span class="line">        style_prefix <span class="string">&quot;navigation&quot;</span></span><br><span class="line"></span><br><span class="line">        xpos gui.navigation_xpos</span><br><span class="line">        yalign <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">        spacing gui.navigation_spacing</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> main_menu:</span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;开始游戏&quot;</span>) action Start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;历史&quot;</span>) action ShowMenu(<span class="string">&quot;history&quot;</span>)</span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;保存&quot;</span>) action ShowMenu(<span class="string">&quot;save&quot;</span>)</span><br><span class="line"></span><br><span class="line">        textbutton _(<span class="string">&quot;读取游戏&quot;</span>) action ShowMenu(<span class="string">&quot;load&quot;</span>)</span><br><span class="line"></span><br><span class="line">        textbutton _(<span class="string">&quot;设置&quot;</span>) action ShowMenu(<span class="string">&quot;preferences&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _in_replay:</span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;结束回放&quot;</span>) action EndReplay(confirm=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> main_menu:</span><br><span class="line"></span><br><span class="line">            textbutton _(<span class="string">&quot;标题菜单&quot;</span>) action MainMenu()</span><br><span class="line"></span><br><span class="line">        textbutton _(<span class="string">&quot;关于&quot;</span>) action ShowMenu(<span class="string">&quot;about&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.variant(<span class="string">&quot;pc&quot;</span>) <span class="keyword">or</span> (renpy.variant(<span class="string">&quot;web&quot;</span>) <span class="keyword">and</span> <span class="keyword">not</span> renpy.variant(<span class="string">&quot;mobile&quot;</span>)):</span><br><span class="line"></span><br><span class="line">            <span class="comment">## “帮助”对移动设备来说并非必需或相关。</span></span><br><span class="line">            textbutton _(<span class="string">&quot;帮助&quot;</span>) action ShowMenu(<span class="string">&quot;help&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> renpy.variant(<span class="string">&quot;pc&quot;</span>):</span><br><span class="line"></span><br><span class="line">            <span class="comment">## 退出按钮在 iOS 上是被禁止使用的，在安卓和网页上也不是必要的。</span></span><br><span class="line">            textbutton _(<span class="string">&quot;退出&quot;</span>) action Quit(confirm=<span class="keyword">not</span> main_menu)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">style navigation_button <span class="keyword">is</span> gui_button</span><br><span class="line">style navigation_button_text <span class="keyword">is</span> gui_button_text</span><br><span class="line"></span><br><span class="line">style navigation_button:</span><br><span class="line">    size_group <span class="string">&quot;navigation&quot;</span></span><br><span class="line">    properties gui.button_properties(<span class="string">&quot;navigation_button&quot;</span>)</span><br><span class="line"></span><br><span class="line">style navigation_button_text:</span><br><span class="line">    properties gui.text_properties(<span class="string">&quot;navigation_button&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>基本上将<code>textbutton</code>更改为<code>imagebutton</code>即可，位置、大小、间距和横竖排列请自行更改<br>如果想更贴合标题背景，推荐删除标题菜单界面如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## use 语句将其他的屏幕包含进此屏幕。标题屏幕的实际内容在导航屏幕中。</span></span><br><span class="line">use navigation</span><br></pre></td></tr></table></figure><br>之后添加按钮代码，action行为可以从navigation界面获取，代码参考如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hbox:</span><br><span class="line">    align (<span class="number">0.2</span>, <span class="number">0.85</span>)</span><br><span class="line">    spacing <span class="number">50</span></span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/new_game.png&quot;</span></span><br><span class="line">        action Start()</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/load_game.png&quot;</span></span><br><span class="line">        action ShowMenu(<span class="string">&quot;load&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/extra.png&quot;</span></span><br><span class="line">        action ShowMenu(<span class="string">&quot;extra&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/setting.png&quot;</span></span><br><span class="line">        action ShowMenu(<span class="string">&quot;preferences&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/end_game.png&quot;</span></span><br><span class="line">        action Quit(confirm=<span class="keyword">not</span> main_menu)</span><br></pre></td></tr></table></figure><br>表现效果如下<br><img src="https://www.helloimg.com/i/2024/11/19/673c7b214e73c.png" alt=""></p><h1 id="背景图切换"><a href="#背景图切换" class="headerlink" title="背景图切换"></a>背景图切换</h1><p>一般情况下，GALGAME的标题背景图会随游戏内容的推进而切换，在Ren’py中，我们可以使用解锁画廊的条件，也就是<code>persistent.unlock</code>达到该效果<br>在<code>script.rpy</code>文件中添加如下代码初始化<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">init python:</span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_1 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_1 ==<span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_2 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_2 ==<span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_3 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_3 ==<span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_4 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_4 ==<span class="literal">False</span></span><br></pre></td></tr></table></figure><br>之后在结局内添加如下代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ persistent.unlock_1 = <span class="literal">True</span> <span class="comment">#结局一</span></span><br><span class="line">$ persistent.unlock_1 = <span class="literal">True</span> <span class="comment">#结局二</span></span><br><span class="line">$ persistent.unlock_1 = <span class="literal">True</span> <span class="comment">#结局三</span></span><br><span class="line">$ persistent.unlock_1 = <span class="literal">True</span> <span class="comment">#结局四</span></span><br></pre></td></tr></table></figure><br>通常情况下，标题界面的背景图在更换后不会切换回原背景图，我们需要修改如下代码<br><code>gui.rpy</code>文件中<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define gui.main_menu_background = <span class="string">&quot;gui/main.png&quot;</span></span><br><span class="line">define gui.main_menu_background1 = <span class="string">&quot;gui/main1.png&quot;</span></span><br><span class="line">define gui.main_menu_background2 = <span class="string">&quot;gui/main2.png&quot;</span></span><br><span class="line">define gui.main_menu_background3 = <span class="string">&quot;gui/main3.png&quot;</span></span><br></pre></td></tr></table></figure><br><code>screens.rpy</code>文件中<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> persistent.unlock_1:</span><br><span class="line">    add gui.main_menu_background1</span><br><span class="line"><span class="keyword">elif</span> persistent.unlock_2:</span><br><span class="line">    add gui.main_menu_background2</span><br><span class="line"><span class="keyword">elif</span> persistent.unlock_3:</span><br><span class="line">    add gui.main_menu_background3</span><br><span class="line"><span class="keyword">elif</span> persistent.unlock_4:</span><br><span class="line">    add gui.main_menu_background4</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    add gui.main_menu_background</span><br></pre></td></tr></table></figure><br>如果你想恢复原背景图，可以使用如下代码<br><code>script.rpy</code>文件中<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入新游戏，中途返回即可恢复原背景图</span></span><br><span class="line"></span><br><span class="line">label start:</span><br><span class="line">    <span class="comment">#清空持久化数据</span></span><br><span class="line">    $ persistent._clear(progress=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">####更推荐使用如下代码</span></span><br><span class="line">label start:</span><br><span class="line">    <span class="comment">#将解锁条件改为false，解锁条件不可与画廊解锁条件一致</span></span><br><span class="line">    $ persistent.unlock_1 =<span class="literal">False</span></span><br><span class="line">    $ persistent.unlock_2 =<span class="literal">False</span></span><br><span class="line">    $ persistent.unlock_3 =<span class="literal">False</span></span><br><span class="line">    $ persistent.unlock_4 =<span class="literal">False</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><div class="note danger modern"><p><code>persistent._clear(progress=True)</code><br>该语句只允许出现在开发阶段</p></div></p><h1 id="动画效果"><a href="#动画效果" class="headerlink" title="动画效果"></a>动画效果</h1><p>使用transform函数，我们可以添加动画效果<br>首先，我们需要定义一个动画效果<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#delay为延迟时间</span></span><br><span class="line">transform main_menu_transform(delay):</span><br><span class="line">    alpha <span class="number">0.0</span></span><br><span class="line">    on start:</span><br><span class="line">        time delay</span><br><span class="line">        easein <span class="number">2.0</span> alpha <span class="number">1.0</span></span><br></pre></td></tr></table></figure><br>之后使用at语句添加动画效果(以按钮为例)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">hbox:</span><br><span class="line">    align (<span class="number">0.2</span>, <span class="number">0.85</span>)</span><br><span class="line">    spacing <span class="number">50</span></span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/new_game.png&quot;</span></span><br><span class="line">+       at main_menu_transform(<span class="number">0.4</span>)</span><br><span class="line">        action Start()</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/load_game.png&quot;</span></span><br><span class="line">+       at main_menu_transform(<span class="number">0.8</span>)</span><br><span class="line">        action ShowMenu(<span class="string">&quot;load&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/extra.png&quot;</span></span><br><span class="line">+       at main_menu_transform(<span class="number">1.2</span>)</span><br><span class="line">        action ShowMenu(<span class="string">&quot;extra&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/setting.png&quot;</span></span><br><span class="line">+       at main_menu_transform(<span class="number">1.6</span>)</span><br><span class="line">        action ShowMenu(<span class="string">&quot;preferences&quot;</span>)</span><br><span class="line">    imagebutton:</span><br><span class="line">        idle <span class="string">&quot;gui/end_game.png&quot;</span></span><br><span class="line">+       at main_menu_transform(<span class="number">2.0</span>)</span><br><span class="line">        action Quit(confirm=<span class="keyword">not</span> main_menu)</span><br></pre></td></tr></table></figure><br><div class="note info modern"><p>+所在行表示所添加的代码</p></div></p><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p><code>screens.rpy</code>文件中，如下代码分别表示游戏名字，版本号<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> gui.show_name:</span><br><span class="line"></span><br><span class="line">    vbox:</span><br><span class="line">        style <span class="string">&quot;main_menu_vbox&quot;</span></span><br><span class="line"></span><br><span class="line">        text <span class="string">&quot;[config.name!t]&quot;</span>:</span><br><span class="line">            style <span class="string">&quot;main_menu_title&quot;</span></span><br><span class="line"></span><br><span class="line">        text <span class="string">&quot;[config.version]&quot;</span>:</span><br><span class="line">            style <span class="string">&quot;main_menu_version&quot;</span></span><br></pre></td></tr></table></figure><br>如果不想显示，可以在<code>options.rpy</code>文件中找到如下代码，并将其改为<code>False</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 决定上面给出的标题是否显示在标题界面屏幕。设置为 False 来隐藏标题。</span></span><br><span class="line"></span><br><span class="line">define gui.show_name = <span class="literal">True</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中标题菜单界面的自定义修改，包括背景的切换，按钮的动画效果等。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 鉴赏空间</title>
    <link href="http://lucylcarus.github.io/posts/b576c088.html"/>
    <id>http://lucylcarus.github.io/posts/b576c088.html</id>
    <published>2024-10-06T12:14:39.000Z</published>
    <updated>2024-12-04T04:54:36.637Z</updated>
    
    <content type="html"><![CDATA[<p><strong>若无特殊说明，默认是在<code>script.rpy</code>文件中进行编写</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>Ren’py官方文档相关链接:</p><ol><li><a href="https://doc.renpy.cn/zh-CN/rooms.html#music-room">音乐空间</a></li><li><a href="https://doc.renpy.cn/zh-CN/rooms.html#image-gallery">画廊</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1ef19YwEAH&cid=26155682972&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h1><p>之前编写的<code>init python</code>代码，基本不用修改。</p><h2 id="音乐空间相关"><a href="#音乐空间相关" class="headerlink" title="音乐空间相关"></a>音乐空间相关</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#音乐空间背景</span></span><br><span class="line">image music_background:</span><br><span class="line">    <span class="string">&quot;music_background.png&quot;</span></span><br><span class="line">    size (<span class="number">1920</span>, <span class="number">1080</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#音乐列表</span></span><br><span class="line">init python:</span><br><span class="line">    <span class="comment">#淡入淡出</span></span><br><span class="line">    mr = MusicRoom(fadein = <span class="number">1.0</span> , fadeout = <span class="number">1.0</span>)</span><br><span class="line">    <span class="comment">#音乐列表，第一个用于主界面bgm，设为默认解锁</span></span><br><span class="line">    mr.add(<span class="string">&quot;bgm01.ogg&quot;</span>,always_unlocked = <span class="literal">True</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm02.ogg&quot;</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm03.ogg&quot;</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#更多音乐请自行添加</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#时长参数</span></span><br><span class="line">init python:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_audio_duration</span>(<span class="params">channel=<span class="string">&quot;music&quot;</span></span>):</span><br><span class="line">        duration = renpy.music.get_duration(channel)</span><br><span class="line">        <span class="keyword">return</span> convert_format(<span class="built_in">int</span>(duration))</span><br><span class="line">        </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_audio_position</span>(<span class="params">channel=<span class="string">&quot;music&quot;</span></span>):</span><br><span class="line">        music_pos = renpy.music.get_pos(channel)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> music_pos:</span><br><span class="line">            <span class="keyword">return</span> convert_format(<span class="built_in">int</span>(music_pos))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;00:00&quot;</span></span><br><span class="line">    <span class="comment">#时间转换</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">convert_format</span>(<span class="params">second</span>):</span><br><span class="line">        minute = second // <span class="number">60</span></span><br><span class="line">        second = second % <span class="number">60</span></span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#可用于59分59秒内音乐</span></span><br><span class="line">        <span class="keyword">if</span> minute:</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> minute &lt; <span class="number">10</span>:</span><br><span class="line">                result = <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                    result =<span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                    result = <span class="built_in">str</span>(minute) + <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                       </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                result = <span class="string">&#x27;00:0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="string">&#x27;00:&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="画廊相关"><a href="#画廊相关" class="headerlink" title="画廊相关"></a>画廊相关</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#画廊/CG鉴赏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#背景图片</span></span><br><span class="line">image gallery_background:</span><br><span class="line">    <span class="string">&quot;gallery_background.png&quot;</span></span><br><span class="line">    size (<span class="number">1920</span>, <span class="number">1080</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#前提条件</span></span><br><span class="line">init python:</span><br><span class="line"></span><br><span class="line">    g = Gallery()</span><br><span class="line"></span><br><span class="line">    g.button(<span class="string">&quot;bg&quot;</span>)<span class="comment">#类似于标签</span></span><br><span class="line">    g.image(<span class="string">&quot;bg01.png&quot;</span>)<span class="comment">#真正的图片</span></span><br><span class="line">    g.unlock_image(<span class="string">&quot;bg03.png&quot;</span>)<span class="comment">#差分</span></span><br><span class="line"></span><br><span class="line">    g.button(<span class="string">&quot;cg&quot;</span>)</span><br><span class="line">    g.condition(<span class="string">&quot;persistent.unlock_1&quot;</span>)<span class="comment">#解锁限制</span></span><br><span class="line">    g.image(<span class="string">&quot;cg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#未解锁</span></span><br><span class="line">    g.button(<span class="string">&quot;unlock&quot;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">#更多图像请自行添加</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 图像切换使用的转场。</span></span><br><span class="line">    g.transition = dissolve</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="界面编写"><a href="#界面编写" class="headerlink" title="界面编写"></a>界面编写</h1><p>由于空间有限，我们舍弃掉画廊的快速定位功能，同时为避免产生歧义，CG鉴赏采取翻页效果，音乐鉴赏采取滚动条效果，具体代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#音乐列表顶部底部按钮定位</span></span><br><span class="line">default extra_music_pos = ui.adjustment()</span><br><span class="line"></span><br><span class="line"><span class="comment">#鉴赏空间界面</span></span><br><span class="line">screen extra(cg_page=<span class="number">0</span>):</span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;extra_bg.jpg&quot;</span> </span><br><span class="line">    text <span class="string">&quot;EXTRA&quot;</span> size <span class="number">80</span> color <span class="string">&quot;#000000&quot;</span> align (<span class="number">0.05</span>, <span class="number">0.1</span>) <span class="comment">#调整大小，颜色，位置</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#######画廊部分</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#CG列表</span></span><br><span class="line">    viewport:</span><br><span class="line"></span><br><span class="line">        xysize (<span class="number">1044</span>, <span class="number">690</span>)</span><br><span class="line">        align (<span class="number">0.1</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            <span class="comment">#间距</span></span><br><span class="line">            spacing <span class="number">60</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">#页数判断</span></span><br><span class="line">            <span class="keyword">if</span> (cg_page == <span class="number">0</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">3</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    <span class="comment">#解锁判断，后续判断请自行添加</span></span><br><span class="line">                    <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                        add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                        add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                        add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)  </span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)         </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cg_page == <span class="number">1</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">3</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cg_page == <span class="number">2</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">3</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">    <span class="comment">#翻页按钮</span></span><br><span class="line">    hbox:</span><br><span class="line">        xalign <span class="number">0.2</span> yalign <span class="number">0.85</span></span><br><span class="line">        spacing <span class="number">60</span></span><br><span class="line">        <span class="keyword">if</span> cg_page &lt; <span class="number">2</span>:</span><br><span class="line">            textbutton <span class="string">&quot;下一页&quot;</span> action Show(<span class="string">&quot;extra&quot;</span>,cg_page=(cg_page+<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            textbutton <span class="string">&quot;下一页&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">        textbutton <span class="string">&quot;1&quot;</span> action Show(<span class="string">&quot;extra&quot;</span>,cg_page=<span class="number">0</span>)</span><br><span class="line">        textbutton <span class="string">&quot;2&quot;</span> action Show(<span class="string">&quot;extra&quot;</span>,cg_page=<span class="number">1</span>)</span><br><span class="line">        textbutton <span class="string">&quot;3&quot;</span> action Show(<span class="string">&quot;extra&quot;</span>,cg_page=<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> cg_page &gt; <span class="number">0</span>:</span><br><span class="line">            textbutton <span class="string">&quot;上一页&quot;</span> action Show(<span class="string">&quot;extra&quot;</span>,cg_page=(cg_page-<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            textbutton <span class="string">&quot;上一页&quot;</span> action NullAction()</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">    <span class="comment">######音乐部分</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#更新renpy.music.get_position()和get_music_duration()</span></span><br><span class="line">    timer <span class="number">0.1</span>:</span><br><span class="line">        action [SetVariable(<span class="string">&#x27;duration&#x27;</span>,get_audio_duration()),SetVariable(<span class="string">&#x27;music_pos&#x27;</span>,get_audio_position())]</span><br><span class="line">        repeat <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#音乐列表</span></span><br><span class="line">    viewport <span class="built_in">id</span> <span class="string">&quot;MUSIC_list&quot;</span>:</span><br><span class="line">        mousewheel <span class="literal">True</span> <span class="comment">#垂直滚动</span></span><br><span class="line">        xysize (<span class="number">500</span>, <span class="number">600</span>)</span><br><span class="line">        align (<span class="number">0.9</span>, <span class="number">0.4</span>)</span><br><span class="line">        draggable <span class="literal">True</span>  <span class="comment">#鼠标拖动可滚动视口</span></span><br><span class="line">        yadjustment extra_music_pos <span class="comment">#快速定位</span></span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            </span><br><span class="line">            spacing <span class="number">50</span></span><br><span class="line"></span><br><span class="line">            textbutton <span class="string">&quot;bgm01&quot;</span> action mr.Play(<span class="string">&quot;bgm01.ogg&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#解锁判断</span></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm02.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm02&quot;</span> action mr.Play(<span class="string">&quot;bgm02.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm03.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm03&quot;</span> action mr.Play(<span class="string">&quot;bgm03.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#顶部底部按钮</span></span><br><span class="line">    vbox:</span><br><span class="line">        align (<span class="number">0.95</span>, <span class="number">0.4</span>)</span><br><span class="line">        textbutton <span class="string">&quot;顶部&quot;</span> action Function(extra_music_pos.change,<span class="number">0</span>)</span><br><span class="line">        vbar:</span><br><span class="line">            xysize (<span class="number">10</span>, <span class="number">500</span>)</span><br><span class="line">            align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">            value YScrollValue(<span class="string">&quot;MUSIC_list&quot;</span>)</span><br><span class="line">        <span class="comment">#如果不想算，只需保证该值足够大</span></span><br><span class="line">        textbutton <span class="string">&quot;底部&quot;</span> action Function(extra_music_pos.change,<span class="number">500000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#功能按钮</span></span><br><span class="line">    hbox:</span><br><span class="line"></span><br><span class="line">        align (<span class="number">0.85</span>, <span class="number">0.85</span>)</span><br><span class="line">        spacing <span class="number">40</span></span><br><span class="line">        textbutton <span class="string">&quot;下一首&quot;</span> action mr.Next()</span><br><span class="line">        imagebutton:</span><br><span class="line">            </span><br><span class="line">            idle <span class="string">&quot;pause.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;pause.png&quot;</span></span><br><span class="line">            selected_idle <span class="string">&quot;continue.png&quot;</span></span><br><span class="line">            selected_hover <span class="string">&quot;continue.png&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> renpy.music.is_playing() <span class="keyword">and</span> <span class="keyword">not</span> renpy.music.get_pause():</span><br><span class="line">                action mr.Play(<span class="string">&quot;bgm01.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                action PauseAudio(channel=<span class="string">&quot;music&quot;</span>,value=<span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                </span><br><span class="line">        textbutton <span class="string">&quot;上一首&quot;</span> action mr.Previous()</span><br><span class="line">        textbutton <span class="string">&quot;随机播放&quot;</span> action mr.RandomPlay()</span><br><span class="line"></span><br><span class="line">    vbox:</span><br><span class="line">        xpos <span class="number">0.5</span></span><br><span class="line">        ypos <span class="number">0.2</span></span><br><span class="line">        python:</span><br><span class="line">            duration = get_audio_duration()</span><br><span class="line">            music_pos = get_audio_position()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#音量调节，可有可无</span></span><br><span class="line">    hbox:</span><br><span class="line">        text <span class="string">&quot;音量&quot;</span></span><br><span class="line">        align (<span class="number">0.85</span>, <span class="number">0.12</span>)</span><br><span class="line">        bar:</span><br><span class="line">            value Preference(<span class="string">&quot;music volume&quot;</span>)</span><br><span class="line">            thumb <span class="string">&quot;dot.png&quot;</span></span><br><span class="line">            thumb_offset <span class="number">3</span></span><br><span class="line">            xysize (<span class="number">400</span>, <span class="number">5</span>)</span><br><span class="line">            align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#进度条，时长显示</span></span><br><span class="line">    hbox:</span><br><span class="line">        align (<span class="number">0.9</span>, <span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line">        bar:</span><br><span class="line">            value AudioPositionValue(channel=<span class="string">&#x27;music&#x27;</span>, update_interval=<span class="number">0.1</span>)</span><br><span class="line">            xysize (<span class="number">400</span>,<span class="number">5</span>)</span><br><span class="line">            align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">            thumb <span class="string">&quot;dot.png&quot;</span></span><br><span class="line">            thumb_offset <span class="number">3</span></span><br><span class="line"></span><br><span class="line">        hbox:</span><br><span class="line">            spacing <span class="number">10</span></span><br><span class="line">            text music_pos</span><br><span class="line">            text <span class="string">&quot;/&quot;</span></span><br><span class="line">            text duration</span><br><span class="line">  </span><br><span class="line">    <span class="comment">#返回按钮</span></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.05</span>, <span class="number">0.95</span>)</span><br><span class="line">        text_color <span class="string">&quot;#000&quot;</span></span><br><span class="line">        text_size <span class="number">50</span></span><br><span class="line">        action [Return(), Play(<span class="string">&quot;music&quot;</span>, <span class="string">&quot;bgm01.ogg&quot;</span>)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="周目解锁"><a href="#周目解锁" class="headerlink" title="周目解锁"></a>周目解锁</h1><p>添加如下代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">init python:</span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_1 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_1 ==<span class="literal">False</span></span><br><span class="line">    <span class="comment">#更多条件限制请自行添加</span></span><br></pre></td></tr></table></figure><p>在某一结局内添加如下代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解锁条件1</span></span><br><span class="line">$ persistent.unlock_1 = <span class="literal">True</span></span><br><span class="line"><span class="comment">#更多周目请自行添加</span></span><br></pre></td></tr></table></figure><h1 id="添加入口"><a href="#添加入口" class="headerlink" title="添加入口"></a>添加入口</h1><p>完成上述操作后，我们还需要添加主界面进入按钮，打开<code>screens.rpy</code>，找到<code>screen navigation()</code>(287行左右)，在合适位置添加下面的代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textbutton <span class="string">&quot;EXTRA&quot;</span> action ShowMenu(<span class="string">&quot;extra&quot;</span>)</span><br></pre></td></tr></table></figure><p>现在运行游戏，即可在主界面看到鉴赏空间进入按钮，请检查各功能是否可用。</p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中画廊和音乐空间二合一效果，由于空间有限，无法支持全部功能，会有些许缺失，请自行考虑使用。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 画廊</title>
    <link href="http://lucylcarus.github.io/posts/b5b066b2.html"/>
    <id>http://lucylcarus.github.io/posts/b5b066b2.html</id>
    <published>2024-09-29T08:27:09.000Z</published>
    <updated>2024-12-04T04:54:40.747Z</updated>
    
    <content type="html"><![CDATA[<p><strong>若无特殊说明，默认是在<code>script.rpy</code>文件中进行编写</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>Ren’py官方文档相关链接:</p><ol><li><a href="https://doc.renpy.cn/zh-CN/rooms.html#image-gallery">画廊</a></li><li><a href="https://doc.renpy.cn/zh-CN/displaying_images.html#renpy.seen_image">常规解锁判断</a></li><li><a href="https://doc.renpy.cn/zh-CN/persistent.html#persistent-data">周目解锁判断</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><h2 id="基础部分"><a href="#基础部分" class="headerlink" title="基础部分"></a>基础部分</h2><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1JGtyeDEcX&cid=25949438659&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h2 id="进阶操作"><a href="#进阶操作" class="headerlink" title="进阶操作"></a>进阶操作</h2><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1XLxqemE8h&cid=26050103049&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h1><p>同音乐空间一样，想要实现画廊需要一些前提条件，详见下述代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#画廊/CG鉴赏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#背景图片</span></span><br><span class="line">image gallery_background:</span><br><span class="line">    <span class="string">&quot;gallery_background.png&quot;</span></span><br><span class="line">    size (<span class="number">1920</span>, <span class="number">1080</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#前提条件</span></span><br><span class="line">init python:</span><br><span class="line"></span><br><span class="line">    g = Gallery()</span><br><span class="line"></span><br><span class="line">    g.button(<span class="string">&quot;bg&quot;</span>)<span class="comment">#类似于标签</span></span><br><span class="line">    g.image(<span class="string">&quot;bg01.png&quot;</span>)<span class="comment">#真正的图片</span></span><br><span class="line">    g.unlock_image(<span class="string">&quot;bg03.png&quot;</span>)<span class="comment">#差分</span></span><br><span class="line"></span><br><span class="line">    g.button(<span class="string">&quot;cg&quot;</span>)</span><br><span class="line">    g.condition(<span class="string">&quot;persistent.unlock_1&quot;</span>)<span class="comment">#解锁限制</span></span><br><span class="line">    g.image(<span class="string">&quot;cg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#未解锁</span></span><br><span class="line">    g.button(<span class="string">&quot;unlock&quot;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">#更多图像请自行添加</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 图像切换使用的转场。</span></span><br><span class="line">    g.transition = dissolve</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果选择翻页功能可以不加</span></span><br><span class="line">default p = ui.adjustment()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="界面编写"><a href="#界面编写" class="headerlink" title="界面编写"></a>界面编写</h1><p>前提条件编写完成后，我们就可以着手编写画廊界面了，这里我提供了滚动条样式和翻页样式两种常用形式，请自行选择你想要那种效果</p><h2 id="滚动条式界面-推荐"><a href="#滚动条式界面-推荐" class="headerlink" title="滚动条式界面(推荐)"></a>滚动条式界面(推荐)</h2><p>以下代码适用于滚动条式界面，请选择好你想要的效果。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#鉴赏界面</span></span><br><span class="line"></span><br><span class="line">screen gallery:</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;gallery_background&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#可拖动条</span></span><br><span class="line">    vbar:</span><br><span class="line">        xysize (<span class="number">10</span>, <span class="number">680</span>)</span><br><span class="line">        align (<span class="number">0.9</span>, <span class="number">0.5</span>)</span><br><span class="line">        value YScrollValue(<span class="string">&quot;cg_list&quot;</span>)   </span><br><span class="line"></span><br><span class="line">    viewport <span class="built_in">id</span> <span class="string">&quot;cg_list&quot;</span>:</span><br><span class="line">        mousewheel <span class="literal">True</span> <span class="comment">#垂直滚动</span></span><br><span class="line">        xysize (<span class="number">1500</span>, <span class="number">680</span>)</span><br><span class="line">        align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">        draggable <span class="literal">True</span> <span class="comment">#鼠标拖动可滚动视口</span></span><br><span class="line">        yadjustment p <span class="comment">#快速定位</span></span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            <span class="comment">#间距</span></span><br><span class="line">            spacing <span class="number">60</span></span><br><span class="line"></span><br><span class="line">            text <span class="string">&quot;角色1&quot;</span> size <span class="number">40</span> </span><br><span class="line">            </span><br><span class="line">            <span class="comment">#网格布局</span></span><br><span class="line">            grid <span class="number">4</span> <span class="number">3</span> <span class="built_in">id</span> <span class="string">&quot;bg&quot;</span>:</span><br><span class="line">                spacing <span class="number">60</span></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">                <span class="comment">#判断是否解锁</span></span><br><span class="line">                <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg05&quot;</span>):</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> renpy.seen_image(<span class="string">&quot;bg03&quot;</span>):</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    add g.make_button(<span class="string">&quot;unlock&quot;</span>, <span class="string">&quot;unknow.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">#由于全加判断语句导致代码太长，以下暂不添加判断</span></span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">            text <span class="string">&quot;角色2&quot;</span> size <span class="number">40</span></span><br><span class="line"></span><br><span class="line">            grid <span class="number">4</span> <span class="number">3</span> <span class="built_in">id</span> <span class="string">&quot;cg&quot;</span>:</span><br><span class="line">                spacing <span class="number">60</span></span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">#更多图像请自行添加</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#快速定位选项</span></span><br><span class="line">    vbox:</span><br><span class="line">        <span class="comment">#请自行根据图像高度和间距计算数值</span></span><br><span class="line">        textbutton <span class="string">&quot;角色1&quot;</span> action Function(p.change,<span class="number">0</span>)</span><br><span class="line">        textbutton <span class="string">&quot;角色2&quot;</span> action Function(p.change,<span class="number">799</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#更多角色请自行添加</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#返回按钮</span></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.0</span>, <span class="number">0.98</span>)</span><br><span class="line">        action Return()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="翻页式界面"><a href="#翻页式界面" class="headerlink" title="翻页式界面"></a>翻页式界面</h2><p>以下代码适用于翻页式界面，请选择好你想要的效果。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">screen gallery(page=<span class="number">0</span>):</span><br><span class="line"></span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;gallery_background&quot;</span></span><br><span class="line">    </span><br><span class="line">    viewport:    </span><br><span class="line">        xysize (<span class="number">1500</span>, <span class="number">680</span>)</span><br><span class="line">        align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            spacing <span class="number">60</span></span><br><span class="line">            <span class="comment">#页数判断</span></span><br><span class="line">            <span class="keyword">if</span> (page == <span class="number">0</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    <span class="comment">#由于全部添加会导致代码很长，以下只展示三张图片，请自行添加判断语句</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (page == <span class="number">1</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (page == <span class="number">2</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">#更多页面请自行添加</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#底部按钮</span></span><br><span class="line">    hbox:</span><br><span class="line">        xalign <span class="number">0.5</span> yalign <span class="number">0.9</span></span><br><span class="line">        spacing <span class="number">60</span></span><br><span class="line">        <span class="comment">#请自行根据你的CG数量进行条件判断</span></span><br><span class="line">        <span class="keyword">if</span> page &lt; <span class="number">2</span>:</span><br><span class="line">            textbutton <span class="string">&quot;下一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,page=(page+<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            textbutton <span class="string">&quot;下一页&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">        textbutton <span class="string">&quot;1&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,page=<span class="number">0</span>)</span><br><span class="line">        textbutton <span class="string">&quot;2&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,page=<span class="number">1</span>)</span><br><span class="line">        textbutton <span class="string">&quot;3&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,page=<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> page &gt; <span class="number">0</span>:</span><br><span class="line">            textbutton <span class="string">&quot;上一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,page=(page-<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            textbutton <span class="string">&quot;上一页&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#返回按钮</span></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.0</span>, <span class="number">0.98</span>)</span><br><span class="line">        action Return()  </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果想添加快速定位功能，请进一步定义<code>角色名_page</code>，并修改为以下代码(只显示需要修改的代码)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入画廊默认界面</span></span><br><span class="line">screen gallery(角色1_page=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">viewport:    </span><br><span class="line">        xysize (<span class="number">1500</span>, <span class="number">680</span>)</span><br><span class="line">        align (<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        vbox:</span><br><span class="line">            spacing <span class="number">60</span></span><br><span class="line">            <span class="comment">#页数判断</span></span><br><span class="line">            <span class="keyword">if</span> (角色1_page == <span class="number">0</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    <span class="comment">#由于全部添加会导致代码很长，以下只展示三张图片，请自行添加判断语句</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)          </span><br><span class="line">                vbox:</span><br><span class="line">                    <span class="comment">#请自行根据你的CG数量进行条件判断</span></span><br><span class="line">                    textbutton <span class="string">&quot;下一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色1_page=(角色1_page+<span class="number">1</span>))</span><br><span class="line">                    textbutton <span class="string">&quot;上一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色1_page=(角色1_page-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (角色1_page == <span class="number">1</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;smbg03.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                vbox:</span><br><span class="line">                    <span class="comment">#请自行根据你的CG数量进行条件判断</span></span><br><span class="line">                    textbutton <span class="string">&quot;下一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色1_page=(角色1_page+<span class="number">1</span>))</span><br><span class="line">                    textbutton <span class="string">&quot;上一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色1_page=(角色1_page-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (角色2_page=<span class="number">0</span>):</span><br><span class="line">                grid <span class="number">3</span> <span class="number">1</span>:</span><br><span class="line">                    spacing <span class="number">60</span></span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                    add g.make_button(<span class="string">&quot;cg&quot;</span>, <span class="string">&quot;smcg01.png&quot;</span>)</span><br><span class="line">                vbox:</span><br><span class="line">                    <span class="comment">#请自行根据你的CG数量进行条件判断</span></span><br><span class="line">                    textbutton <span class="string">&quot;下一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色2_page=(角色2_page+<span class="number">1</span>))</span><br><span class="line">                    textbutton <span class="string">&quot;上一页&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色2_page=(角色2_page-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment">#更多页面请自行添加</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加快速定位选项</span></span><br><span class="line">vbox:</span><br><span class="line">    textbutton <span class="string">&quot;角色1&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色1_page=<span class="number">0</span>)</span><br><span class="line">    textbutton <span class="string">&quot;角色2&quot;</span> action Show(<span class="string">&quot;gallery&quot;</span>,角色2_page=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#更多角色请自行添加</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="周目解锁"><a href="#周目解锁" class="headerlink" title="周目解锁"></a>周目解锁</h1><p>添加如下代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">init python:</span><br><span class="line">    <span class="keyword">if</span> persistent.unlock_1 == <span class="literal">None</span>:</span><br><span class="line">        persistent.unlock_1 ==<span class="literal">False</span></span><br><span class="line">    <span class="comment">#更多条件限制请自行添加</span></span><br></pre></td></tr></table></figure><p>在某一结局内添加如下代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#解锁条件1</span></span><br><span class="line">$ persistent.unlock_1 = <span class="literal">True</span></span><br><span class="line"><span class="comment">#更多周目请自行添加</span></span><br></pre></td></tr></table></figure><h1 id="添加入口"><a href="#添加入口" class="headerlink" title="添加入口"></a>添加入口</h1><p>完成上述操作后，我们还需要添加主界面进入按钮，打开<code>screens.rpy</code>，找到<code>screen navigation()</code>(287行左右)，在合适位置添加下面的代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textbutton <span class="string">&quot;画廊&quot;</span> action ShowMenu(<span class="string">&quot;gallery&quot;</span>)</span><br></pre></td></tr></table></figure></p><p>现在运行游戏，即可在主界面看到画廊进入按钮，请检查各功能是否可用。</p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中画廊的实现方法，包括快速定位，翻页功能和滚动条两种选择。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>Ren&#39;py 音乐空间</title>
    <link href="http://lucylcarus.github.io/posts/90ea59ad.html"/>
    <id>http://lucylcarus.github.io/posts/90ea59ad.html</id>
    <published>2024-09-25T08:27:09.000Z</published>
    <updated>2024-12-04T04:55:12.567Z</updated>
    
    <content type="html"><![CDATA[<p><strong>若无特殊说明，默认是在<code>script.rpy</code>文件中进行编写</strong></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>本文参考Ren’py中文论坛文章:<br><a href="https://www.renpy.cn/thread-740-1-1.html">[原创] [教程]音乐进度条显示，全长和已播放进度，附加播放/暂停</a></p><p>Ren’py官方文档相关链接:</p><ol><li><a href="https://doc.renpy.cn/zh-CN/rooms.html#music-room">音乐空间</a></li><li><a href="https://doc.renpy.cn/zh-CN/audio.html#functions">时长位置</a></li><li><a href="https://doc.renpy.cn/zh-CN/screens.html#timer">更新时长</a></li></ol><h1 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h1><h2 id="基础部分"><a href="#基础部分" class="headerlink" title="基础部分"></a>基础部分</h2><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV19ZpueeE1M&cid=25752374369&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h2 id="进阶操作"><a href="#进阶操作" class="headerlink" title="进阶操作"></a>进阶操作</h2><div style="position:relative; padding-bottom:75%; width:100%; height:0">    <iframe src="//player.bilibili.com/player.html?bvid=BV1zL4bezE5h&cid=25870731371&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"></iframe></div><h1 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h1><p>想要实现音乐空间需要一些前提条件，详见下述代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#音乐空间背景</span></span><br><span class="line">image music_background:</span><br><span class="line">    <span class="string">&quot;music_background.png&quot;</span></span><br><span class="line">    size (<span class="number">1920</span>, <span class="number">1080</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#音乐列表</span></span><br><span class="line">init python:</span><br><span class="line">    <span class="comment">#淡入淡出</span></span><br><span class="line">    mr = MusicRoom(fadein = <span class="number">1.0</span> , fadeout = <span class="number">1.0</span>)</span><br><span class="line">    <span class="comment">#音乐列表，第一个用于主界面bgm，设为默认解锁</span></span><br><span class="line">    mr.add(<span class="string">&quot;bgm01.ogg&quot;</span>,always_unlocked = <span class="literal">True</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm02.ogg&quot;</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm03.ogg&quot;</span>)</span><br><span class="line">    mr.add(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#更多音乐请自行添加</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#时长参数</span></span><br><span class="line">init python:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_audio_duration</span>(<span class="params">channel=<span class="string">&quot;music&quot;</span></span>):</span><br><span class="line">        duration = renpy.music.get_duration(channel)</span><br><span class="line">        <span class="keyword">return</span> convert_format(<span class="built_in">int</span>(duration))</span><br><span class="line">        </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_audio_position</span>(<span class="params">channel=<span class="string">&quot;music&quot;</span></span>):</span><br><span class="line">        music_pos = renpy.music.get_pos(channel)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> music_pos:</span><br><span class="line">            <span class="keyword">return</span> convert_format(<span class="built_in">int</span>(music_pos))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;00:00&quot;</span></span><br><span class="line">    <span class="comment">#时间转换</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">convert_format</span>(<span class="params">second</span>):</span><br><span class="line">        minute = second // <span class="number">60</span></span><br><span class="line">        second = second % <span class="number">60</span></span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#可用于59分59秒内音乐</span></span><br><span class="line">        <span class="keyword">if</span> minute:</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> minute &lt; <span class="number">10</span>:</span><br><span class="line">                result = <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                    result =<span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="built_in">str</span>(minute) + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                    result = <span class="built_in">str</span>(minute) + <span class="string">&#x27;0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">                       </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> second &lt; <span class="number">10</span>:</span><br><span class="line">                result = <span class="string">&#x27;00:0&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="string">&#x27;00:&#x27;</span> + <span class="built_in">str</span>(second)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><h1 id="界面编写"><a href="#界面编写" class="headerlink" title="界面编写"></a>界面编写</h1><p>前提条件编写完成后，我们就可以着手编写音乐空间界面了，详见下述代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#音乐空间界面</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">screen music_room:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#更新renpy.music.get_position()和get_music_duration()</span></span><br><span class="line">    timer <span class="number">0.1</span>:</span><br><span class="line">        action [SetVariable(<span class="string">&#x27;duration&#x27;</span>,get_audio_duration()),SetVariable(<span class="string">&#x27;music_pos&#x27;</span>,get_audio_position())]</span><br><span class="line">        repeat <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    zorder <span class="number">2</span></span><br><span class="line">    tag menu</span><br><span class="line">    add <span class="string">&quot;music_background&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#音乐列表</span></span><br><span class="line">    viewport <span class="built_in">id</span> <span class="string">&quot;music_list&quot;</span>:</span><br><span class="line">        mousewheel <span class="literal">True</span> <span class="comment">#垂直滚动</span></span><br><span class="line">        xysize (<span class="number">500</span>, <span class="number">500</span>)</span><br><span class="line">        align (<span class="number">0.3</span>, <span class="number">0.4</span>)</span><br><span class="line">        draggable <span class="literal">True</span> <span class="comment">#鼠标拖动可滚动视口</span></span><br><span class="line">        vbox:</span><br><span class="line">            </span><br><span class="line">            spacing <span class="number">50</span></span><br><span class="line"></span><br><span class="line">            textbutton <span class="string">&quot;bgm01&quot;</span> action mr.Play(<span class="string">&quot;bgm01.ogg&quot;</span>)</span><br><span class="line">            <span class="comment">#判断bgm是否解锁</span></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm02.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm02&quot;</span> action mr.Play(<span class="string">&quot;bgm02.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm03.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm03&quot;</span> action mr.Play(<span class="string">&quot;bgm03.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line">            <span class="keyword">if</span> mr.is_unlocked(<span class="string">&quot;bgm04.ogg&quot;</span>):</span><br><span class="line">                textbutton <span class="string">&quot;bgm04&quot;</span> action mr.Play(<span class="string">&quot;bgm04.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                textbutton <span class="string">&quot;???&quot;</span> action NullAction()</span><br><span class="line"></span><br><span class="line">            <span class="comment">#更多音乐请自行添加</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#可拖动滑块</span></span><br><span class="line">    vbar:</span><br><span class="line">        xysize (<span class="number">10</span>, <span class="number">500</span>)</span><br><span class="line">        align (<span class="number">0.9</span>, <span class="number">0.4</span>)</span><br><span class="line">        value YScrollValue(<span class="string">&quot;music_list&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#功能按键</span></span><br><span class="line">    hbox:</span><br><span class="line"></span><br><span class="line">        align (<span class="number">0.5</span>, <span class="number">0.8</span>)</span><br><span class="line">        spacing <span class="number">200</span></span><br><span class="line"></span><br><span class="line">        textbutton <span class="string">&quot;下一首&quot;</span> action mr.Next()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#暂停/播放切换</span></span><br><span class="line">        imagebutton:</span><br><span class="line">            </span><br><span class="line">            idle <span class="string">&quot;pause.png&quot;</span></span><br><span class="line">            hover <span class="string">&quot;pause.png&quot;</span></span><br><span class="line">            selected_idle <span class="string">&quot;continue.png&quot;</span></span><br><span class="line">            selected_hover <span class="string">&quot;continue.png&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> renpy.music.is_playing() <span class="keyword">and</span> <span class="keyword">not</span> renpy.music.get_pause():</span><br><span class="line">                action mr.Play(<span class="string">&quot;bgm01.ogg&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                action PauseAudio(channel=<span class="string">&quot;music&quot;</span>,value=<span class="string">&quot;toggle&quot;</span>)</span><br><span class="line">                </span><br><span class="line">        textbutton <span class="string">&quot;上一首&quot;</span> action mr.Previous()</span><br><span class="line">        textbutton <span class="string">&quot;随机播放&quot;</span> action mr.RandomPlay()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#显示时长</span></span><br><span class="line">    bar:</span><br><span class="line">        value AudioPositionValue(channel=<span class="string">&#x27;music&#x27;</span>, update_interval=<span class="number">0.1</span>)</span><br><span class="line">        xysize (<span class="number">800</span>,<span class="number">5</span>)</span><br><span class="line">        align (<span class="number">0.5</span>, <span class="number">0.7</span>)</span><br><span class="line">        thumb <span class="string">&quot;dot.png&quot;</span></span><br><span class="line">        thumb_offset <span class="number">3</span></span><br><span class="line">  </span><br><span class="line">    vbox:</span><br><span class="line">        xpos <span class="number">0.5</span></span><br><span class="line">        ypos <span class="number">0.2</span></span><br><span class="line">        python:</span><br><span class="line">            duration = get_audio_duration()</span><br><span class="line">            music_pos = get_audio_position()</span><br><span class="line">    hbox:</span><br><span class="line">        spacing <span class="number">20</span></span><br><span class="line">        align (<span class="number">0.8</span>, <span class="number">0.7</span>)</span><br><span class="line">        text music_pos</span><br><span class="line">        text <span class="string">&quot;/&quot;</span></span><br><span class="line">        text duration</span><br><span class="line">        </span><br><span class="line">    <span class="comment">#返回按钮</span></span><br><span class="line">    textbutton <span class="string">&quot;返回&quot;</span>:</span><br><span class="line">        align (<span class="number">0.0</span>, <span class="number">0.98</span>)</span><br><span class="line">        action Return()</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 音乐空间的音乐播放入口。</span></span><br><span class="line">    on <span class="string">&quot;replace&quot;</span> action mr.Play()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 离开时恢复主菜单的音乐。</span></span><br><span class="line">    on <span class="string">&quot;replaced&quot;</span> action Play(<span class="string">&quot;music&quot;</span>, <span class="string">&quot;bgm01.ogg&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="添加入口"><a href="#添加入口" class="headerlink" title="添加入口"></a>添加入口</h1><p>完成上述操作后，我们还需要添加主界面进入按钮，打开<code>screens.rpy</code>，找到<code>screen navigation()</code>(287行左右)，在合适位置添加下面的代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textbutton <span class="string">&quot;音乐空间&quot;</span> action ShowMenu(<span class="string">&quot;music_room&quot;</span>)</span><br></pre></td></tr></table></figure></p><p>现在运行游戏，即可在主界面看到音乐空间进入按钮，请检查各功能是否可用。</p>]]></content>
    
    
    <summary type="html">Ren&#39;py引擎中音乐空间实现方法，包括播放暂停按钮切换，显示音乐时长等操作。</summary>
    
    
    
    <category term="视频教程" scheme="http://lucylcarus.github.io/categories/%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Ren&#39;py" scheme="http://lucylcarus.github.io/tags/Ren-py/"/>
    
    <category term="GALGAME引擎" scheme="http://lucylcarus.github.io/tags/GALGAME%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>MySQL语法使用(二)</title>
    <link href="http://lucylcarus.github.io/posts/37d2fb35.html"/>
    <id>http://lucylcarus.github.io/posts/37d2fb35.html</id>
    <published>2024-09-20T08:27:09.000Z</published>
    <updated>2024-12-04T04:55:23.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查看数据表"><a href="#查看数据表" class="headerlink" title="查看数据表"></a>查看数据表</h1><h2 id="查看已创建的数据表"><a href="#查看已创建的数据表" class="headerlink" title="查看已创建的数据表"></a>查看已创建的数据表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br></pre></td></tr></table></figure><h2 id="查看数据表结构"><a href="#查看数据表结构" class="headerlink" title="查看数据表结构"></a>查看数据表结构</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESCRIBE</span>(<span class="keyword">DESC</span>) <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>例: 查看student数据表的结构(<code>USE</code>命令可以让我们来使用数据库)<br>USE test;<br>DESC student;<br>或<br>USE test;<br>SHOW CREATE TABLE student;</p></blockquote><h1 id="数据表中数据的操纵"><a href="#数据表中数据的操纵" class="headerlink" title="数据表中数据的操纵"></a>数据表中数据的操纵</h1><h2 id="向数据表中添加数据"><a href="#向数据表中添加数据" class="headerlink" title="向数据表中添加数据"></a>向数据表中添加数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>注：可使用逗号分隔添加多条数据，但不推荐使用</span><br><span class="line"><span class="keyword">INSERT</span> <span class="operator">|</span> REPLACE <span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> [(<span class="operator">&lt;</span>字段名<span class="number">1</span><span class="operator">&gt;</span> [, <span class="operator">&lt;</span>字段名<span class="number">2</span><span class="operator">&gt;</span> …… ])] <span class="keyword">VALUES</span>(<span class="operator">&lt;</span>值<span class="operator">&gt;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>例: 向student数据表中添加一条记录(可只选择部分添加)<br>INSERT INTO student(sno, sname, age, sex, major, department)<br>VALUES(‘123’, ‘张三’, ‘23’, ‘男’, ‘计算机’, ‘信息学院’);</p></blockquote><h2 id="修改数据表中数据"><a href="#修改数据表中数据" class="headerlink" title="修改数据表中数据"></a>修改数据表中数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATA <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">SET</span> <span class="operator">&lt;</span>字段名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>字段名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>]……</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure><blockquote><p>例: 在student数据表中将张三年龄增加一岁<br>UPDATE student<br>SET age=age+1<br>WHERE sname=”张三”;</p></blockquote><h2 id="删除表中数据"><a href="#删除表中数据" class="headerlink" title="删除表中数据"></a>删除表中数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure><blockquote><p>例: 在student数据表中将张三数据删除<br>DELETE<br>FROM student<br>WHERE sname=”张三”;</p></blockquote>]]></content>
    
    
    <summary type="html">MySQL软件采用了双授权政策，分为社区版和商业版，由于其体积小、速度快、总体拥有成本低，尤其是开放源码这一特点，一般中小型和大型网站的开发都选MySQL作为网站数据库。</summary>
    
    
    
    <category term="数据库" scheme="http://lucylcarus.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="http://lucylcarus.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL语法使用(一)</title>
    <link href="http://lucylcarus.github.io/posts/ed03a884.html"/>
    <id>http://lucylcarus.github.io/posts/ed03a884.html</id>
    <published>2024-09-16T08:27:09.000Z</published>
    <updated>2024-12-04T04:55:18.293Z</updated>
    
    <content type="html"><![CDATA[<p>写在最前面：MySQL对字母大小写不敏感，因此<strong>不必在意大小写</strong></p><h1 id="数据库管理"><a href="#数据库管理" class="headerlink" title="数据库管理"></a>数据库管理</h1><h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><p>在 MySQL 中，可以使用 CREATE DATABASE 语句创建数据库，语法格式如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>通常情况下只写第一句即可</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] db_name</span><br><span class="line">[[<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">&lt;</span>字符集名<span class="operator">&gt;</span>] </span><br><span class="line">[[<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span> <span class="operator">&lt;</span>校对规则名<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure></p><p><code>[ ]</code>中的内容是可选的。语法说明如下：</p><p><code>db_name</code>创建数据库的名称。MySQL 的数据存储区将以目录方式表示 MySQL 数据库，因此数据库名称必须符合操作系统的文件夹命名规则，不能以数字开头，尽量要有实际意义。</p><p><code>IF NOT EXISTS</code>在创建数据库之前进行判断，只有该数据库目前尚不存在时才能执行操作。此选项可以用来避免数据库已经存在而重复创建的错误。</p><p><code>[DEFAULT] CHARACTER SET</code>指定数据库的字符集。指定字符集的目的是为了避免在数据库中存储的数据出现乱码的情况。如果在创建数据库时不指定字符集，那么就使用系统的默认字符集。</p><p><code>[DEFAULT] COLLATE</code>指定字符集的默认校对规则。</p><blockquote><p>例：创建名为test的数据库<br>CREATE DATABASE test;</p></blockquote><h2 id="查看数据库"><a href="#查看数据库" class="headerlink" title="查看数据库"></a>查看数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE db_name;</span><br></pre></td></tr></table></figure><blockquote><p>例：查看名为test的数据库<br>SHOW CREATE DATABASE test;</p></blockquote><h2 id="修改数据库"><a href="#修改数据库" class="headerlink" title="修改数据库"></a>修改数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE<span class="operator">|</span>SCHEMA db_name</span><br><span class="line">[<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> charset_name</span><br><span class="line">[<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span> collation_name;</span><br></pre></td></tr></table></figure><blockquote><p>例：修改名为test的数据库<br>ALTER DATABASE test<br>DEFAULT CHARACTER SET gbk<br>DEFAULT COLLATE gbk_chinese_ci;</p></blockquote><h2 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] db_name;</span><br></pre></td></tr></table></figure><blockquote><p>例：删除名为test的数据库<br>DROP DATABASE test;</p></blockquote><h1 id="数据库表的管理"><a href="#数据库表的管理" class="headerlink" title="数据库表的管理"></a>数据库表的管理</h1><h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> EXIST] <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[([<span class="operator">&lt;</span>字段定义<span class="operator">&gt;</span>],……,<span class="operator">|</span>[<span class="operator">&lt;</span>索引定义<span class="operator">&gt;</span>])]</span><br><span class="line">[table_option] [selsct_statement];</span><br></pre></td></tr></table></figure><p><code>TEMPORARY</code> 若使用该关键字，则创建的是临时表</p><p><code>IF NOT EXIST</code> 用于判断数据库中是否已经存在同名的表。若不存在，则执行<code>CREATE TABLE</code>操作。若数据库中已存在同名表，创建数据表时会出错，为避免此种情况，可使用<code>IF NOT EXIST</code>进行判断</p><p><code>&lt;表名&gt;</code> 要创建的表名，最多可有64个字符，不允许重名，不能使用SQL中的关键字</p><p><code>&lt;字段定义&gt;</code> 的书写格式如下:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [<span class="keyword">DEFAULT</span>] [AUTO_INCREMENT] [COMMENT <span class="string">&#x27;String&#x27;</span>] [&#123;<span class="operator">&lt;</span>列约束<span class="operator">&gt;</span>&#125;]</span><br></pre></td></tr></table></figure><p><code>DEFAULT</code> 若某字段设置有默认值，则当该字段未被输入数据时，自动填充设置的默认值</p><p><code>AUTO_INCREMENT</code> 设置自增数值属性，只有整数型数据能够设置</p><p><code>COMMENT &#39;String&#39;</code> 注释字段名</p><p><code>&lt;列约束&gt;</code> 列约束是对某一个特定字段的约束，包含在字段定义中，直接跟在该字段的其他定义之后，用空格分隔，不必指定字段名</p><p><code>&lt;索引定义&gt;</code> 为表中相关字段指定索引</p><p><code>table_option</code> 表选项，存储引擎，字符集等</p><p><code>selsct_statement</code> 定义表的查询语句</p><blockquote><p>例：创建名为students的数据表并添加基本属性<br>CREATE TABLE “students” (<br>“sno” CHAR(10) NOT NULL COMMENT “学号”,<br>“sname” VARCHAR(45) NOT NULL COMMENT “姓名”,<br>“sex” ENUM(“男”,”女”) NOT NULL DEFAULT “男” COMMENT “性别”,<br>“age” INT NOT NULL COMMENT “年龄”,<br>“major” VARCHAR(45) NOT NULL COMMENT “专业”,<br>“department” VARCHAR(45) NOT NULL COMMENT “院系”,<br>PRIMARY KEY (“sno”)  //主码约束<br>)</p></blockquote><p>定义表的约束：</p><ol><li>非空约束(NULL/NOT NULL)</li><li>唯一约束(UNIQUE)</li><li>主码约束(PRIMARY KEY)</li><li>外码约束(FOREIGN KEY)</li><li>检查约束(CHECK) </li></ol><h2 id="修改表的数据"><a href="#修改表的数据" class="headerlink" title="修改表的数据"></a>修改表的数据</h2><h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ADD</span> [<span class="operator">&lt;</span>新字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="operator">&lt;</span>完整性约束定义<span class="operator">&gt;</span>] [<span class="keyword">FIRST</span><span class="operator">|</span>AFTER已有字段名]</span><br></pre></td></tr></table></figure><blockquote><p>例：在students数据表中添加学生班级属性<br>ALTER TABLE students<br>ADD class VARCHAR(6);</p></blockquote><h3 id="重命名表名"><a href="#重命名表名" class="headerlink" title="重命名表名"></a>重命名表名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>数据表名<span class="operator">&gt;</span></span><br><span class="line">RENAME [<span class="keyword">TO</span>] <span class="operator">&lt;</span>新表名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>例：将students数据表重命名为student<br>ALTER TABLE students<br>RENAME student</p></blockquote><h3 id="修改表头"><a href="#修改表头" class="headerlink" title="修改表头"></a>修改表头</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>数据表名<span class="operator">&gt;</span></span><br><span class="line">CHANGE <span class="operator">&lt;</span>旧表头<span class="operator">&gt;</span> <span class="operator">&lt;</span>新表头<span class="operator">&gt;</span> <span class="operator">&lt;</span>新数据类型<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>注：即使不需要修改数据类型也要加上新数据类型，保持一致即可</span><br></pre></td></tr></table></figure><blockquote><p>例：将student数据表中的sname修改为sn<br>ALTER TABLE student<br>CHANFE sname sn VARCHAR(45);</p></blockquote><h3 id="修改表头数据类型和字段排序"><a href="#修改表头数据类型和字段排序" class="headerlink" title="修改表头数据类型和字段排序"></a>修改表头数据类型和字段排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>数据表名<span class="operator">&gt;</span></span><br><span class="line">MODIFY <span class="operator">&lt;</span>表头<span class="number">1</span><span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [<span class="keyword">FIRST</span><span class="operator">|</span>AFTER 表头<span class="number">2</span>];</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>注：数据类型不可省略</span><br></pre></td></tr></table></figure><blockquote><p>例：将student数据表中sn的数据类型修改为CHAR(30)<br>ALTER TABLE student<br>MODIFY sn CHAR(30);</p><p>例：将student数据表中年龄age插到性别sex之前<br>ALTER TABLE student<br>MODIFY sex ENUM(“男”,”女”) AFTER age;</p></blockquote><h3 id="修改数据表存储引擎"><a href="#修改数据表存储引擎" class="headerlink" title="修改数据表存储引擎"></a>修改数据表存储引擎</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">ENGINE<span class="operator">=</span><span class="operator">&lt;</span>修改后的存储引擎<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>例:将存储引擎切换为MyISAM<br>ALTER TABLE student<br>ENGINE=MyISAM;</p></blockquote><h3 id="删除表头和完整性约束"><a href="#删除表头和完整性约束" class="headerlink" title="删除表头和完整性约束"></a>删除表头和完整性约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>旧表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="operator">&lt;</span>表头<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>例:删除student数据表中class班级属性<br>ALTER TABLE students<br>DROP class;</p></blockquote><h2 id="删除数据表"><a href="#删除数据表" class="headerlink" title="删除数据表"></a>删除数据表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>例:删除student数据表<br>DROP TABLE student;</p></blockquote>]]></content>
    
    
    <summary type="html">MySQL是一个关系型数据库管理系统,是最流行的关系型数据库管理系统之一，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性。MySQL所使用的 SQL 语言是用于访问数据库的最常用标准化语言。</summary>
    
    
    
    <category term="数据库" scheme="http://lucylcarus.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="MySQL" scheme="http://lucylcarus.github.io/tags/MySQL/"/>
    
  </entry>
  
</feed>
